         720181 function calls (685926 primitive calls) in 33.976 seconds

   Ordered by: cumulative time
   List reduced from 818 to 15 due to restriction <15>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001   33.976   33.976 grad_mode.py:287(__exit__)
        1    0.005    0.005   32.118   32.118 pposb3.py:502(learn)
        1    0.239    0.239   28.351   28.351 pposb3.py:344(train)
       24    0.000    0.000   13.186    0.549 _tensor.py:570(backward)
       24    0.001    0.000   13.185    0.549 __init__.py:243(backward)
       24    0.001    0.000   13.183    0.549 graph.py:832(_engine_run_backward)
       24   13.182    0.549   13.182    0.549 {method 'run_backward' of 'torch._C._EngineBase' objects}
11163/328    0.034    0.000    9.234    0.028 module.py:1771(_wrapped_call_impl)
11163/328    0.096    0.000    9.232    0.028 module.py:1779(_call_impl)
       24    0.001    0.000    7.086    0.295 optimizer.py:497(wrapper)
       24    0.001    0.000    7.079    0.295 optimizer.py:62(_use_grad)
       24    0.000    0.000    7.078    0.295 adam.py:213(step)
       24    0.000    0.000    7.004    0.292 optimizer.py:133(maybe_fallback)
       24    0.000    0.000    7.004    0.292 adam.py:885(adam)
       24    1.321    0.055    7.001    0.292 adam.py:345(_single_tensor_adam)




         720181 function calls (685926 primitive calls) in 33.976 seconds

   Ordered by: internal time
   List reduced from 818 to 15 due to restriction <15>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       24   13.182    0.549   13.182    0.549 {method 'run_backward' of 'torch._C._EngineBase' objects}
     2170    4.472    0.002    4.472    0.002 {built-in method torch._C._nn.linear}
     1200    1.734    0.001    1.734    0.001 {method 'sqrt' of 'torch._C.TensorBase' objects}
       24    1.321    0.055    7.001    0.292 adam.py:345(_single_tensor_adam)
      208    1.115    0.005    1.122    0.005 embeddings.py:731(forward)
     1200    1.101    0.001    1.101    0.001 {method 'addcdiv_' of 'torch._C.TensorBase' objects}
      416    0.855    0.002    0.855    0.002 {built-in method torch.embedding}
     1200    0.842    0.001    0.842    0.001 {method 'addcmul_' of 'torch._C.TensorBase' objects}
     1200    0.830    0.001    0.830    0.001 {method 'lerp_' of 'torch._C.TensorBase' objects}
     1860    0.799    0.000    0.799    0.000 {built-in method torch.relu}
      206    0.679    0.003    6.491    0.032 pposb3_model.py:65(_encode_embeddings)
     1550    0.644    0.000    0.644    0.000 {built-in method torch.layer_norm}
     1200    0.585    0.000    0.585    0.000 {method 'add_' of 'torch._C.TensorBase' objects}
     1200    0.578    0.000    0.578    0.000 {method 'mul_' of 'torch._C.TensorBase' objects}
       24    0.575    0.024    0.575    0.024 {built-in method torch._foreach_norm}


