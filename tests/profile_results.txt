         10975108 function calls (10959963 primitive calls) in 20.475 seconds

   Ordered by: cumulative time
   List reduced from 1103 to 15 due to restriction <15>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.003    0.003   13.115   13.115 ppo_rollout_custom.py:109(collect)
       60    0.001    0.000   12.807    0.213 common.py:3626(step_and_maybe_reset)
       61    0.001    0.000   12.488    0.205 common.py:2056(step)
       61    0.012    0.000   12.477    0.205 env.py:406(_step)
       78    8.934    0.115   12.393    0.159 unification_gpu.py:500(get_next_unification)
       61    0.034    0.001   12.352    0.202 env.py:494(_compute_derived_states_conditional_vec)
        2    0.002    0.001    3.198    1.599 common.py:259(__call__)
        2    0.024    0.012    3.194    1.597 env.py:29(__init__)
        2    1.860    0.930    2.544    1.272 index_manager.py:565(build_facts_index)
      123    0.037    0.000    2.326    0.019 unification_gpu.py:353(_unify_with_facts_batched)
       39    1.744    0.045    2.102    0.054 unification_gpu.py:119(apply_substitutions_batched)
        1    0.002    0.002    2.090    2.090 __init__.py:1695(_register_triton_kernels)
        1    0.157    0.157    2.043    2.043 dataset.py:300(__init__)
        1    0.737    0.737    1.338    1.338 index_manager.py:392(build_fact_index)
   179518    0.419    0.000    1.080    0.000 utils.py:96(get_atom_from_string)




         10975108 function calls (10959963 primitive calls) in 20.475 seconds

   Ordered by: internal time
   List reduced from 1103 to 15 due to restriction <15>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       78    8.934    0.115   12.393    0.159 unification_gpu.py:500(get_next_unification)
        2    1.860    0.930    2.544    1.272 index_manager.py:565(build_facts_index)
       39    1.744    0.045    2.102    0.054 unification_gpu.py:119(apply_substitutions_batched)
        1    0.737    0.737    1.338    1.338 index_manager.py:392(build_fact_index)
   179518    0.419    0.000    1.080    0.000 utils.py:96(get_atom_from_string)
      760    0.365    0.000    0.365    0.000 {method 'clone' of 'torch._C.TensorBase' objects}
   538537    0.327    0.000    0.417    0.000 utils.py:121(<genexpr>)
        2    0.280    0.140    0.495    0.248 index_manager.py:502(_state_to_tensor_vectorized)
   380791    0.273    0.000    0.273    0.000 {built-in method torch.from_numpy}
      167    0.266    0.002    0.338    0.002 unification_gpu.py:171(_unify_one_to_one_optimized)
      917    0.262    0.000    0.383    0.000 env.py:685(_state_to_tuple)
  1820083    0.212    0.000    0.212    0.000 {method 'append' of 'list' objects}
   380806    0.206    0.000    0.206    0.000 {built-in method numpy.array}
      549    0.186    0.000    0.234    0.000 unification_gpu.py:85(apply_substitutions_simple)
        3    0.184    0.061    0.815    0.272 dataset.py:235(get_filtered_queries)


