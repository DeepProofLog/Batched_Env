         10854610 function calls (10839478 primitive calls) in 10.663 seconds

   Ordered by: cumulative time
   List reduced from 1105 to 15 due to restriction <15>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.004    0.004    3.552    3.552 ppo_rollout_custom.py:109(collect)
        2    0.002    0.001    3.091    1.545 common.py:259(__call__)
        2    0.024    0.012    3.087    1.544 env.py:29(__init__)
       60    0.001    0.000    3.063    0.051 common.py:3626(step_and_maybe_reset)
       61    0.001    0.000    2.595    0.043 common.py:2056(step)
       61    0.018    0.000    2.584    0.042 env.py:406(_step)
        2    1.803    0.901    2.490    1.245 index_manager.py:565(build_facts_index)
       61    0.033    0.001    2.396    0.039 env.py:494(_compute_derived_states_conditional_vec)
       77    0.032    0.000    2.336    0.030 unification_gpu.py:664(get_next_unification)
        1    0.002    0.002    2.133    2.133 __init__.py:1695(_register_triton_kernels)
        1    0.156    0.156    2.089    2.089 dataset.py:300(__init__)
        1    0.709    0.709    1.303    1.303 index_manager.py:392(build_fact_index)
   179518    0.434    0.000    1.113    0.000 utils.py:96(get_atom_from_string)
      121    0.165    0.001    1.000    0.008 unification_gpu.py:259(_unify_with_rules_batched)
        3    0.000    0.000    0.834    0.278 dataset.py:463(load_queries_with_depth)




         10854610 function calls (10839478 primitive calls) in 10.663 seconds

   Ordered by: internal time
   List reduced from 1105 to 15 due to restriction <15>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    1.803    0.901    2.490    1.245 index_manager.py:565(build_facts_index)
        1    0.709    0.709    1.303    1.303 index_manager.py:392(build_fact_index)
   179518    0.434    0.000    1.113    0.000 utils.py:96(get_atom_from_string)
     1192    0.417    0.000    0.619    0.001 env.py:685(_state_to_tuple)
      855    0.375    0.000    0.462    0.001 unification_gpu.py:85(apply_substitutions_simple)
      166    0.349    0.002    0.443    0.003 unification_gpu.py:171(_unify_one_to_one_optimized)
   538537    0.338    0.000    0.430    0.000 utils.py:121(<genexpr>)
      133    0.304    0.002    0.527    0.004 unification_gpu.py:17(deduplicate_states_gpu)
   380791    0.283    0.000    0.283    0.000 {built-in method torch.from_numpy}
        2    0.258    0.129    0.455    0.227 index_manager.py:502(_state_to_tensor_vectorized)
      121    0.212    0.002    0.786    0.006 unification_gpu.py:568(combine_and_deduplicate_results)
   380806    0.200    0.000    0.200    0.000 {built-in method numpy.array}
  1756765    0.195    0.000    0.195    0.000 {method 'append' of 'list' objects}
     2178    0.185    0.000    0.185    0.000 {method 'item' of 'torch._C.TensorBase' objects}
        3    0.185    0.062    0.834    0.278 dataset.py:235(get_filtered_queries)


