         6042956 function calls (5851040 primitive calls) in 15.282 seconds

   Ordered by: cumulative time
   List reduced from 1042 to 15 due to restriction <15>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
       39    0.036    0.001   11.078    0.284 env.py:391(_compute_derived_states)
        1    0.002    0.002   11.064   11.064 ppo_rollout_custom.py:109(collect)
       20    0.000    0.000   10.881    0.544 common.py:3626(step_and_maybe_reset)
       21    0.000    0.000   10.693    0.509 common.py:2056(step)
       21    0.007    0.000   10.689    0.509 env.py:338(_step)
       73    0.124    0.002   10.666    0.146 unification_engine.py:458(get_derived_states)
8795/8093    0.110    0.000    8.224    0.001 _contextlib.py:117(decorate_context)
     7851    4.401    0.001    7.037    0.001 unification_engine.py:756(_prune_eager_true_ground_atoms)
      156    1.812    0.012    2.322    0.015 unification_engine.py:99(_deduplicate_states_gpu)
        1    0.000    0.000    1.724    1.724 __init__.py:1695(_register_triton_kernels)
        1    0.000    0.000    1.695    1.695 data_handler.py:50(__init__)
        1    0.000    0.000    1.695    1.695 data_handler.py:166(load_dataset)
    89694    0.080    0.000    1.281    0.000 index_manager.py:213(state_to_tensor)
   179508    0.427    0.000    1.093    0.000 utils.py:96(get_atom_from_string)
     8379    0.989    0.000    0.989    0.000 {method 'nonzero' of 'torch._C.TensorBase' objects}




         6042956 function calls (5851040 primitive calls) in 15.282 seconds

   Ordered by: internal time
   List reduced from 1042 to 15 due to restriction <15>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     7851    4.401    0.001    7.037    0.001 unification_engine.py:756(_prune_eager_true_ground_atoms)
      156    1.812    0.012    2.322    0.015 unification_engine.py:99(_deduplicate_states_gpu)
     8379    0.989    0.000    0.989    0.000 {method 'nonzero' of 'torch._C.TensorBase' objects}
 184272/0    0.974    0.000    0.000          {built-in method torch.tensor}
    25358    0.554    0.000    0.554    0.000 {method 'any' of 'torch._C.TensorBase' objects}
     7543    0.520    0.000    0.520    0.000 {method 'cpu' of 'torch._C.TensorBase' objects}
     9914    0.446    0.000    0.446    0.000 {method 'item' of 'torch._C.TensorBase' objects}
   179508    0.427    0.000    1.093    0.000 utils.py:96(get_atom_from_string)
   538524    0.333    0.000    0.414    0.000 utils.py:120(<genexpr>)
    89812    0.324    0.000    0.324    0.000 {built-in method torch.stack}
   176586    0.249    0.000    0.889    0.000 index_manager.py:206(atom_to_tensor)
     8222    0.185    0.000    0.185    0.000 {method 'all' of 'torch._C.TensorBase' objects}
      741    0.175    0.000    0.270    0.000 env.py:802(_state_signature)
    86836    0.175    0.000    0.203    0.000 unification_engine.py:451(<genexpr>)
      541    0.170    0.000    0.321    0.001 unification_engine.py:207(_apply_substitutions_simple)


