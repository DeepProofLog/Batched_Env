Device: cuda
Number of queries: 100
Corruptions per query: 100
Bucket size (max_derived_per_state): 120
CUDA graphs enabled: False
Evaluation time: 92.05s
MRR: 0.6492
Hits@1: 0.6400

================================================================================
Top by Cumulative Time
================================================================================
         6663164 function calls (6193294 primitive calls) in 88.046 seconds

   Ordered by: cumulative time
   List reduced from 364 to 30 due to restriction <30>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.004    0.004   88.043   88.043 grad_mode.py:287(__exit__)
        1    3.301    3.301   87.974   87.974 model_eval.py:85(evaluate_policy)
     2909    2.356    0.001   55.660    0.019 env.py:789(_compute_derived_states)
     1626    0.026    0.000   53.700    0.033 common.py:2056(step)
     1626   13.988    0.009   53.438    0.033 env.py:596(_step)
     2907    2.511    0.001   40.448    0.014 unification.py:1827(get_derived_states)
     1283    0.020    0.000   22.927    0.018 common.py:2822(reset)
     1283    0.590    0.000   20.674    0.016 env.py:359(_reset)
     2907    4.249    0.001    9.927    0.003 unification.py:925(unify_with_rules)
     2907    2.612    0.001    9.193    0.003 env.py:1269(_postprocess)
     2907    3.498    0.001    9.020    0.003 unification.py:796(unify_with_facts)
     2907    3.461    0.001    6.262    0.002 unification.py:1266(standardize_derived_states)
208128/1626    0.232    0.000    5.788    0.004 module.py:1771(_wrapped_call_impl)
208128/1626    0.344    0.000    5.782    0.004 module.py:1779(_call_impl)
     1626    0.013    0.000    5.760    0.004 model.py:536(forward)
     1626    0.010    0.000    4.644    0.003 model.py:383(forward)
     1626    0.114    0.000    4.632    0.003 model.py:322(forward_joint)
     2907    2.520    0.001    4.033    0.001 unification.py:1169(prune_and_collapse)
     3252    0.008    0.000    3.724    0.001 model.py:265(_encode_with_shared_body)
     3252    0.437    0.000    3.692    0.001 model.py:135(forward)
    34146    0.202    0.000    3.691    0.000 container.py:245(forward)
     4499    2.375    0.001    3.406    0.001 unification.py:548(unify_one_to_one)
     2907    1.638    0.001    2.903    0.001 unification.py:1446(pack_by_owner)
     4525    1.536    0.000    2.853    0.001 unification.py:629(pairs_via_predicate_ranges)
     2907    1.035    0.000    2.766    0.001 memory.py:141(add_current)
     2907    0.744    0.000    2.742    0.001 memory.py:96(membership)
8721/5814    1.354    0.000    2.633    0.000 memory.py:58(_state_hash64)
     2907    1.019    0.000    2.458    0.001 unification.py:724(preprocess_states)
     3891    1.531    0.000    2.321    0.001 unification.py:346(contains)
    82728    2.241    0.000    2.241    0.000 {built-in method torch.where}




================================================================================
Top by Total Time
================================================================================
         6663164 function calls (6193294 primitive calls) in 88.046 seconds

   Ordered by: internal time
   List reduced from 364 to 30 due to restriction <30>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1626   13.988    0.009   53.438    0.033 env.py:596(_step)
     2907    4.249    0.001    9.927    0.003 unification.py:925(unify_with_rules)
     2907    3.498    0.001    9.020    0.003 unification.py:796(unify_with_facts)
     2907    3.461    0.001    6.262    0.002 unification.py:1266(standardize_derived_states)
        1    3.301    3.301   87.974   87.974 model_eval.py:85(evaluate_policy)
     2907    2.612    0.001    9.193    0.003 env.py:1269(_postprocess)
     2907    2.520    0.001    4.033    0.001 unification.py:1169(prune_and_collapse)
     2907    2.511    0.001   40.448    0.014 unification.py:1827(get_derived_states)
     4499    2.375    0.001    3.406    0.001 unification.py:548(unify_one_to_one)
     2909    2.356    0.001   55.660    0.019 env.py:789(_compute_derived_states)
    82728    2.241    0.000    2.241    0.000 {built-in method torch.where}
    58643    1.883    0.000    1.883    0.000 {method 'sum' of 'torch._C.TensorBase' objects}
     2907    1.638    0.001    2.903    0.001 unification.py:1446(pack_by_owner)
    85747    1.636    0.000    1.636    0.000 {method 'any' of 'torch._C.TensorBase' objects}
     4525    1.536    0.000    2.853    0.001 unification.py:629(pairs_via_predicate_ranges)
     3891    1.531    0.000    2.321    0.001 unification.py:346(contains)
    14130    1.431    0.000    1.431    0.000 {method 'nonzero' of 'torch._C.TensorBase' objects}
    61648    1.427    0.000    1.427    0.000 {method 'index_select' of 'torch._C.TensorBase' objects}
    39024    1.423    0.000    1.423    0.000 {built-in method torch._C._nn.linear}
8721/5814    1.354    0.000    2.633    0.000 memory.py:58(_state_hash64)
     2907    1.127    0.000    1.444    0.000 env.py:982(_add_end_action)
     5814    1.103    0.000    1.103    0.000 {built-in method torch.bincount}
     4525    1.071    0.000    1.071    0.000 {built-in method torch.repeat_interleave}
     2907    1.035    0.000    2.766    0.001 memory.py:141(add_current)
     2907    1.019    0.000    2.458    0.001 unification.py:724(preprocess_states)
    47998    0.916    0.000    0.916    0.000 {method 'clone' of 'torch._C.TensorBase' objects}
     2907    0.827    0.000    0.827    0.000 {built-in method torch.isin}
    41753    0.812    0.000    0.812    0.000 {built-in method torch.zeros}
    33465    0.751    0.000    0.751    0.000 {built-in method torch.arange}
     2907    0.744    0.000    2.742    0.001 memory.py:96(membership)


