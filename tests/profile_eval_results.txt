Device: cuda
Number of queries: 100
Corruptions per query: 100
Bucket size (max_derived_per_state): 120
CUDA graphs enabled: False
Evaluation time: 201.88s
MRR: 0.6547
Hits@1: 0.6400

================================================================================
Top by Cumulative Time
================================================================================
         6571869 function calls (6116280 primitive calls) in 198.071 seconds

   Ordered by: cumulative time
   List reduced from 364 to 30 due to restriction <30>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.004    0.004  198.057  198.057 grad_mode.py:287(__exit__)
        1    5.016    5.016  197.975  197.975 model_eval.py:85(evaluate_policy)
     1573    0.035    0.000  145.668    0.093 common.py:2056(step)
     1573   53.781    0.034  145.335    0.092 env.py:593(_step)
     2854    3.291    0.001   80.592    0.028 env.py:801(_compute_derived_states)
     2853    3.735    0.001   59.226    0.021 unification.py:1865(get_derived_states)
     1281    0.033    0.000   36.565    0.029 common.py:2822(reset)
     1281    0.910    0.001   33.004    0.026 env.py:344(_reset)
    84107   21.574    0.000   21.574    0.000 {method 'any' of 'torch._C.TensorBase' objects}
    33812   19.015    0.001   19.015    0.001 {built-in method torch.arange}
     2853    3.907    0.001   13.051    0.005 env.py:1292(_postprocess)
     2853    5.722    0.002   12.785    0.004 unification.py:925(unify_with_rules)
     2853    4.880    0.002   12.300    0.004 unification.py:796(unify_with_facts)
     2853    5.070    0.002    9.088    0.003 unification.py:1304(standardize_derived_states)
     2853    5.211    0.002    8.408    0.003 unification.py:1169(prune_and_collapse)
201344/1573    0.297    0.000    7.520    0.005 module.py:1771(_wrapped_call_impl)
201344/1573    0.439    0.000    7.512    0.005 module.py:1779(_call_impl)
     1573    0.021    0.000    7.475    0.005 model.py:601(forward)
     1573    0.015    0.000    5.996    0.004 model.py:432(forward)
     1573    0.179    0.000    5.980    0.004 model.py:339(forward_joint)
     2853    2.755    0.001    4.745    0.002 unification.py:1484(pack_by_owner)
     3146    0.010    0.000    4.729    0.002 model.py:270(_encode_with_shared_body)
    33033    0.244    0.000    4.718    0.000 container.py:245(forward)
     3146    0.536    0.000    4.683    0.001 model.py:138(forward)
     4413    2.748    0.001    4.005    0.001 unification.py:548(unify_one_to_one)
     2853    1.408    0.000    3.885    0.001 memory.py:141(add_current)
8559/5706    1.819    0.000    3.826    0.001 memory.py:58(_state_hash64)
     2853    0.928    0.000    3.821    0.001 memory.py:96(membership)
     4424    1.956    0.000    3.739    0.001 unification.py:629(pairs_via_predicate_ranges)
     1281    0.020    0.000    3.518    0.003 common.py:2875(_reset_proc_data)




================================================================================
Top by Total Time
================================================================================
         6571869 function calls (6116280 primitive calls) in 198.071 seconds

   Ordered by: internal time
   List reduced from 364 to 30 due to restriction <30>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     1573   53.781    0.034  145.335    0.092 env.py:593(_step)
    84107   21.574    0.000   21.574    0.000 {method 'any' of 'torch._C.TensorBase' objects}
    33812   19.015    0.001   19.015    0.001 {built-in method torch.arange}
     2853    5.722    0.002   12.785    0.004 unification.py:925(unify_with_rules)
     2853    5.211    0.002    8.408    0.003 unification.py:1169(prune_and_collapse)
     2853    5.070    0.002    9.088    0.003 unification.py:1304(standardize_derived_states)
        1    5.016    5.016  197.975  197.975 model_eval.py:85(evaluate_policy)
     2853    4.880    0.002   12.300    0.004 unification.py:796(unify_with_facts)
     2853    3.907    0.001   13.051    0.005 env.py:1292(_postprocess)
     2853    3.735    0.001   59.226    0.021 unification.py:1865(get_derived_states)
     2854    3.291    0.001   80.592    0.028 env.py:801(_compute_derived_states)
    81344    3.077    0.000    3.077    0.000 {built-in method torch.where}
     2853    2.755    0.001    4.745    0.002 unification.py:1484(pack_by_owner)
     4413    2.748    0.001    4.005    0.001 unification.py:548(unify_one_to_one)
    60450    2.587    0.000    2.587    0.000 {method 'sum' of 'torch._C.TensorBase' objects}
    16811    2.556    0.000    2.556    0.000 {method 'nonzero' of 'torch._C.TensorBase' objects}
     3943    2.257    0.001    3.459    0.001 unification.py:346(contains)
    60612    2.018    0.000    2.018    0.000 {method 'index_select' of 'torch._C.TensorBase' objects}
     4424    1.956    0.000    3.739    0.001 unification.py:629(pairs_via_predicate_ranges)
    37752    1.914    0.000    1.914    0.000 {built-in method torch._C._nn.linear}
8559/5706    1.819    0.000    3.826    0.001 memory.py:58(_state_hash64)
     5706    1.721    0.000    1.721    0.000 {built-in method torch.bincount}
     2853    1.570    0.001    2.017    0.001 env.py:1005(_add_end_action)
     4424    1.473    0.000    1.473    0.000 {built-in method torch.repeat_interleave}
    12506    1.417    0.000    1.417    0.000 {built-in method torch.as_tensor}
     2853    1.408    0.000    3.885    0.001 memory.py:141(add_current)
    51091    1.337    0.000    1.337    0.000 {method 'clone' of 'torch._C.TensorBase' objects}
     2853    1.302    0.000    1.302    0.000 {built-in method torch.isin}
     2853    1.217    0.000    3.198    0.001 unification.py:724(preprocess_states)
    40836    1.078    0.000    1.078    0.000 {built-in method torch.zeros}


