Device: cuda
Number of queries: 10
Corruptions per query: 100
Evaluation time: 103.54s
MRR: 0.6226
Hits@1: 0.6000

================================================================================
Top by Cumulative Time
================================================================================
         4726381 function calls (4405055 primitive calls) in 101.458 seconds

   Ordered by: cumulative time
   List reduced from 546 to 30 due to restriction <30>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  101.430  101.430 grad_mode.py:287(__exit__)
        1    3.235    3.235  101.384  101.384 model_eval.py:85(evaluate_policy)
     1652    2.316    0.001   80.407    0.049 env.py:789(_compute_derived_states)
     1062    0.019    0.000   71.021    0.067 common.py:2056(step)
     1062    3.879    0.004   70.839    0.067 env.py:596(_step)
     2683    4.241    0.002   58.068    0.022 unification.py:1951(get_derived_states)
     1631    1.133    0.001   29.043    0.018 env.py:1066(_skip_unary)
      590    0.011    0.000   18.633    0.032 common.py:2822(reset)
      590    0.365    0.001   17.279    0.029 env.py:359(_reset)
     2683    7.217    0.003   15.961    0.006 unification.py:1016(unify_with_rules)
     2683    3.581    0.001   13.084    0.005 env.py:1269(_postprocess)
     2683    5.269    0.002    8.927    0.003 unification.py:1390(standardize_derived_states)
     2683    2.471    0.001    7.917    0.003 unification.py:830(unify_with_facts)
     2683    5.949    0.002    7.834    0.003 unification.py:1254(prune_and_collapse)
135936/1062    0.197    0.000    7.050    0.007 module.py:1771(_wrapped_call_impl)
135936/1062    0.266    0.000    7.045    0.007 module.py:1779(_call_impl)
     1062    0.011    0.000    7.024    0.007 model.py:536(forward)
     1062    0.007    0.000    6.037    0.006 model.py:383(forward)
     1062    0.099    0.000    6.028    0.006 model.py:322(forward_joint)
     2683    2.998    0.001    5.277    0.002 unification.py:700(preprocess_states)
    22302    0.156    0.000    5.246    0.000 container.py:245(forward)
     2124    0.006    0.000    4.825    0.002 model.py:265(_encode_with_shared_body)
     2124    0.319    0.000    4.799    0.002 model.py:135(forward)
     2683    3.093    0.001    4.764    0.002 unification.py:1570(pack_by_owner)
     2683    1.927    0.001    4.568    0.002 memory.py:140(add_current)
8049/5366    1.366    0.000    4.282    0.001 memory.py:58(_state_hash64)
     2683    0.686    0.000    3.705    0.001 memory.py:95(membership)
     4766    1.705    0.000    3.692    0.001 unification.py:608(pairs_via_predicate_ranges)
     3825    2.316    0.001    3.561    0.001 unification.py:505(unify_one_to_one)
    83321    3.280    0.000    3.280    0.000 {method 'index_select' of 'torch._C.TensorBase' objects}




================================================================================
Top by Total Time
================================================================================
         4726381 function calls (4405055 primitive calls) in 101.458 seconds

   Ordered by: internal time
   List reduced from 546 to 30 due to restriction <30>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     2683    7.217    0.003   15.961    0.006 unification.py:1016(unify_with_rules)
     2683    5.949    0.002    7.834    0.003 unification.py:1254(prune_and_collapse)
     2683    5.269    0.002    8.927    0.003 unification.py:1390(standardize_derived_states)
     2683    4.241    0.002   58.068    0.022 unification.py:1951(get_derived_states)
     1062    3.879    0.004   70.839    0.067 env.py:596(_step)
     2683    3.581    0.001   13.084    0.005 env.py:1269(_postprocess)
    83321    3.280    0.000    3.280    0.000 {method 'index_select' of 'torch._C.TensorBase' objects}
        1    3.235    3.235  101.384  101.384 model_eval.py:85(evaluate_policy)
    66912    3.205    0.000    3.205    0.000 {built-in method torch.where}
     2683    3.093    0.001    4.764    0.002 unification.py:1570(pack_by_owner)
    25488    3.041    0.000    3.041    0.000 {built-in method torch._C._nn.linear}
     2683    2.998    0.001    5.277    0.002 unification.py:700(preprocess_states)
    77862    2.929    0.000    2.929    0.000 {built-in method torch.arange}
     2683    2.471    0.001    7.917    0.003 unification.py:830(unify_with_facts)
    14187    2.430    0.000    2.430    0.000 {method 'index_copy_' of 'torch._C.TensorBase' objects}
     3825    2.316    0.001    3.561    0.001 unification.py:505(unify_one_to_one)
     1652    2.316    0.001   80.407    0.049 env.py:789(_compute_derived_states)
    15502    1.997    0.000    1.997    0.000 {built-in method torch.nonzero}
    50441    1.931    0.000    1.931    0.000 {method 'sum' of 'torch._C.TensorBase' objects}
     2683    1.927    0.001    4.568    0.002 memory.py:140(add_current)
     4766    1.705    0.000    3.692    0.001 unification.py:608(pairs_via_predicate_ranges)
    82359    1.622    0.000    1.622    0.000 {method 'any' of 'torch._C.TensorBase' objects}
     1631    1.424    0.001    1.697    0.001 env.py:982(_add_end_action)
8049/5366    1.366    0.000    4.282    0.001 memory.py:58(_state_hash64)
     4766    1.297    0.000    1.297    0.000 {built-in method torch.repeat_interleave}
     5366    1.292    0.000    1.292    0.000 {built-in method torch.bincount}
     1631    1.133    0.001   29.043    0.018 env.py:1066(_skip_unary)
    36127    1.029    0.000    1.029    0.000 {method 'clone' of 'torch._C.TensorBase' objects}
     1465    0.935    0.001    1.290    0.001 unification.py:293(contains)
    19116    0.911    0.000    0.911    0.000 {built-in method torch.layer_norm}


