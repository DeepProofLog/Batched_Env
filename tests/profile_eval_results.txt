Device: cuda
Number of queries: 10
Corruptions per query: 100
Evaluation time: 121.00s
MRR: 0.6217
Hits@1: 0.6000

================================================================================
Top by Cumulative Time
================================================================================
         6732801 function calls (6177708 primitive calls) in 120.997 seconds

   Ordered by: cumulative time
   List reduced from 600 to 30 due to restriction <30>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001  120.973  120.973 grad_mode.py:287(__exit__)
        1    3.406    3.406  120.914  120.914 model_eval.py:85(evaluate_policy)
     1648    2.499    0.002   88.577    0.054 env.py:784(_compute_derived_states)
     1062    0.023    0.000   78.787    0.074 common.py:2056(step)
     1062    4.782    0.005   78.578    0.074 env.py:591(_step)
     2662    4.480    0.002   65.452    0.025 unification.py:1807(get_derived_states)
     1625    1.133    0.001   30.853    0.019 env.py:1062(_skip_unary)
     2662    8.254    0.003   20.497    0.008 unification.py:943(unify_with_rules)
      586    0.013    0.000   20.457    0.035 common.py:2822(reset)
      586    0.389    0.001   19.001    0.032 env.py:355(_reset)
     2662    4.056    0.002   13.408    0.005 env.py:1286(_postprocess)
184788/1062    0.262    0.000   10.209    0.010 module.py:1771(_wrapped_call_impl)
184788/1062    0.390    0.000   10.203    0.010 module.py:1779(_call_impl)
     1062    0.013    0.000   10.180    0.010 model.py:475(forward)
     2662    2.578    0.001    9.291    0.003 unification.py:762(unify_with_facts)
     2662    5.422    0.002    9.254    0.003 unification.py:1314(standardize_derived_states)
     1062    0.019    0.000    9.038    0.009 model.py:328(forward)
     2662    6.293    0.002    8.260    0.003 unification.py:1181(prune_and_collapse)
    31860    0.232    0.000    7.906    0.000 container.py:245(forward)
     3186    0.007    0.000    7.668    0.002 model.py:250(_encode_with_shared_body)
     3186    0.519    0.000    7.631    0.002 model.py:135(forward)
     3788    3.072    0.001    6.338    0.002 unification.py:415(unify_one_to_one)
136998/1062    0.322    0.000    6.301    0.006 _tensor.py:1102(__format__)
     1062    0.003    0.000    6.293    0.006 {function Tensor.__format__ at 0x7fa12284f9c0}
     1062    0.011    0.000    6.290    0.006 _tensor.py:562(__repr__)
     1062    0.037    0.000    6.279    0.006 _tensor_str.py:719(_str)
     1062    0.062    0.000    6.162    0.006 _tensor_str.py:416(_str_intern)
     1062    0.114    0.000    6.085    0.006 model.py:261(forward_policy)
     1062    0.014    0.000    6.063    0.006 _tensor_str.py:332(_tensor_str)
     2662    3.391    0.001    5.930    0.002 unification.py:632(preprocess_states)




================================================================================
Top by Total Time
================================================================================
         6732801 function calls (6177708 primitive calls) in 120.997 seconds

   Ordered by: internal time
   List reduced from 600 to 30 due to restriction <30>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     2662    8.254    0.003   20.497    0.008 unification.py:943(unify_with_rules)
     2662    6.293    0.002    8.260    0.003 unification.py:1181(prune_and_collapse)
     2662    5.422    0.002    9.254    0.003 unification.py:1314(standardize_derived_states)
   138640    4.929    0.000    4.929    0.000 {method 'item' of 'torch._C.TensorBase' objects}
     1062    4.782    0.005   78.578    0.074 env.py:591(_step)
     2662    4.480    0.002   65.452    0.025 unification.py:1807(get_derived_states)
    35046    4.424    0.000    4.424    0.000 {built-in method torch._C._nn.linear}
     2662    4.056    0.002   13.408    0.005 env.py:1286(_postprocess)
    89147    3.760    0.000    3.760    0.000 {method 'index_select' of 'torch._C.TensorBase' objects}
    17892    3.692    0.000    3.692    0.000 {method 'index_copy_' of 'torch._C.TensorBase' objects}
        1    3.406    3.406  120.914  120.914 model_eval.py:85(evaluate_policy)
     2662    3.391    0.001    5.930    0.002 unification.py:632(preprocess_states)
    75602    3.109    0.000    3.109    0.000 {built-in method torch.arange}
     3788    3.072    0.001    6.338    0.002 unification.py:415(unify_one_to_one)
    57731    2.962    0.000    2.962    0.000 {built-in method torch.where}
   132382    2.659    0.000    2.659    0.000 {method 'any' of 'torch._C.TensorBase' objects}
    19169    2.654    0.000    2.654    0.000 {built-in method torch.nonzero}
     2662    2.578    0.001    9.291    0.003 unification.py:762(unify_with_facts)
     2662    2.528    0.001    4.288    0.002 unification.py:1494(pack_by_owner)
     1648    2.499    0.002   88.577    0.054 env.py:784(_compute_derived_states)
     2662    1.991    0.001    4.804    0.002 memory.py:140(add_current)
     4729    1.822    0.000    3.956    0.001 unification.py:540(pairs_via_predicate_ranges)
    52491    1.662    0.000    1.662    0.000 {method 'clone' of 'torch._C.TensorBase' objects}
     6450    1.586    0.000    2.966    0.000 unification.py:346(apply_substitutions)
    28674    1.482    0.000    1.482    0.000 {built-in method torch.layer_norm}
    36154    1.480    0.000    1.480    0.000 {method 'sum' of 'torch._C.TensorBase' objects}
     1625    1.476    0.001    1.749    0.001 env.py:977(_add_end_action)
     4729    1.407    0.000    1.407    0.000 {built-in method torch.repeat_interleave}
     5324    1.328    0.000    1.328    0.000 {built-in method torch.bincount}
6906/4784    1.287    0.000    3.812    0.001 memory.py:58(_state_hash64)


