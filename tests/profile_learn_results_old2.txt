Device: cuda
Total timesteps: 90
Training time: 45.93s

================================================================================
Top by Cumulative Time
================================================================================
         309311 function calls (280499 primitive calls) in 45.935 seconds

   Ordered by: cumulative time
   List reduced from 544 to 30 due to restriction <30>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000   45.935   45.935 ppo.py:692(learn)
        1    0.033    0.033   42.592   42.592 ppo.py:463(train)
        5    0.000    0.000   24.302    4.860 _tensor.py:570(backward)
        5    0.000    0.000   24.302    4.860 __init__.py:243(backward)
        5    0.000    0.000   24.298    4.860 graph.py:832(_engine_run_backward)
        5   24.298    4.860   24.298    4.860 {method 'run_backward' of 'torch._C._EngineBase' objects}
      570   12.180    0.021   12.180    0.021 {method 'item' of 'torch._C.TensorBase' objects}
        5    0.000    0.000    5.328    1.066 model.py:532(evaluate_actions)
 12174/76    0.013    0.000    4.896    0.064 module.py:1771(_wrapped_call_impl)
 12174/76    0.021    0.000    4.896    0.064 module.py:1779(_call_impl)
       70    0.001    0.000    4.355    0.062 model.py:347(forward)
      210    0.000    0.000    4.229    0.020 model.py:261(_encode_with_shared_body)
      210    1.011    0.005    4.227    0.020 model.py:135(forward)
       70    0.000    0.000    3.986    0.057 model.py:303(forward_value)
     2100    0.013    0.000    3.240    0.002 container.py:245(forward)
        1    0.075    0.075    3.197    3.197 ppo.py:196(collect_rollouts)
       64    0.065    0.001    2.481    0.039 env.py:722(step_and_maybe_reset)
       99    0.077    0.001    2.298    0.023 env.py:789(_compute_derived_states)
 1726/114    0.026    0.000    1.742    0.015 _contextlib.py:117(decorate_context)
       99    0.092    0.001    1.736    0.018 unification.py:1909(get_derived_states)
       64    0.001    0.000    1.685    0.026 common.py:2056(step)
       64    0.035    0.001    1.675    0.026 env.py:596(_step)
     2310    0.002    0.000    1.395    0.001 linear.py:130(forward)
     2310    1.391    0.001    1.391    0.001 {built-in method torch._C._nn.linear}
     2100    0.002    0.000    1.252    0.001 activation.py:140(forward)
     2100    0.002    0.000    1.250    0.001 functional.py:1686(relu)
     2100    1.247    0.001    1.247    0.001 {built-in method torch.relu}
        5    0.000    0.000    1.008    0.202 fast_distributions.py:114(entropy)
        5    1.007    0.201    1.008    0.202 fast_distributions.py:72(entropy)
       35    0.001    0.000    0.844    0.024 common.py:2822(reset)




================================================================================
Top by Total Time
================================================================================
         309311 function calls (280499 primitive calls) in 45.935 seconds

   Ordered by: internal time
   List reduced from 544 to 30 due to restriction <30>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        5   24.298    4.860   24.298    4.860 {method 'run_backward' of 'torch._C._EngineBase' objects}
      570   12.180    0.021   12.180    0.021 {method 'item' of 'torch._C.TensorBase' objects}
     2310    1.391    0.001    1.391    0.001 {built-in method torch._C._nn.linear}
     2100    1.247    0.001    1.247    0.001 {built-in method torch.relu}
      210    1.011    0.005    4.227    0.020 model.py:135(forward)
        5    1.007    0.201    1.008    0.202 fast_distributions.py:72(entropy)
     1890    0.525    0.000    0.525    0.000 {built-in method torch.layer_norm}
        5    0.409    0.082    0.409    0.082 {built-in method torch._foreach_norm}
      140    0.387    0.003    0.390    0.003 embeddings.py:771(forward)
       99    0.170    0.002    0.434    0.004 unification.py:1011(unify_with_rules)
       99    0.164    0.002    0.230    0.002 unification.py:1249(prune_and_collapse)
       15    0.125    0.008    0.125    0.008 {built-in method torch.stack}
       99    0.119    0.001    0.255    0.003 unification.py:1385(standardize_derived_states)
      163    0.107    0.001    0.140    0.001 unification.py:505(unify_one_to_one)
       99    0.103    0.001    0.316    0.003 unification.py:830(unify_with_facts)
       99    0.092    0.001    1.736    0.018 unification.py:1909(get_derived_states)
       99    0.086    0.001    0.366    0.004 env.py:1269(_postprocess)
     2763    0.082    0.000    0.082    0.000 {built-in method torch.where}
     3304    0.079    0.000    0.079    0.000 {method 'index_select' of 'torch._C.TensorBase' objects}
       99    0.077    0.001    2.298    0.023 env.py:789(_compute_derived_states)
        1    0.075    0.075    3.197    3.197 ppo.py:196(collect_rollouts)
     1915    0.074    0.000    0.074    0.000 {method 'sum' of 'torch._C.TensorBase' objects}
       99    0.070    0.001    0.164    0.002 unification.py:700(preprocess_states)
     3556    0.069    0.000    0.069    0.000 {method 'any' of 'torch._C.TensorBase' objects}
       64    0.065    0.001    2.481    0.039 env.py:722(step_and_maybe_reset)
       70    0.064    0.001    0.064    0.001 {method 'masked_fill' of 'torch._C.TensorBase' objects}
      592    0.060    0.000    0.060    0.000 {built-in method torch.nonzero}
      198    0.057    0.000    0.057    0.000 {built-in method torch.bincount}
     3032    0.054    0.000    0.054    0.000 {built-in method torch.arange}
      163    0.053    0.000    0.102    0.001 unification.py:608(pairs_via_predicate_ranges)


