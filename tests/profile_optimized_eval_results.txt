Profile Optimized Eval Results
Date: 2025-12-15 21:38:36
Device: cuda
Dataset: family

Configuration:
  Queries: 5
  Corruptions: 20
  Corruption modes: ['both']
  Total candidates: 105
  Compile mode: reduce-overhead
  Fullgraph: True

================================================================================
TIMING SUMMARY
================================================================================
Warmup time:      29.7994s
Runtime:          0.6530s
Total time:       30.4524s
ms/query:         130.595
ms/candidate:     6.219

MRR:              0.7143
Hits@1:           0.6000
Hits@10:          0.8000

================================================================================
Top by Cumulative Time
================================================================================
         38560 function calls (37923 primitive calls) in 0.249 seconds

   Ordered by: cumulative time
   List reduced from 508 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     59/5    0.001    0.000    0.148    0.030 eval_frame.py:1039(_fn)
     19/1    0.000    0.000    0.135    0.135 aot_autograd.py:1126(forward)
       20    0.000    0.000    0.110    0.006 runtime_wrappers.py:310(runtime_wrapper)
       20    0.001    0.000    0.110    0.006 utils.py:119(call_func_at_runtime_with_args)
       20    0.000    0.000    0.109    0.005 runtime_wrappers.py:716(inner_fn)
       20    0.000    0.000    0.109    0.005 runtime_wrappers.py:512(wrapper)
       20    0.000    0.000    0.109    0.005 output_code.py:590(__call__)
       20    0.000    0.000    0.098    0.005 compile_fx.py:1767(run)
       20    0.000    0.000    0.098    0.005 cudagraph_trees.py:378(deferred_cudagraphify)
       20    0.000    0.000    0.098    0.005 utils.py:3013(run)
    37/20    0.001    0.000    0.098    0.005 cudagraph_trees.py:2008(run)
    37/20    0.000    0.000    0.097    0.005 cudagraph_trees.py:2073(_run)
        2    0.000    0.000    0.084    0.042 cudagraph_trees.py:2205(record_function)
        1    0.000    0.000    0.073    0.073 env_optimized.py:259(init_state_from_queries)
        1    0.002    0.002    0.072    0.072 env_optimized.py:452(_compute_derived_functional)
        1    0.001    0.001    0.068    0.068 unification_optimized.py:901(get_derived_states_compiled)
        1    0.000    0.000    0.058    0.058 ca7vr3mufycwbfu2nm5mu2s5tf2jexcltykegubt7y3wflbp2gn2.py:7180(call)
       20    0.002    0.000    0.045    0.002 graphs.py:139(replay)
        2    0.000    0.000    0.044    0.022 cudagraph_trees.py:815(__init__)
        2    0.000    0.000    0.043    0.022 cudagraph_trees.py:1230(_record)
       19    0.000    0.000    0.042    0.002 cpttxryweg7djac4wm3do7sqymphojyykm4qpazdq4u5mykn275h.py:7182(call)
        2    0.000    0.000    0.042    0.021 graphs.py:264(__exit__)
        2    0.000    0.000    0.041    0.020 unification_optimized.py:44(fact_contains_vectorized)
        2    0.000    0.000    0.040    0.020 unification.py:234(_pack_triples_64)
        2    0.040    0.020    0.040    0.020 {built-in method torch.as_tensor}
       12    0.000    0.000    0.040    0.003 __init__.py:1073(synchronize)
       12    0.039    0.003    0.039    0.003 {built-in method torch._C._cuda_synchronize}
        1    0.001    0.001    0.033    0.033 unification_optimized.py:561(prune_ground_facts_fixed)
        1    0.002    0.002    0.029    0.029 ppo_optimized.py:37(compute_metrics_from_ranks)
        1    0.000    0.000    0.017    0.017 ca7vr3mufycwbfu2nm5mu2s5tf2jexcltykegubt7y3wflbp2gn2.py:6618(partition_0)
      128    0.001    0.000    0.016    0.000 triton_heuristics.py:1242(run)
        2    0.000    0.000    0.015    0.008 graphs.py:240(__enter__)
      116    0.000    0.000    0.015    0.000 static_cuda_launcher.py:215(run)
      116    0.015    0.000    0.015    0.000 {_launch_kernel}
        2    0.000    0.000    0.014    0.007 graphs.py:98(capture_begin)
        1    0.000    0.000    0.014    0.014 _tensor.py:38(wrapped)
        1    0.000    0.000    0.014    0.014 unification_optimized.py:639(pack_results_fixed)
        1    0.000    0.000    0.014    0.014 _tensor.py:1077(__rdiv__)
        4    0.014    0.003    0.014    0.003 {built-in method torch.mean}
        1    0.014    0.014    0.014    0.014 {method 'reciprocal' of 'torch._C.TensorBase' objects}




================================================================================
Top by Total Time
================================================================================
         38560 function calls (37923 primitive calls) in 0.249 seconds

   Ordered by: internal time
   List reduced from 508 to 40 due to restriction <40>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        2    0.040    0.020    0.040    0.020 {built-in method torch.as_tensor}
       12    0.039    0.003    0.039    0.003 {built-in method torch._C._cuda_synchronize}
      116    0.015    0.000    0.015    0.000 {_launch_kernel}
        4    0.014    0.003    0.014    0.003 {built-in method torch.mean}
        1    0.014    0.014    0.014    0.014 {method 'reciprocal' of 'torch._C.TensorBase' objects}
        2    0.014    0.007    0.014    0.007 {built-in method torch._C._cuda_emptyCache}
    22/20    0.010    0.000    0.010    0.001 {built-in method torch._foreach_copy_}
        2    0.009    0.004    0.009    0.004 {built-in method torch.randint}
        2    0.008    0.004    0.008    0.004 {method 'flip' of 'torch._C.TensorBase' objects}
      409    0.007    0.000    0.007    0.000 {method 'clone' of 'torch._C.TensorBase' objects}
        1    0.007    0.007    0.007    0.007 {built-in method torch.rand}
       12    0.005    0.000    0.005    0.000 {built-in method torch.cat}
     18/0    0.004    0.000    0.000          env_optimized.py:896(_step_with_policy_impl)
        2    0.002    0.001    0.005    0.002 unification.py:548(unify_one_to_one)
       54    0.002    0.000    0.002    0.000 {built-in method torch.where}
        1    0.002    0.002    0.072    0.072 env_optimized.py:452(_compute_derived_functional)
        1    0.002    0.002    0.013    0.013 sampler.py:123(corrupt)
       10    0.002    0.000    0.002    0.000 {built-in method torch.full}
        1    0.002    0.002    0.029    0.029 ppo_optimized.py:37(compute_metrics_from_ranks)
       20    0.002    0.000    0.045    0.002 graphs.py:139(replay)
       18    0.001    0.000    0.001    0.000 {built-in method torch.full_like}
     1380    0.001    0.000    0.002    0.000 {built-in method builtins.getattr}
        1    0.001    0.001    0.007    0.007 unification_optimized.py:359(unify_with_facts_fixed)
        2    0.001    0.001    0.001    0.001 graphs.py:119(capture_end)
     1193    0.001    0.000    0.002    0.000 _config_module.py:370(__getattr__)
     59/5    0.001    0.000    0.148    0.030 eval_frame.py:1039(_fn)
        1    0.001    0.001    0.068    0.068 unification_optimized.py:901(get_derived_states_compiled)
       22    0.001    0.000    0.001    0.000 {built-in method torch._ops.profiler._record_function_enter_new}
        4    0.001    0.000    0.001    0.000 {built-in method torch.stack}
1178/1040    0.001    0.000    0.002    0.000 copy.py:118(deepcopy)
       11    0.001    0.000    0.001    0.000 {built-in method torch.zeros}
       20    0.001    0.000    0.001    0.000 _config_module.py:718(revert)
        1    0.001    0.001    0.001    0.001 sampler.py:96(_filter_mask_batched)
        1    0.001    0.001    0.033    0.033 unification_optimized.py:561(prune_ground_facts_fixed)
       28    0.001    0.000    0.001    0.000 {method 'all' of 'torch._C.TensorBase' objects}
     6841    0.001    0.000    0.001    0.000 {built-in method builtins.isinstance}
       20    0.001    0.000    0.110    0.006 utils.py:119(call_func_at_runtime_with_args)
       18    0.001    0.000    0.001    0.000 {method 'sum' of 'torch._C.TensorBase' objects}
        4    0.001    0.000    0.005    0.001 _config_module.py:464(_get_dict)
      151    0.001    0.000    0.001    0.000 {built-in method torch._C._construct_CUDA_Tensor_From_Storage_And_Metadata}


