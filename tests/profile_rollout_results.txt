================================================================================
ROLLOUT COLLECTION PROFILING RESULTS
================================================================================

Configuration:
  Device: cuda
  Steps: 32
  Envs: 64
  Total samples: 2048
  Total time: 11.93s
  FPS: 171.7

================================================================================
BREAKDOWN BY PHASE (Custom record_function regions)
================================================================================

01_obs_clone:
  Count: 30
  Total CPU time: 9.51 ms
  Total CUDA time: 0.39 ms
  Avg CPU per call: 0.317 ms
  Avg CUDA per call: 0.013 ms

01_obs_clone:
  Count: 17
  Total CPU time: 0.00 ms
  Total CUDA time: 2.28 ms
  Avg CPU per call: 0.000 ms
  Avg CUDA per call: 0.134 ms

02_policy_forward:
  Count: 30
  Total CPU time: 26.25 ms
  Total CUDA time: 149.19 ms
  Avg CPU per call: 0.875 ms
  Avg CUDA per call: 4.973 ms

03_action_td_create:
  Count: 30
  Total CPU time: 2.02 ms
  Total CUDA time: 0.00 ms
  Avg CPU per call: 0.067 ms
  Avg CUDA per call: 0.000 ms

04_env_step:
  Count: 30
  Total CPU time: 7671.75 ms
  Total CUDA time: 569.95 ms
  Avg CPU per call: 255.725 ms
  Avg CUDA per call: 18.998 ms

04_env_step:
  Count: 17
  Total CPU time: 0.00 ms
  Total CUDA time: 3999.33 ms
  Avg CPU per call: 0.000 ms
  Avg CUDA per call: 235.254 ms

05_extract_results:
  Count: 30
  Total CPU time: 8.18 ms
  Total CUDA time: 0.11 ms
  Avg CPU per call: 0.273 ms
  Avg CUDA per call: 0.004 ms

05_extract_results:
  Count: 16
  Total CPU time: 0.00 ms
  Total CUDA time: 1.54 ms
  Avg CPU per call: 0.000 ms
  Avg CUDA per call: 0.096 ms

06_episode_tracking:
  Count: 30
  Total CPU time: 8.39 ms
  Total CUDA time: 0.26 ms
  Avg CPU per call: 0.280 ms
  Avg CUDA per call: 0.009 ms

06_episode_tracking:
  Count: 16
  Total CPU time: 0.00 ms
  Total CUDA time: 2.84 ms
  Avg CPU per call: 0.000 ms
  Avg CUDA per call: 0.177 ms

================================================================================
TOP 30 CUDA KERNELS BY TOTAL DEVICE TIME
================================================================================

04_env_step                                                             3999.33 ms (x17, avg 235.254 ms)
ProfilerStep*                                                            719.91 ms (x30, avg 23.997 ms)
04_env_step                                                              569.95 ms (x30, avg 18.998 ms)
## Call CompiledFxGraph fjvqp62gsj5fwmtpumoo56cv6amjl676m5bpk77ozapep7   153.00 ms (x17, avg 9.000 ms)
02_policy_forward                                                        149.19 ms (x30, avg 4.973 ms)
Torch-Compiled Region: 0/0                                               149.19 ms (x30, avg 4.973 ms)
aten::index                                                              125.50 ms (x13634, avg 0.009 ms)
ampere_sgemm_64x64_tn                                                    111.96 ms (x187, avg 0.599 ms)
aten::nonzero                                                             83.30 ms (x8511, avg 0.010 ms)
aten::index_select                                                        71.70 ms (x3910, avg 0.018 ms)
aten::gather                                                              50.70 ms (x1408, avg 0.036 ms)
void at::native::vectorized_gather_kernel<16, long>(char*, char*, long    50.61 ms (x1000, avg 0.051 ms)
void at::native::index_elementwise_kernel<128, 4, at::native::gpu_inde    50.56 ms (x6033, avg 0.008 ms)
aten::sum                                                                 31.02 ms (x3885, avg 0.008 ms)
void at_cuda_detail::cub::detail::select::DeviceSelectSweepKernel<at_c    29.03 ms (x4615, avg 0.006 ms)
aten::copy_                                                               28.48 ms (x11643, avg 0.002 ms)
aten::index_put_                                                          28.35 ms (x3351, avg 0.008 ms)
aten::_index_put_impl_                                                    28.35 ms (x3351, avg 0.008 ms)
aten::bitwise_and                                                         28.34 ms (x11871, avg 0.002 ms)
aten::__and__                                                             27.82 ms (x11686, avg 0.002 ms)
aten::cumsum                                                              25.76 ms (x1235, avg 0.021 ms)
void at::native::tensor_kernel_scan_innermost_dim<long, std::plus<long    21.53 ms (x178, avg 0.121 ms)
void at::native::vectorized_elementwise_kernel<4, at::native::BinaryFu    20.56 ms (x4672, avg 0.004 ms)
aten::where                                                               20.06 ms (x6187, avg 0.003 ms)
void at::native::reduce_kernel<512, 1, at::native::ReduceOp<long, at::    19.95 ms (x2103, avg 0.009 ms)
void at::native::elementwise_kernel<128, 4, at::native::gpu_kernel_imp    19.66 ms (x3580, avg 0.005 ms)
aten::sort                                                                19.45 ms (x632, avg 0.031 ms)
aten::eq                                                                  19.18 ms (x6766, avg 0.003 ms)
void at_cuda_detail::cub::detail::reduce::DeviceReduceSingleTileKernel    18.45 ms (x3935, avg 0.005 ms)
aten::any                                                                 17.94 ms (x3781, avg 0.005 ms)

================================================================================
TOP 30 OPERATORS BY CPU TIME
================================================================================

ProfilerStep*                                                           7730.36 ms (x30, avg 257.679 ms)
04_env_step                                                             7671.75 ms (x30, avg 255.725 ms)
aten::index                                                             2098.07 ms (x13634, avg 0.154 ms)
aten::nonzero                                                           1980.13 ms (x8511, avg 0.233 ms)
cudaLaunchKernel                                                         776.37 ms (x76682, avg 0.010 ms)
cudaStreamSynchronize                                                    695.46 ms (x8691, avg 0.080 ms)
aten::item                                                               529.45 ms (x6061, avg 0.087 ms)
aten::_local_scalar_dense                                                511.91 ms (x6061, avg 0.084 ms)
aten::is_nonzero                                                         412.67 ms (x4392, avg 0.094 ms)
aten::index_put_                                                         345.73 ms (x3351, avg 0.103 ms)
aten::copy_                                                              333.95 ms (x11643, avg 0.029 ms)
aten::_index_put_impl_                                                   330.45 ms (x3351, avg 0.099 ms)
aten::__and__                                                            272.64 ms (x11686, avg 0.023 ms)
aten::to                                                                 272.52 ms (x13450, avg 0.020 ms)
aten::repeat_interleave                                                  262.03 ms (x680, avg 0.385 ms)
aten::where                                                              257.26 ms (x6187, avg 0.042 ms)
aten::_to_copy                                                           252.85 ms (x5654, avg 0.045 ms)
aten::bitwise_and                                                        247.74 ms (x11871, avg 0.021 ms)
aten::sum                                                                224.13 ms (x3885, avg 0.058 ms)
aten::nonzero_numpy                                                      217.89 ms (x1143, avg 0.191 ms)
cudaMemcpyAsync                                                          180.11 ms (x11382, avg 0.016 ms)
aten::eq                                                                 166.93 ms (x6766, avg 0.025 ms)
aten::index_select                                                       158.93 ms (x3910, avg 0.041 ms)
aten::fill_                                                              158.72 ms (x8674, avg 0.018 ms)
aten::arange                                                             145.36 ms (x4782, avg 0.030 ms)
aten::bincount                                                           125.41 ms (x370, avg 0.339 ms)
aten::ne                                                                 119.02 ms (x4920, avg 0.024 ms)
aten::any                                                                115.33 ms (x3781, avg 0.031 ms)
aten::bitwise_not                                                        111.31 ms (x5232, avg 0.021 ms)
aten::empty                                                              103.37 ms (x22930, avg 0.005 ms)

================================================================================
MEMORY OPERATIONS (TOP 20 BY ALLOCATION)
================================================================================


================================================================================
POTENTIAL SYNCHRONIZATION POINTS
================================================================================

aten::nonzero                                                 1980.13 ms (x8511)
cudaStreamSynchronize                                          695.46 ms (x8691)
aten::item                                                     529.45 ms (x6061)
aten::is_nonzero                                               412.67 ms (x4392)
aten::nonzero_numpy                                            217.89 ms (x1143)
void at_cuda_detail::cub::detail::reduce::DeviceReduceSingle     0.00 ms (x3935)
void at_cuda_detail::cub::detail::select::DeviceSelectSweepK     0.00 ms (x4615)
void at_cuda_detail::cub::detail::reduce::DeviceReduceKernel     0.00 ms (x680)

================================================================================
KERNEL LAUNCH ANALYSIS
================================================================================

Total CUDA kernel launches: 403198
Total CUDA kernel time: 7381.29 ms
Average kernel duration: 0.0183 ms

Short kernels (<0.1ms avg):
  Launches: 402605 (99.9%)
  Time: 1492.80 ms (20.2%)
  -> These may benefit from kernel fusion or CUDA graphs
