Device: cuda
Total timesteps: 90
Training time: 37.47s

================================================================================
Top by Cumulative Time
================================================================================
         899050 function calls (841152 primitive calls) in 38.027 seconds

   Ordered by: cumulative time
   List reduced from 534 to 30 due to restriction <30>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.001    0.001   38.027   38.027 ppo.py:643(learn)
        1    0.183    0.183   36.489   36.489 ppo.py:167(collect_rollouts)
      128    0.877    0.007   33.458    0.261 env.py:731(step_and_maybe_reset)
      250    0.449    0.002   30.868    0.123 env.py:798(_compute_derived_states)
      128    0.004    0.000   24.979    0.195 common.py:2056(step)
      128    0.139    0.001   24.942    0.195 env.py:605(_step)
 8203/537    0.300    0.000   23.083    0.043 _contextlib.py:117(decorate_context)
      522    1.624    0.003   23.016    0.044 unification.py:1807(get_derived_states)
      250    0.447    0.002   15.328    0.061 env.py:1076(_skip_unary)
      122    0.004    0.000    7.597    0.062 common.py:2822(reset)
      122    0.132    0.001    7.082    0.058 env.py:359(_reset)
      522    2.743    0.005    7.031    0.013 unification.py:943(unify_with_rules)
      522    1.421    0.003    5.022    0.010 env.py:1300(_postprocess)
      522    1.943    0.004    3.344    0.006 unification.py:1314(standardize_derived_states)
      522    0.904    0.002    3.320    0.006 unification.py:762(unify_with_facts)
      522    2.191    0.004    2.908    0.006 unification.py:1181(prune_and_collapse)
23310/140    0.055    0.000    2.523    0.018 module.py:1771(_wrapped_call_impl)
23310/140    0.078    0.000    2.522    0.018 module.py:1779(_call_impl)
      128    0.002    0.000    2.404    0.019 model.py:475(forward)
      755    1.127    0.001    2.291    0.003 unification.py:415(unify_one_to_one)
      134    0.004    0.000    2.093    0.016 model.py:328(forward)
      522    1.086    0.002    1.918    0.004 unification.py:632(preprocess_states)
     4020    0.054    0.000    1.818    0.000 container.py:245(forward)
      522    0.738    0.001    1.775    0.003 memory.py:140(add_current)
      402    0.002    0.000    1.760    0.004 model.py:250(_encode_with_shared_body)
      402    0.119    0.000    1.752    0.004 model.py:135(forward)
      522    0.888    0.002    1.515    0.003 unification.py:1494(pack_by_owner)
      134    0.037    0.000    1.475    0.011 model.py:261(forward_policy)
 1408/965    0.499    0.000    1.470    0.002 memory.py:58(_state_hash64)
    17540    1.344    0.000    1.344    0.000 {method 'index_select' of 'torch._C.TensorBase' objects}




================================================================================
Top by Total Time
================================================================================
         899050 function calls (841152 primitive calls) in 38.027 seconds

   Ordered by: internal time
   List reduced from 534 to 30 due to restriction <30>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      522    2.743    0.005    7.031    0.013 unification.py:943(unify_with_rules)
      522    2.191    0.004    2.908    0.006 unification.py:1181(prune_and_collapse)
      522    1.943    0.004    3.344    0.006 unification.py:1314(standardize_derived_states)
      522    1.624    0.003   23.016    0.044 unification.py:1807(get_derived_states)
      522    1.421    0.003    5.022    0.010 env.py:1300(_postprocess)
    17540    1.344    0.000    1.344    0.000 {method 'index_select' of 'torch._C.TensorBase' objects}
     3301    1.242    0.000    1.242    0.000 {method 'index_copy_' of 'torch._C.TensorBase' objects}
    11678    1.148    0.000    1.148    0.000 {built-in method torch.where}
      755    1.127    0.001    2.291    0.003 unification.py:415(unify_one_to_one)
      522    1.086    0.002    1.918    0.004 unification.py:632(preprocess_states)
     4422    1.026    0.000    1.026    0.000 {built-in method torch._C._nn.linear}
    14117    1.000    0.000    1.000    0.000 {built-in method torch.arange}
    25086    0.937    0.000    0.937    0.000 {method 'any' of 'torch._C.TensorBase' objects}
      522    0.904    0.002    3.320    0.006 unification.py:762(unify_with_facts)
      522    0.888    0.002    1.515    0.003 unification.py:1494(pack_by_owner)
      128    0.877    0.007   33.458    0.261 env.py:731(step_and_maybe_reset)
     3861    0.861    0.000    0.861    0.000 {built-in method torch.nonzero}
      522    0.738    0.001    1.775    0.003 memory.py:140(add_current)
      922    0.609    0.001    1.314    0.001 unification.py:540(pairs_via_predicate_ranges)
     9769    0.575    0.000    0.575    0.000 {method 'clone' of 'torch._C.TensorBase' objects}
     1277    0.559    0.000    1.057    0.001 unification.py:346(apply_substitutions)
     7212    0.553    0.000    0.553    0.000 {method 'sum' of 'torch._C.TensorBase' objects}
 1408/965    0.499    0.000    1.470    0.002 memory.py:58(_state_hash64)
     1044    0.463    0.000    0.463    0.000 {built-in method torch.bincount}
      922    0.454    0.000    0.454    0.000 {built-in method torch.repeat_interleave}
      250    0.452    0.002    0.534    0.002 env.py:991(_add_end_action)
      250    0.449    0.002   30.868    0.123 env.py:798(_compute_derived_states)
      250    0.447    0.002   15.328    0.061 env.py:1076(_skip_unary)
     3618    0.347    0.000    0.347    0.000 {built-in method torch.layer_norm}
      268    0.333    0.001    0.463    0.002 unification.py:193(contains)


