Device: cuda
Total timesteps: 128
Training time: 4.54s

================================================================================
Top CUDA Time
================================================================================
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
autograd::engine::evaluate_function: SelectBackward0...         0.04%       1.616ms         0.39%      14.656ms      91.599us       0.000us         0.00%      99.300ms     620.624us           160  
autograd::engine::evaluate_function: EmbeddingBackwa...         0.09%       3.206ms         1.63%      60.547ms     378.420us       0.000us         0.00%      74.254ms     464.090us           160  
                                     EmbeddingBackward0         0.02%     718.285us         1.51%      55.957ms     349.731us       0.000us         0.00%      73.712ms     460.702us           160  
                               aten::embedding_backward         0.01%     487.612us         1.49%      55.239ms     345.242us       0.000us         0.00%      73.712ms     460.702us           160  
                         aten::embedding_dense_backward         0.49%      18.202ms         1.47%      54.751ms     342.194us      72.460ms        12.44%      73.712ms     460.702us           160  
                                            aten::copy_         4.28%     158.997ms         8.64%     321.191ms      27.954us      70.175ms        12.05%      70.175ms       6.108us         11490  
    autograd::engine::evaluate_function: AddmmBackward0         0.69%      25.541ms         5.68%     211.095ms     219.891us       0.000us         0.00%      70.006ms      72.923us           960  
                                         AddmmBackward0         0.43%      16.142ms         3.51%     130.623ms     136.065us       0.000us         0.00%      60.337ms      62.852us           960  
                                               aten::mm         1.91%      71.027ms         2.55%      94.851ms      49.402us      60.337ms        10.36%      60.337ms      31.426us          1920  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      58.255ms        10.00%      58.255ms      49.833us          1169  
                                        SelectBackward0         0.01%     440.518us         0.30%      11.121ms      69.509us       0.000us         0.00%      57.478ms     359.238us           160  
                                  aten::select_backward         0.03%       1.187ms         0.29%      10.681ms      66.756us       0.000us         0.00%      57.478ms     359.238us           160  
                                             aten::add_         0.61%      22.573ms         1.01%      37.406ms      22.479us      55.841ms         9.59%      55.841ms      33.558us          1664  
autograd::engine::evaluate_function: NativeLayerNorm...         0.40%      14.837ms         1.99%      74.121ms     102.946us       0.000us         0.00%      44.380ms      61.639us           720  
                               NativeLayerNormBackward0         0.11%       4.098ms         1.14%      42.400ms      58.889us       0.000us         0.00%      43.502ms      60.419us           720  
                       aten::native_layer_norm_backward         0.49%      18.051ms         1.03%      38.302ms      53.197us      43.502ms         7.47%      43.502ms      60.419us           720  
                                            aten::index         3.43%     127.476ms        17.48%     649.794ms     132.855us      19.786ms         3.40%      42.146ms       8.617us          4891  
void at::native::(anonymous namespace)::sum_and_scat...         0.00%       0.000us         0.00%       0.000us       0.000us      36.925ms         6.34%      36.925ms     769.263us            48  
autograd::engine::evaluate_function: ToCopyBackward0...         0.67%      24.731ms         3.63%     134.957ms      50.357us       0.000us         0.00%      36.774ms      13.722us          2680  
## Call CompiledFxGraph fmcubs5usbrzifep5gl2b7ip5nwc...         0.00%       0.000us         0.00%       0.000us       0.000us      35.879ms         6.16%      35.879ms       1.121ms            32  
                                            aten::fill_         0.91%      33.971ms         2.08%      77.153ms      21.684us      32.483ms         5.58%      32.484ms       9.130us          3558  
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us      31.807ms         5.46%      31.807ms     314.918us           101  
                                          aten::nonzero         3.84%     142.740ms        15.87%     589.948ms     201.347us      30.019ms         5.16%      30.066ms      10.261us          2930  
                             Torch-Compiled Region: 0/0         0.14%       5.144ms         0.78%      28.964ms     905.122us      28.571ms         4.91%      28.921ms     903.785us            32  
                                            aten::zero_         0.21%       7.826ms         1.16%      43.190ms      25.785us       0.000us         0.00%      28.789ms      17.188us          1675  
                                               aten::to         0.50%      18.500ms         8.66%     321.788ms      31.557us       0.000us         0.00%      28.192ms       2.765us         10197  
                                         aten::_to_copy         1.26%      46.674ms         8.16%     303.288ms      39.896us       0.000us         0.00%      28.192ms       3.708us          7602  
                                            aten::zeros         0.21%       7.858ms         1.33%      49.473ms      38.500us       0.000us         0.00%      28.054ms      21.832us          1285  
void at::native::vectorized_elementwise_kernel<4, at...         0.00%       0.000us         0.00%       0.000us       0.000us      26.504ms         4.55%      26.504ms      76.380us           347  
void at::native::(anonymous namespace)::layer_norm_g...         0.00%       0.000us         0.00%       0.000us       0.000us      26.090ms         4.48%      26.090ms      59.566us           438  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 3.717s
Self CUDA time total: 582.323ms


================================================================================
Top CPU Time
================================================================================
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                       cudaLaunchKernel        18.38%     683.272ms        18.52%     688.577ms      12.175us       0.000us         0.00%       4.665us       0.000us         56555  
                                            aten::index         3.43%     127.476ms        17.48%     649.794ms     132.855us      19.786ms         3.40%      42.146ms       8.617us          4891  
                                          aten::nonzero         3.84%     142.740ms        15.87%     589.948ms     201.347us      30.019ms         5.16%      30.066ms      10.261us          2930  
                                  cudaStreamSynchronize        10.75%     399.615ms        10.75%     399.615ms      63.826us       0.000us         0.00%       0.000us       0.000us          6261  
                                               aten::to         0.50%      18.500ms         8.66%     321.788ms      31.557us       0.000us         0.00%      28.192ms       2.765us         10197  
                                            aten::copy_         4.28%     158.997ms         8.64%     321.191ms      27.954us      70.175ms        12.05%      70.175ms       6.108us         11490  
                                         aten::_to_copy         1.26%      46.674ms         8.16%     303.288ms      39.896us       0.000us         0.00%      28.192ms       3.708us          7602  
                                             aten::item         0.23%       8.621ms         6.29%     233.623ms      95.747us       0.000us         0.00%       2.720ms       1.115us          2440  
                              aten::_local_scalar_dense         0.82%      30.372ms         6.05%     225.002ms      92.214us       2.720ms         0.47%       2.720ms       1.115us          2440  
                                           aten::linear         0.37%      13.884ms         5.89%     218.890ms     114.963us       0.000us         0.00%       3.480ms       1.828us          1904  
    autograd::engine::evaluate_function: AddmmBackward0         0.69%      25.541ms         5.68%     211.095ms     219.891us       0.000us         0.00%      70.006ms      72.923us           960  
                                       aten::is_nonzero         0.15%       5.664ms         5.09%     189.379ms     110.168us       0.000us         0.00%       2.032ms       1.182us          1719  
                                        cudaMemcpyAsync         4.86%     180.662ms         4.86%     180.662ms      20.379us       0.000us         0.00%       0.000us       0.000us          8865  
                                       aten::index_put_         0.21%       7.786ms         4.02%     149.410ms     119.624us       0.000us         0.00%      10.918ms       8.742us          1249  
                                 aten::_index_put_impl_         0.65%      24.208ms         3.81%     141.624ms     113.390us       6.193ms         1.06%      10.918ms       8.742us          1249  
autograd::engine::evaluate_function: ToCopyBackward0...         0.67%      24.731ms         3.63%     134.957ms      50.357us       0.000us         0.00%      36.774ms      13.722us          2680  
                                         AddmmBackward0         0.43%      16.142ms         3.51%     130.623ms     136.065us       0.000us         0.00%      60.337ms      62.852us           960  
                                            aten::where         1.00%      37.101ms         3.49%     129.910ms      56.360us       5.226ms         0.90%       7.837ms       3.400us          2305  
                                              aten::sum         1.75%      65.017ms         3.48%     129.236ms      58.451us      15.162ms         2.60%      18.668ms       8.443us          2211  
                                          aten::__and__         0.31%      11.500ms         3.21%     119.366ms      29.924us       0.000us         0.00%       9.956ms       2.496us          3989  
                                       aten::layer_norm         0.17%       6.191ms         3.13%     116.428ms      79.854us       0.000us         0.00%       1.709ms       1.172us          1458  
                                      aten::bitwise_and         1.70%      63.335ms         2.94%     109.193ms      26.981us      10.113ms         1.74%      10.113ms       2.499us          4047  
                                        ToCopyBackward0         0.16%       5.935ms         2.59%      96.400ms      35.970us       0.000us         0.00%      22.523ms       8.404us          2680  
                                               aten::mm         1.91%      71.027ms         2.55%      94.851ms      49.402us      60.337ms        10.36%      60.337ms      31.426us          1920  
                                              aten::add         1.83%      68.103ms         2.48%      92.254ms      28.695us       8.566ms         1.47%       8.566ms       2.664us          3215  
                                    aten::nonzero_numpy         0.07%       2.424ms         2.15%      79.805ms     206.747us       0.000us         0.00%       3.493ms       9.050us           386  
                                aten::repeat_interleave         0.14%       5.363ms         2.12%      78.851ms     438.061us     508.159us         0.09%       4.068ms      22.600us           180  
                                     aten::index_select         0.76%      28.303ms         2.11%      78.590ms      52.887us       7.012ms         1.20%      11.315ms       7.614us          1486  
                                            aten::clone         0.30%      11.047ms         2.10%      77.980ms      43.491us       0.000us         0.00%       6.218ms       3.468us          1793  
                                            aten::empty         2.09%      77.673ms         2.09%      77.673ms       5.309us       0.000us         0.00%       0.000us       0.000us         14631  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 3.717s
Self CUDA time total: 582.323ms
