% Rule with Depth Tracking and Depth Limit
locatedInCR_with_depth(X, Z, Recursion, MaxDepth, Depth, Proof) :-
    Recursion =< MaxDepth,
    locatedInCR(X, Z),
    Depth = 1, % Base facts have depth 1
    Proof = [locatedInCR(X, Z)]. % Record the base fact as proof

locatedInCR_with_depth(X, Z, Recursion, MaxDepth, Depth, Proof) :-
    Recursion < MaxDepth,
    neighborOf(X, Y),
    Next_Recursion is Recursion + 1,
    locatedInCR_with_depth(Y, Z, Next_Recursion, MaxDepth, SubDepth, SubProof),
    Depth is SubDepth + 1,
    Proof = [neighborOf(X, Y) | SubProof].

% Query to Return Depth and Proofs
query_with_depth(X, Z, MaxDepth, Depths, Proofs) :-
    findall([Depth, Proof],
            locatedInCR_with_depth(X, Z, 0, MaxDepth, Depth, Proof),
            Results),
    % Separate depths and proofs into two lists
    findall(D, member([D, _], Results), Depths),
    findall(P, member([_, P], Results), Proofs).