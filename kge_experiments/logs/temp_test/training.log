
============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: family-250-128-torchrl
======================================================================
Training: family
Envs: 128, Steps: 256, Timesteps: 200000
Seed: 0
======================================================================

[1/3] Creating components...

[2/3] Running training...

============================================================
Initial evaluation (untrained model)
============================================================
[Eval] Took 30.76 seconds

[Ranking] MRR: current=0.425, best=0.425 (iter 0)
--------------------------------------------------------------------
| eval/                              |                            |
|    Hits@1                         | 0.345                      |
|    Hits@10                        | 0.575                      |
|    Hits@3                         | 0.453                      |
|    MRR                            | 0.425                      |
|    len_d_-1_pos                   | 8.200                      |
|    len_d_2_pos                    | 4.560                      |
|    len_d_4_pos                    | 8.857                      |
|    len_d_6_pos                    | 10.000                     |
|    len_neg                        | 8.157                      |
|    len_pos                        | 4.920                      |
|    mrr_mean                       | 0.425                      |
|    proven_d_-1_pos                | 0.050                      |
|    proven_d_2_pos                 | 0.714                      |
|    proven_d_4_pos                 | 0.143                      |
|    proven_d_6_pos                 | 0.000                      |
|    proven_neg                     | 0.296                      |
|    proven_pos                     | 0.657                      |
|    reward_d_-1_pos                | 0.050                      |
|    reward_d_2_pos                 | 0.714                      |
|    reward_d_4_pos                 | 0.143                      |
|    reward_d_6_pos                 | 0.000                      |
|    reward_label_neg               | 0.296                      |
|    reward_label_pos               | 0.657                      |
--------------------------------------------------------------------

============================================================

[PPO] Rollout collected in 4.43s. Rollout FPS: 7400.09. Reward: 0.427. Timesteps: 32768
[PPO] Early stopping at step 0 due to reaching max kl: 10.99
[PPO] Training completed in 0.68s
[Metrics] Reward (train): current=0.427, best=0.427 (iter 1)
--------------------------------------------------------------------
| rollout/                           |                            |
|    ep_len_mean                    | 5.376                      |
|    ep_rew_mean                    | 0.427                      |
|    explained_variance             | -3.995                     |
|    len                            | 5.376 +/- 3.91 (6012)      |
|    len_d_1_pos                    | 1.000 +/- 0.00 (225)       |
|    len_d_2_pos                    | 4.429 +/- 3.96 (2777)      |
|    len_d_4_pos                    | 8.500 +/- 5.94 (44)        |
|    len_d_6_pos                    | 6.500 +/- 1.50 (2)         |
|    len_d_unknown_neg              | 6.547 +/- 3.45 (2964)      |
|    len_neg                        | 6.547 +/- 3.45 (2964)      |
|    len_pos                        | 4.236 +/- 3.98 (3048)      |
|    proven_d_1_pos                 | 1.000 +/- 0.00 (225)       |
|    proven_d_1_pos_husband         | 1.000 +/- 0.00 (108)       |
|    proven_d_1_pos_wife            | 1.000 +/- 0.00 (117)       |
|    proven_d_2_pos                 | 0.752 +/- 0.43 (2777)      |
|    proven_d_2_pos_aunt            | 0.752 +/- 0.43 (483)       |
|    proven_d_2_pos_brother         | 0.788 +/- 0.41 (165)       |
|    proven_d_2_pos_daughter        | 0.723 +/- 0.45 (148)       |
|    proven_d_2_pos_father          | 0.826 +/- 0.38 (184)       |
|    proven_d_2_pos_husband         | 0.583 +/- 0.49 (12)        |
|    proven_d_2_pos_mother          | 0.915 +/- 0.28 (129)       |
|    proven_d_2_pos_nephew          | 0.613 +/- 0.49 (445)       |
|    proven_d_2_pos_niece           | 0.795 +/- 0.40 (370)       |
|    proven_d_2_pos_sister          | 0.811 +/- 0.39 (180)       |
|    proven_d_2_pos_son             | 0.543 +/- 0.50 (197)       |
|    proven_d_2_pos_uncle           | 0.850 +/- 0.36 (446)       |
|    proven_d_2_pos_wife            | 0.722 +/- 0.45 (18)        |
|    proven_d_4_pos                 | 0.545 +/- 0.50 (44)        |
|    proven_d_4_pos_aunt            | 0.455 +/- 0.50 (11)        |
|    proven_d_4_pos_brother         | 1.000 +/- 0.00 (6)         |
|    proven_d_4_pos_daughter        | 0.000 +/- 0.00 (1)         |
|    proven_d_4_pos_father          | 0.800 +/- 0.40 (5)         |
|    proven_d_4_pos_husband         | 0.500 +/- 0.50 (2)         |
|    proven_d_4_pos_mother          | 0.667 +/- 0.47 (6)         |
|    proven_d_4_pos_nephew          | 0.000 +/- 0.00 (1)         |
|    proven_d_4_pos_niece           | 1.000 +/- 0.00 (2)         |
|    proven_d_4_pos_sister          | 0.000 +/- 0.00 (2)         |
|    proven_d_4_pos_son             | 0.286 +/- 0.45 (7)         |
|    proven_d_4_pos_uncle           | 0.000 +/- 0.00 (1)         |
|    proven_d_6_pos                 | 0.500 +/- 0.50 (2)         |
|    proven_d_6_pos_daughter        | 1.000 +/- 0.00 (1)         |
|    proven_d_6_pos_nephew          | 0.000 +/- 0.00 (1)         |
|    proven_d_unknown_neg           | 0.346 +/- 0.48 (2964)      |
|    proven_d_unknown_neg_<PAD>     | 0.000 +/- 0.00 (1)         |
|    proven_d_unknown_neg_aunt      | 0.309 +/- 0.46 (424)       |
|    proven_d_unknown_neg_brother   | 0.044 +/- 0.21 (136)       |
|    proven_d_unknown_neg_daughter  | 0.415 +/- 0.49 (159)       |
|    proven_d_unknown_neg_father    | 0.506 +/- 0.50 (174)       |
|    proven_d_unknown_neg_husband   | 0.478 +/- 0.50 (115)       |
|    proven_d_unknown_neg_mother    | 0.564 +/- 0.50 (163)       |
|    proven_d_unknown_neg_nephew    | 0.006 +/- 0.08 (478)       |
|    proven_d_unknown_neg_niece     | 0.516 +/- 0.50 (386)       |
|    proven_d_unknown_neg_sister    | 0.124 +/- 0.33 (186)       |
|    proven_d_unknown_neg_son       | 0.113 +/- 0.32 (186)       |
|    proven_d_unknown_neg_uncle     | 0.647 +/- 0.48 (430)       |
|    proven_d_unknown_neg_wife      | 0.500 +/- 0.50 (126)       |
|    proven_neg                     | 0.346 +/- 0.48 (2964)      |
|    proven_pos                     | 0.767 +/- 0.42 (3048)      |
|    reward                         | 0.427 +/- 0.91 (6012)      |
|    reward_d_1_pos                 | 1.000 +/- 0.00 (225)       |
|    reward_d_2_pos                 | 0.505 +/- 0.86 (2777)      |
|    reward_d_4_pos                 | 0.091 +/- 1.00 (44)        |
|    reward_d_6_pos                 | 0.000 +/- 1.00 (2)         |
|    reward_d_unknown_neg           | 0.317 +/- 0.96 (2964)      |
|    reward_neg                     | 0.317 +/- 0.96 (2964)      |
|    reward_pos                     | 0.535 +/- 0.84 (3048)      |
|    success_rate                   | 0.560                      |
|    time/elapsed                   | 35                         |
|    time/iteration_fps             | 912                        |
|    total_timesteps                | 32768                      |
--------------------------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_env-swarm/family_training/kge_experiments/models/family-250-128-torchrl/last_model_train_2026_01_25_12_10_00.pt
[PPO] Rollout collected in 1.77s. Rollout FPS: 18476.52. Reward: 0.463. Timesteps: 65536
[PPO] Early stopping at step 0 due to reaching max kl: 9.49
[PPO] Training completed in 3.36s
[Metrics] Reward (train): current=0.445, best=0.445 (iter 2)
--------------------------------------------------------------------
| rollout/                           |                            |
|    ep_len_mean                    | 5.362                      |
|    ep_rew_mean                    | 0.445                      |
|    explained_variance             | -3.883                     |
|    len                            | 5.362 +/- 3.95 (12138)     |
|    len_d_1_pos                    | 1.000 +/- 0.00 (460)       |
|    len_d_2_pos                    | 4.323 +/- 3.89 (5537)      |
|    len_d_4_pos                    | 7.490 +/- 5.35 (104)       |
|    len_d_6_pos                    | 5.667 +/- 1.70 (3)         |
|    len_d_unknown_neg              | 6.610 +/- 3.60 (6034)      |
|    len_neg                        | 6.610 +/- 3.60 (6034)      |
|    len_pos                        | 4.128 +/- 3.90 (6104)      |
|    proven_d_1_pos                 | 1.000 +/- 0.00 (460)       |
|    proven_d_1_pos_husband         | 1.000 +/- 0.00 (230)       |
|    proven_d_1_pos_wife            | 1.000 +/- 0.00 (230)       |
|    proven_d_2_pos                 | 0.757 +/- 0.43 (5537)      |
|    proven_d_2_pos_aunt            | 0.746 +/- 0.44 (875)       |
|    proven_d_2_pos_brother         | 0.784 +/- 0.41 (352)       |
|    proven_d_2_pos_daughter        | 0.732 +/- 0.44 (276)       |
|    proven_d_2_pos_father          | 0.842 +/- 0.36 (349)       |
|    proven_d_2_pos_husband         | 0.636 +/- 0.48 (33)        |
|    proven_d_2_pos_mother          | 0.913 +/- 0.28 (276)       |
|    proven_d_2_pos_nephew          | 0.632 +/- 0.48 (944)       |
|    proven_d_2_pos_niece           | 0.808 +/- 0.39 (744)       |
|    proven_d_2_pos_sister          | 0.823 +/- 0.38 (344)       |
|    proven_d_2_pos_son             | 0.499 +/- 0.50 (391)       |
|    proven_d_2_pos_uncle           | 0.858 +/- 0.35 (918)       |
|    proven_d_2_pos_wife            | 0.771 +/- 0.42 (35)        |
|    proven_d_4_pos                 | 0.529 +/- 0.50 (104)       |
|    proven_d_4_pos_aunt            | 0.333 +/- 0.47 (21)        |
|    proven_d_4_pos_brother         | 0.929 +/- 0.26 (14)        |
|    proven_d_4_pos_daughter        | 0.333 +/- 0.47 (3)         |
|    proven_d_4_pos_father          | 0.667 +/- 0.47 (9)         |
|    proven_d_4_pos_husband         | 0.667 +/- 0.47 (3)         |
|    proven_d_4_pos_mother          | 0.750 +/- 0.43 (16)        |
|    proven_d_4_pos_nephew          | 0.000 +/- 0.00 (6)         |
|    proven_d_4_pos_niece           | 1.000 +/- 0.00 (4)         |
|    proven_d_4_pos_sister          | 0.167 +/- 0.37 (6)         |
|    proven_d_4_pos_son             | 0.300 +/- 0.46 (10)        |
|    proven_d_4_pos_uncle           | 0.500 +/- 0.50 (12)        |
|    proven_d_6_pos                 | 0.667 +/- 0.47 (3)         |
|    proven_d_6_pos_daughter        | 1.000 +/- 0.00 (2)         |
|    proven_d_6_pos_nephew          | 0.000 +/- 0.00 (1)         |
|    proven_d_unknown_neg           | 0.331 +/- 0.47 (6034)      |
|    proven_d_unknown_neg_<PAD>     | 0.000 +/- 0.00 (3)         |
|    proven_d_unknown_neg_aunt      | 0.278 +/- 0.45 (832)       |
|    proven_d_unknown_neg_brother   | 0.060 +/- 0.24 (319)       |
|    proven_d_unknown_neg_daughter  | 0.373 +/- 0.48 (306)       |
|    proven_d_unknown_neg_father    | 0.499 +/- 0.50 (355)       |
|    proven_d_unknown_neg_husband   | 0.418 +/- 0.49 (273)       |
|    proven_d_unknown_neg_mother    | 0.541 +/- 0.50 (327)       |
|    proven_d_unknown_neg_nephew    | 0.005 +/- 0.07 (974)       |
|    proven_d_unknown_neg_niece     | 0.510 +/- 0.50 (739)       |
|    proven_d_unknown_neg_sister    | 0.128 +/- 0.33 (375)       |
|    proven_d_unknown_neg_son       | 0.114 +/- 0.32 (403)       |
|    proven_d_unknown_neg_uncle     | 0.649 +/- 0.48 (888)       |
|    proven_d_unknown_neg_wife      | 0.483 +/- 0.50 (240)       |
|    proven_neg                     | 0.331 +/- 0.47 (6034)      |
|    proven_pos                     | 0.771 +/- 0.42 (6104)      |
|    reward                         | 0.445 +/- 0.90 (12138)     |
|    reward_d_1_pos                 | 1.000 +/- 0.00 (460)       |
|    reward_d_2_pos                 | 0.513 +/- 0.86 (5537)      |
|    reward_d_4_pos                 | 0.058 +/- 1.00 (104)       |
|    reward_d_6_pos                 | 0.333 +/- 0.94 (3)         |
|    reward_d_unknown_neg           | 0.347 +/- 0.95 (6034)      |
|    reward_neg                     | 0.347 +/- 0.95 (6034)      |
|    reward_pos                     | 0.542 +/- 0.84 (6104)      |
|    success_rate                   | 0.552                      |
|    time/elapsed                   | 41                         |
|    time/iteration_fps             | 6338                       |
|    total_timesteps                | 65536                      |
--------------------------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_env-swarm/family_training/kge_experiments/models/family-250-128-torchrl/last_model_train_2026_01_25_12_10_00.pt
[PPO] Rollout collected in 1.78s. Rollout FPS: 18423.73. Reward: 0.428. Timesteps: 98304
[PPO] Early stopping at step 0 due to reaching max kl: 10.24
[PPO] Training completed in 0.01s
[Metrics] Reward (train): current=0.439, best=0.445 (iter 2)
--------------------------------------------------------------------
| rollout/                           |                            |
|    ep_len_mean                    | 5.386                      |
|    ep_rew_mean                    | 0.439                      |
|    explained_variance             | -4.148                     |
|    len                            | 5.386 +/- 4.00 (18163)     |
|    len_d_1_pos                    | 1.000 +/- 0.00 (685)       |
|    len_d_2_pos                    | 4.358 +/- 3.93 (8279)      |
|    len_d_4_pos                    | 7.507 +/- 5.15 (148)       |
|    len_d_6_pos                    | 5.250 +/- 1.64 (4)         |
|    len_d_unknown_neg              | 6.625 +/- 3.67 (9047)      |
|    len_neg                        | 6.625 +/- 3.67 (9047)      |
|    len_pos                        | 4.157 +/- 3.93 (9116)      |
|    proven_d_1_pos                 | 1.000 +/- 0.00 (685)       |
|    proven_d_1_pos_husband         | 1.000 +/- 0.00 (341)       |
|    proven_d_1_pos_wife            | 1.000 +/- 0.00 (344)       |
|    proven_d_2_pos                 | 0.753 +/- 0.43 (8279)      |
|    proven_d_2_pos_aunt            | 0.742 +/- 0.44 (1245)      |
|    proven_d_2_pos_brother         | 0.784 +/- 0.41 (513)       |
|    proven_d_2_pos_daughter        | 0.710 +/- 0.45 (434)       |
|    proven_d_2_pos_father          | 0.845 +/- 0.36 (523)       |
|    proven_d_2_pos_husband         | 0.654 +/- 0.48 (52)        |
|    proven_d_2_pos_mother          | 0.927 +/- 0.26 (409)       |
|    proven_d_2_pos_nephew          | 0.633 +/- 0.48 (1407)      |
|    proven_d_2_pos_niece           | 0.791 +/- 0.41 (1124)      |
|    proven_d_2_pos_sister          | 0.823 +/- 0.38 (526)       |
|    proven_d_2_pos_son             | 0.489 +/- 0.50 (609)       |
|    proven_d_2_pos_uncle           | 0.859 +/- 0.35 (1387)      |
|    proven_d_2_pos_wife            | 0.800 +/- 0.40 (50)        |
|    proven_d_4_pos                 | 0.507 +/- 0.50 (148)       |
|    proven_d_4_pos_aunt            | 0.344 +/- 0.47 (32)        |
|    proven_d_4_pos_brother         | 0.944 +/- 0.23 (18)        |
|    proven_d_4_pos_daughter        | 0.500 +/- 0.50 (4)         |
|    proven_d_4_pos_father          | 0.700 +/- 0.46 (10)        |
|    proven_d_4_pos_husband         | 0.750 +/- 0.43 (4)         |
|    proven_d_4_pos_mother          | 0.696 +/- 0.46 (23)        |
|    proven_d_4_pos_nephew          | 0.000 +/- 0.00 (11)        |
|    proven_d_4_pos_niece           | 0.875 +/- 0.33 (8)         |
|    proven_d_4_pos_sister          | 0.125 +/- 0.33 (8)         |
|    proven_d_4_pos_son             | 0.231 +/- 0.42 (13)        |
|    proven_d_4_pos_uncle           | 0.471 +/- 0.50 (17)        |
|    proven_d_6_pos                 | 0.750 +/- 0.43 (4)         |
|    proven_d_6_pos_daughter        | 1.000 +/- 0.00 (3)         |
|    proven_d_6_pos_nephew          | 0.000 +/- 0.00 