==============================================
Starting KGE Integration Experiments
Dataset: wn18rr
Timesteps: 500000
Eval: 100 queries, 10 corruptions
Test: 500 queries, 100 corruptions
Started at: Thu Jan  8 04:04:16 AM CET 2026
==============================================

[1/10] Running: RL Only (no KGE)
==============================================
Grid search: 1 params, 1 experiments.

============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: wn18rr-250-128-torchrl
======================================================================
Training: wn18rr
Envs: 128, Steps: 256, Timesteps: 500000
Seed: 0
======================================================================

[1/3] Creating components...
[UnificationEngine] Capping max_fact_pairs from 34796 to 1000
[EnvOptimal] Compiled with mode=reduce-overhead, fullgraph=True

[2/3] Running training...
[PPO] Compiled ranking_step (double-buffered) with mode=default

[Checkpoint] Loading existing model at start of training (load_model=True)...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_03_55_42.pt

============================================================
Initial evaluation (untrained model)
============================================================
[Eval] Took 8.64 seconds

[Ranking] MRR: current=0.609, best=0.609 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.495                    |
|    Hits@10              | 0.935                    |
|    Hits@3               | 0.620                    |
|    MRR                  | 0.609                    |
|    len_d_-1_pos         | 12.750                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 7.896                    |
|    len_pos              | 8.490                    |
|    mrr_mean             | 0.609                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.010                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.010                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

============================================================

[PPO] Rollout collected in 9.06s. FPS: 3616.46
Epoch 1/5. 
Losses: total 0.07480, value 0.17863, policy 0.00063, entropy -0.00054, approx_kl 0.04363 clip_fraction 0.00232. 
Epoch 2/5. 
Losses: total 0.05505, value 0.14041, policy 0.00063, entropy -0.00053, approx_kl 0.09048 clip_fraction 0.00299. 
Epoch 3/5. 
Losses: total 0.04263, value 0.12116, policy 0.00074, entropy -0.00055, approx_kl 0.13986 clip_fraction 0.00365. 
Epoch 4/5. 
Losses: total 0.03032, value 0.10906, policy 0.00072, entropy -0.00053, approx_kl 0.15585 clip_fraction 0.00397. 
Epoch 5/5. 
Losses: total 0.03069, value 0.10036, policy 0.00072, entropy -0.00051, approx_kl 0.17780 clip_fraction 0.00418. 
[PPO] Training completed in 24.08s
[Metrics] Reward (train): current=0.744, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.268                    |
|    ep_rew_mean          | 0.744                    |
|    explained_variance   | 0.581                    |
|    len                  | 5.268 +/- 7.16 (5976)    |
|    len_d_1_pos          | 4.794 +/- 7.23 (2308)    |
|    len_d_2_pos          | 5.449 +/- 7.47 (207)     |
|    len_d_3_pos          | 5.311 +/- 7.63 (212)     |
|    len_d_4_pos          | 5.022 +/- 7.41 (136)     |
|    len_d_unknown_neg    | 5.616 +/- 7.01 (3113)    |
|    len_neg              | 5.616 +/- 7.01 (3113)    |
|    len_pos              | 4.890 +/- 7.29 (2863)    |
|    proven_d_1_pos       | 0.747 +/- 0.43 (2308)    |
|    proven_d_2_pos       | 0.700 +/- 0.46 (207)     |
|    proven_d_3_pos       | 0.731 +/- 0.44 (212)     |
|    proven_d_4_pos       | 0.728 +/- 0.45 (136)     |
|    proven_d_unknown_neg | 0.007 +/- 0.09 (3113)    |
|    proven_neg           | 0.007 +/- 0.09 (3113)    |
|    proven_pos           | 0.741 +/- 0.44 (2863)    |
|    reward               | 0.744 +/- 0.67 (5976)    |
|    reward_d_1_pos       | 0.493 +/- 0.87 (2308)    |
|    reward_d_2_pos       | 0.401 +/- 0.92 (207)     |
|    reward_d_3_pos       | 0.462 +/- 0.89 (212)     |
|    reward_d_4_pos       | 0.456 +/- 0.89 (136)     |
|    reward_d_unknown_neg | 0.985 +/- 0.17 (3113)    |
|    reward_neg           | 0.985 +/- 0.17 (3113)    |
|    reward_pos           | 0.482 +/- 0.88 (2863)    |
|    success_rate         | 0.359                    |
|    time/elapsed         | 42                       |
|    time/fps             | 768                      |
|    total_timesteps      | 32768                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.36s. FPS: 24108.11
Epoch 1/5. 
Losses: total 0.07029, value 0.18592, policy 0.00085, entropy -0.00065, approx_kl 0.18315 clip_fraction 0.00317. 
Epoch 2/5. 
Losses: total 0.05880, value 0.14593, policy 0.00068, entropy -0.00060, approx_kl 0.15814 clip_fraction 0.00308. 
Epoch 3/5. 
Losses: total 0.04176, value 0.12640, policy 0.00075, entropy -0.00061, approx_kl 0.14536 clip_fraction 0.00320. 
Epoch 4/5. 
Losses: total 0.03482, value 0.11424, policy 0.00067, entropy -0.00056, approx_kl 0.12997 clip_fraction 0.00312. 
Epoch 5/5. 
Losses: total 0.03304, value 0.10508, policy 0.00056, entropy -0.00054, approx_kl 0.12239 clip_fraction 0.00306. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.734, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.451                    |
|    ep_rew_mean          | 0.734                    |
|    explained_variance   | 0.601                    |
|    len                  | 5.451 +/- 7.27 (11682)   |
|    len_d_1_pos          | 5.185 +/- 7.52 (4443)    |
|    len_d_2_pos          | 4.963 +/- 7.17 (428)     |
|    len_d_3_pos          | 5.275 +/- 7.57 (429)     |
|    len_d_4_pos          | 4.832 +/- 7.23 (279)     |
|    len_d_unknown_neg    | 5.721 +/- 7.07 (6103)    |
|    len_neg              | 5.721 +/- 7.07 (6103)    |
|    len_pos              | 5.157 +/- 7.48 (5579)    |
|    proven_d_1_pos       | 0.730 +/- 0.44 (4443)    |
|    proven_d_2_pos       | 0.731 +/- 0.44 (428)     |
|    proven_d_3_pos       | 0.732 +/- 0.44 (429)     |
|    proven_d_4_pos       | 0.735 +/- 0.44 (279)     |
|    proven_d_unknown_neg | 0.008 +/- 0.09 (6103)    |
|    proven_neg           | 0.008 +/- 0.09 (6103)    |
|    proven_pos           | 0.730 +/- 0.44 (5579)    |
|    reward               | 0.734 +/- 0.68 (11682)   |
|    reward_d_1_pos       | 0.459 +/- 0.89 (4443)    |
|    reward_d_2_pos       | 0.463 +/- 0.89 (428)     |
|    reward_d_3_pos       | 0.464 +/- 0.89 (429)     |
|    reward_d_4_pos       | 0.470 +/- 0.88 (279)     |
|    reward_d_unknown_neg | 0.984 +/- 0.18 (6103)    |
|    reward_neg           | 0.984 +/- 0.18 (6103)    |
|    reward_pos           | 0.460 +/- 0.89 (5579)    |
|    success_rate         | 0.353                    |
|    time/elapsed         | 57                       |
|    time/fps             | 2207                     |
|    total_timesteps      | 65536                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.36s. FPS: 24086.10
Epoch 1/5. 
Losses: total 0.06856, value 0.19128, policy 0.00100, entropy -0.00072, approx_kl 0.02053 clip_fraction 0.00217. 
Epoch 2/5. 
Losses: total 0.05637, value 0.15156, policy 0.00075, entropy -0.00063, approx_kl 0.04466 clip_fraction 0.00279. 
Epoch 3/5. 
Losses: total 0.03981, value 0.13044, policy 0.00065, entropy -0.00057, approx_kl 0.05710 clip_fraction 0.00290. 
Epoch 4/5. 
Losses: total 0.03857, value 0.11713, policy 0.00057, entropy -0.00055, approx_kl 0.07287 clip_fraction 0.00307. 
Epoch 5/5. 
Losses: total 0.02835, value 0.10759, policy 0.00049, entropy -0.00052, approx_kl 0.08967 clip_fraction 0.00320. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.552                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.608                    |
|    len                  | 5.552 +/- 7.34 (17293)   |
|    len_d_1_pos          | 5.290 +/- 7.58 (6545)    |
|    len_d_2_pos          | 5.415 +/- 7.57 (624)     |
|    len_d_3_pos          | 5.329 +/- 7.60 (633)     |
|    len_d_4_pos          | 5.215 +/- 7.57 (400)     |
|    len_d_unknown_neg    | 5.780 +/- 7.11 (9091)    |
|    len_neg              | 5.780 +/- 7.11 (9091)    |
|    len_pos              | 5.299 +/- 7.58 (8202)    |
|    proven_d_1_pos       | 0.724 +/- 0.45 (6545)    |
|    proven_d_2_pos       | 0.715 +/- 0.45 (624)     |
|    proven_d_3_pos       | 0.727 +/- 0.45 (633)     |
|    proven_d_4_pos       | 0.725 +/- 0.45 (400)     |
|    proven_d_unknown_neg | 0.009 +/- 0.09 (9091)    |
|    proven_neg           | 0.009 +/- 0.09 (9091)    |
|    proven_pos           | 0.724 +/- 0.45 (8202)    |
|    reward               | 0.729 +/- 0.68 (17293)   |
|    reward_d_1_pos       | 0.448 +/- 0.89 (6545)    |
|    reward_d_2_pos       | 0.429 +/- 0.90 (624)     |
|    reward_d_3_pos       | 0.453 +/- 0.89 (633)     |
|    reward_d_4_pos       | 0.450 +/- 0.89 (400)     |
|    reward_d_unknown_neg | 0.983 +/- 0.18 (9091)    |
|    reward_neg           | 0.983 +/- 0.18 (9091)    |
|    reward_pos           | 0.447 +/- 0.89 (8202)    |
|    success_rate         | 0.348                    |
|    time/elapsed         | 72                       |
|    time/fps             | 2201                     |
|    total_timesteps      | 98304                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.37s. FPS: 23941.53
Epoch 1/5. 
Losses: total 0.06949, value 0.18435, policy 0.00068, entropy -0.00029, approx_kl 0.00704 clip_fraction 0.00113. 
Epoch 2/5. 
Losses: total 0.05552, value 0.14509, policy 0.00046, entropy -0.00030, approx_kl 0.01556 clip_fraction 0.00121. 
Epoch 3/5. 
Losses: total 0.05461, value 0.12497, policy 0.00036, entropy -0.00027, approx_kl 0.01963 clip_fraction 0.00128. 
Epoch 4/5. 
Losses: total 0.03047, value 0.11206, policy 0.00033, entropy -0.00025, approx_kl 0.03066 clip_fraction 0.00140. 
Epoch 5/5. 
Losses: total 0.02941, value 0.10280, policy 0.00030, entropy -0.00025, approx_kl 0.03907 clip_fraction 0.00153. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.557                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.599                    |
|    len                  | 5.557 +/- 7.35 (23100)   |
|    len_d_1_pos          | 5.278 +/- 7.56 (8733)    |
|    len_d_2_pos          | 5.508 +/- 7.65 (828)     |
|    len_d_3_pos          | 5.208 +/- 7.54 (862)     |
|    len_d_4_pos          | 5.208 +/- 7.52 (552)     |
|    len_d_unknown_neg    | 5.802 +/- 7.13 (12125)   |
|    len_neg              | 5.802 +/- 7.13 (12125)   |
|    len_pos              | 5.286 +/- 7.57 (10975)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (8733)    |
|    proven_d_2_pos       | 0.714 +/- 0.45 (828)     |
|    proven_d_3_pos       | 0.739 +/- 0.44 (862)     |
|    proven_d_4_pos       | 0.716 +/- 0.45 (552)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (12125)   |
|    proven_neg           | 0.007 +/- 0.08 (12125)   |
|    proven_pos           | 0.723 +/- 0.45 (10975)   |
|    reward               | 0.729 +/- 0.68 (23100)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (8733)    |
|    reward_d_2_pos       | 0.428 +/- 0.90 (828)     |
|    reward_d_3_pos       | 0.478 +/- 0.88 (862)     |
|    reward_d_4_pos       | 0.431 +/- 0.90 (552)     |
|    reward_d_unknown_neg | 0.985 +/- 0.17 (12125)   |
|    reward_neg           | 0.985 +/- 0.17 (12125)   |
|    reward_pos           | 0.445 +/- 0.90 (10975)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 87                       |
|    time/fps             | 2194                     |
|    total_timesteps      | 131072                   |
----------------------------------------------------

[Eval] Took 1.29 seconds

[Ranking] MRR: current=0.606, best=0.609 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.485                    |
|    Hits@10              | 0.945                    |
|    Hits@3               | 0.630                    |
|    MRR                  | 0.606                    |
|    len_d_-1_pos         | 12.375                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.036                    |
|    len_pos              | 8.310                    |
|    mrr_mean             | 0.606                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.007                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.007                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] New best eval model saved to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_04_04_20.pt (mrr_mean=0.6056)
[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.37s. FPS: 23981.51
Epoch 1/5. 
Losses: total 0.09461, value 0.27491, policy 0.00068, entropy -0.00049, approx_kl 0.03191 clip_fraction 0.00174. 
Epoch 2/5. 
Losses: total 0.05410, value 0.20826, policy 0.00052, entropy -0.00049, approx_kl 0.07071 clip_fraction 0.00250. 
Epoch 3/5. 
Losses: total 0.04802, value 0.17269, policy 0.00037, entropy -0.00045, approx_kl 0.09101 clip_fraction 0.00269. 
Epoch 4/5. 
Losses: total 0.04753, value 0.15088, policy 0.00042, entropy -0.00043, approx_kl 0.10427 clip_fraction 0.00282. 
Epoch 5/5. 
Losses: total 0.03394, value 0.13547, policy 0.00035, entropy -0.00042, approx_kl 0.11386 clip_fraction 0.00294. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.728, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.571                    |
|    ep_rew_mean          | 0.728                    |
|    explained_variance   | 0.392                    |
|    len                  | 5.571 +/- 7.36 (28860)   |
|    len_d_1_pos          | 5.304 +/- 7.58 (10871)   |
|    len_d_2_pos          | 5.359 +/- 7.60 (1043)    |
|    len_d_3_pos          | 5.116 +/- 7.48 (1102)    |
|    len_d_4_pos          | 5.177 +/- 7.49 (694)     |
|    len_d_unknown_neg    | 5.829 +/- 7.16 (15150)   |
|    len_neg              | 5.829 +/- 7.16 (15150)   |
|    len_pos              | 5.286 +/- 7.57 (13710)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (10871)   |
|    proven_d_2_pos       | 0.721 +/- 0.45 (1043)    |
|    proven_d_3_pos       | 0.741 +/- 0.44 (1102)    |
|    proven_d_4_pos       | 0.722 +/- 0.45 (694)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (15150)   |
|    proven_neg           | 0.007 +/- 0.08 (15150)   |
|    proven_pos           | 0.721 +/- 0.45 (13710)   |
|    reward               | 0.728 +/- 0.69 (28860)   |
|    reward_d_1_pos       | 0.438 +/- 0.90 (10871)   |
|    reward_d_2_pos       | 0.442 +/- 0.90 (1043)    |
|    reward_d_3_pos       | 0.483 +/- 0.88 (1102)    |
|    reward_d_4_pos       | 0.444 +/- 0.90 (694)     |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (15150)   |
|    reward_neg           | 0.986 +/- 0.17 (15150)   |
|    reward_pos           | 0.442 +/- 0.90 (13710)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 103                      |
|    time/fps             | 2017                     |
|    total_timesteps      | 163840                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.37s. FPS: 23999.34
Epoch 1/5. 
Losses: total 0.11112, value 0.28284, policy 0.00037, entropy -0.00070, approx_kl 0.07118 clip_fraction 0.00232. 
Epoch 2/5. 
Losses: total 0.07778, value 0.22186, policy 0.00040, entropy -0.00069, approx_kl 0.04987 clip_fraction 0.00226. 
Epoch 3/5. 
Losses: total 0.06026, value 0.18522, policy 0.00028, entropy -0.00065, approx_kl 0.05374 clip_fraction 0.00234. 
Epoch 4/5. 
Losses: total 0.04524, value 0.16161, policy 0.00019, entropy -0.00058, approx_kl 0.05474 clip_fraction 0.00236. 
Epoch 5/5. 
Losses: total 0.03618, value 0.14484, policy 0.00011, entropy -0.00053, approx_kl 0.05646 clip_fraction 0.00234. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.576                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.365                    |
|    len                  | 5.576 +/- 7.37 (34617)   |
|    len_d_1_pos          | 5.282 +/- 7.56 (13071)   |
|    len_d_2_pos          | 5.283 +/- 7.59 (1252)    |
|    len_d_3_pos          | 4.958 +/- 7.37 (1318)    |
|    len_d_4_pos          | 5.175 +/- 7.46 (823)     |
|    len_d_unknown_neg    | 5.870 +/- 7.19 (18153)   |
|    len_neg              | 5.870 +/- 7.19 (18153)   |
|    len_pos              | 5.251 +/- 7.55 (16464)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (13071)   |
|    proven_d_2_pos       | 0.724 +/- 0.45 (1252)    |
|    proven_d_3_pos       | 0.751 +/- 0.43 (1318)    |
|    proven_d_4_pos       | 0.718 +/- 0.45 (823)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (18153)   |
|    proven_neg           | 0.007 +/- 0.08 (18153)   |
|    proven_pos           | 0.722 +/- 0.45 (16464)   |
|    reward               | 0.729 +/- 0.68 (34617)   |
|    reward_d_1_pos       | 0.440 +/- 0.90 (13071)   |
|    reward_d_2_pos       | 0.447 +/- 0.89 (1252)    |
|    reward_d_3_pos       | 0.502 +/- 0.86 (1318)    |
|    reward_d_4_pos       | 0.436 +/- 0.90 (823)     |
|    reward_d_unknown_neg | 0.986 +/- 0.16 (18153)   |
|    reward_neg           | 0.986 +/- 0.16 (18153)   |
|    reward_pos           | 0.445 +/- 0.90 (16464)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 118                      |
|    time/fps             | 2196                     |
|    total_timesteps      | 196608                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.37s. FPS: 23989.13
Epoch 1/5. 
Losses: total 0.10234, value 0.28484, policy 0.00060, entropy -0.00068, approx_kl 0.01248 clip_fraction 0.00180. 
Epoch 2/5. 
Losses: total 0.06680, value 0.22479, policy 0.00061, entropy -0.00068, approx_kl 0.02288 clip_fraction 0.00214. 
Epoch 3/5. 
Losses: total 0.05888, value 0.18907, policy 0.00058, entropy -0.00063, approx_kl 0.04469 clip_fraction 0.00229. 
Epoch 4/5. 
Losses: total 0.04794, value 0.16552, policy 0.00051, entropy -0.00058, approx_kl 0.05185 clip_fraction 0.00237. 
Epoch 5/5. 
Losses: total 0.05887, value 0.14903, policy 0.00043, entropy -0.00055, approx_kl 0.05511 clip_fraction 0.00241. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.574                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.382                    |
|    len                  | 5.574 +/- 7.37 (40435)   |
|    len_d_1_pos          | 5.308 +/- 7.58 (15252)   |
|    len_d_2_pos          | 5.290 +/- 7.60 (1463)    |
|    len_d_3_pos          | 5.004 +/- 7.41 (1544)    |
|    len_d_4_pos          | 5.024 +/- 7.39 (974)     |
|    len_d_unknown_neg    | 5.852 +/- 7.17 (21202)   |
|    len_neg              | 5.852 +/- 7.17 (21202)   |
|    len_pos              | 5.268 +/- 7.56 (19233)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (15252)   |
|    proven_d_2_pos       | 0.723 +/- 0.45 (1463)    |
|    proven_d_3_pos       | 0.746 +/- 0.44 (1544)    |
|    proven_d_4_pos       | 0.731 +/- 0.44 (974)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (21202)   |
|    proven_neg           | 0.007 +/- 0.08 (21202)   |
|    proven_pos           | 0.722 +/- 0.45 (19233)   |
|    reward               | 0.729 +/- 0.68 (40435)   |
|    reward_d_1_pos       | 0.438 +/- 0.90 (15252)   |
|    reward_d_2_pos       | 0.446 +/- 0.89 (1463)    |
|    reward_d_3_pos       | 0.492 +/- 0.87 (1544)    |
|    reward_d_4_pos       | 0.462 +/- 0.89 (974)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (21202)   |
|    reward_neg           | 0.987 +/- 0.16 (21202)   |
|    reward_pos           | 0.444 +/- 0.90 (19233)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 133                      |
|    time/fps             | 2195                     |
|    total_timesteps      | 229376                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.37s. FPS: 23968.44
Epoch 1/5. 
Losses: total 0.10476, value 0.28576, policy 0.00024, entropy -0.00049, approx_kl 0.00692 clip_fraction 0.00143. 
Epoch 2/5. 
Losses: total 0.07356, value 0.22977, policy 0.00015, entropy -0.00044, approx_kl 0.01743 clip_fraction 0.00186. 
Epoch 3/5. 
Losses: total 0.04996, value 0.19592, policy 0.00019, entropy -0.00046, approx_kl 0.02091 clip_fraction 0.00207. 
Epoch 4/5. 
Losses: total 0.05688, value 0.17281, policy 0.00015, entropy -0.00048, approx_kl 0.02282 clip_fraction 0.00218. 
Epoch 5/5. 
Losses: total 0.03798, value 0.15623, policy 0.00015, entropy -0.00050, approx_kl 0.02458 clip_fraction 0.00233. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.580                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.405                    |
|    len                  | 5.580 +/- 7.37 (46184)   |
|    len_d_1_pos          | 5.298 +/- 7.58 (17393)   |
|    len_d_2_pos          | 5.208 +/- 7.54 (1703)    |
|    len_d_3_pos          | 5.034 +/- 7.42 (1761)    |
|    len_d_4_pos          | 5.134 +/- 7.47 (1108)    |
|    len_d_unknown_neg    | 5.869 +/- 7.19 (24219)   |
|    len_neg              | 5.869 +/- 7.19 (24219)   |
|    len_pos              | 5.261 +/- 7.56 (21965)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (17393)   |
|    proven_d_2_pos       | 0.727 +/- 0.45 (1703)    |
|    proven_d_3_pos       | 0.742 +/- 0.44 (1761)    |
|    proven_d_4_pos       | 0.727 +/- 0.45 (1108)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (24219)   |
|    proven_neg           | 0.007 +/- 0.08 (24219)   |
|    proven_pos           | 0.723 +/- 0.45 (21965)   |
|    reward               | 0.729 +/- 0.68 (46184)   |
|    reward_d_1_pos       | 0.440 +/- 0.90 (17393)   |
|    reward_d_2_pos       | 0.454 +/- 0.89 (1703)    |
|    reward_d_3_pos       | 0.483 +/- 0.88 (1761)    |
|    reward_d_4_pos       | 0.455 +/- 0.89 (1108)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (24219)   |
|    reward_neg           | 0.987 +/- 0.16 (24219)   |
|    reward_pos           | 0.445 +/- 0.90 (21965)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 148                      |
|    time/fps             | 2193                     |
|    total_timesteps      | 262144                   |
----------------------------------------------------

[Eval] Took 1.29 seconds

[Ranking] MRR: current=0.607, best=0.609 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.490                    |
|    Hits@10              | 0.960                    |
|    Hits@3               | 0.625                    |
|    MRR                  | 0.607                    |
|    len_d_-1_pos         | 12.479                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 7.965                    |
|    len_pos              | 8.360                    |
|    mrr_mean             | 0.607                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.006                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.006                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] New best eval model saved to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_04_04_20.pt (mrr_mean=0.6073)
[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.36s. FPS: 24066.51
Epoch 1/5. 
Losses: total 0.10920, value 0.28615, policy 0.00035, entropy -0.00050, approx_kl 0.02128 clip_fraction 0.00165. 
Epoch 2/5. 
Losses: total 0.07856, value 0.23178, policy 0.00061, entropy -0.00044, approx_kl 0.03735 clip_fraction 0.00168. 
Epoch 3/5. 
Losses: total 0.05463, value 0.19678, policy 0.00048, entropy -0.00039, approx_kl 0.04190 clip_fraction 0.00185. 
Epoch 4/5. 
Losses: total 0.05991, value 0.17334, policy 0.00044, entropy -0.00038, approx_kl 0.05769 clip_fraction 0.00217. 
Epoch 5/5. 
Losses: total 0.03904, value 0.15657, policy 0.00042, entropy -0.00037, approx_kl 0.07635 clip_fraction 0.00237. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.728, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.584                    |
|    ep_rew_mean          | 0.728                    |
|    explained_variance   | 0.407                    |
|    len                  | 5.584 +/- 7.38 (51966)   |
|    len_d_1_pos          | 5.333 +/- 7.60 (19566)   |
|    len_d_2_pos          | 5.181 +/- 7.53 (1913)    |
|    len_d_3_pos          | 5.031 +/- 7.43 (1997)    |
|    len_d_4_pos          | 5.114 +/- 7.46 (1251)    |
|    len_d_unknown_neg    | 5.855 +/- 7.18 (27239)   |
|    len_neg              | 5.855 +/- 7.18 (27239)   |
|    len_pos              | 5.285 +/- 7.58 (24727)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (19566)   |
|    proven_d_2_pos       | 0.730 +/- 0.44 (1913)    |
|    proven_d_3_pos       | 0.742 +/- 0.44 (1997)    |
|    proven_d_4_pos       | 0.730 +/- 0.44 (1251)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (27239)   |
|    proven_neg           | 0.006 +/- 0.08 (27239)   |
|    proven_pos           | 0.721 +/- 0.45 (24727)   |
|    reward               | 0.728 +/- 0.69 (51966)   |
|    reward_d_1_pos       | 0.436 +/- 0.90 (19566)   |
|    reward_d_2_pos       | 0.461 +/- 0.89 (1913)    |
|    reward_d_3_pos       | 0.483 +/- 0.88 (1997)    |
|    reward_d_4_pos       | 0.460 +/- 0.89 (1251)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (27239)   |
|    reward_neg           | 0.987 +/- 0.16 (27239)   |
|    reward_pos           | 0.443 +/- 0.90 (24727)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 164                      |
|    time/fps             | 2010                     |
|    total_timesteps      | 294912                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.36s. FPS: 24030.18
Epoch 1/5. 
Losses: total 0.12018, value 0.27579, policy 0.00069, entropy -0.00079, approx_kl 0.00298 clip_fraction 0.00146. 
Epoch 2/5. 
Losses: total 0.07895, value 0.22735, policy 0.00043, entropy -0.00076, approx_kl 0.01674 clip_fraction 0.00183. 
Epoch 3/5. 
Losses: total 0.06088, value 0.19396, policy 0.00023, entropy -0.00067, approx_kl 0.02462 clip_fraction 0.00197. 
Epoch 4/5. 
Losses: total 0.04848, value 0.17075, policy 0.00012, entropy -0.00065, approx_kl 0.02901 clip_fraction 0.00207. 
Epoch 5/5. 
Losses: total 0.04645, value 0.15414, policy 0.00002, entropy -0.00066, approx_kl 0.03539 clip_fraction 0.00222. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.727, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.604                    |
|    ep_rew_mean          | 0.727                    |
|    explained_variance   | 0.450                    |
|    len                  | 5.604 +/- 7.39 (57542)   |
|    len_d_1_pos          | 5.368 +/- 7.62 (21631)   |
|    len_d_2_pos          | 5.194 +/- 7.55 (2134)    |
|    len_d_3_pos          | 5.148 +/- 7.50 (2210)    |
|    len_d_4_pos          | 4.996 +/- 7.40 (1400)    |
|    len_d_unknown_neg    | 5.864 +/- 7.19 (30167)   |
|    len_neg              | 5.864 +/- 7.19 (30167)   |
|    len_pos              | 5.317 +/- 7.60 (27375)   |
|    proven_d_1_pos       | 0.716 +/- 0.45 (21631)   |
|    proven_d_2_pos       | 0.730 +/- 0.44 (2134)    |
|    proven_d_3_pos       | 0.736 +/- 0.44 (2210)    |
|    proven_d_4_pos       | 0.739 +/- 0.44 (1400)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (30167)   |
|    proven_neg           | 0.006 +/- 0.08 (30167)   |
|    proven_pos           | 0.720 +/- 0.45 (27375)   |
|    reward               | 0.727 +/- 0.69 (57542)   |
|    reward_d_1_pos       | 0.432 +/- 0.90 (21631)   |
|    reward_d_2_pos       | 0.460 +/- 0.89 (2134)    |
|    reward_d_3_pos       | 0.471 +/- 0.88 (2210)    |
|    reward_d_4_pos       | 0.479 +/- 0.88 (1400)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (30167)   |
|    reward_neg           | 0.988 +/- 0.16 (30167)   |
|    reward_pos           | 0.439 +/- 0.90 (27375)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 179                      |
|    time/fps             | 2193                     |
|    total_timesteps      | 327680                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.37s. FPS: 23963.51
Epoch 1/5. 
Losses: total 0.10491, value 0.28325, policy 0.00054, entropy -0.00056, approx_kl 0.00328 clip_fraction 0.00104. 
Epoch 2/5. 
Losses: total 0.09228, value 0.23797, policy 0.00034, entropy -0.00052, approx_kl 0.01119 clip_fraction 0.00128. 
Epoch 3/5. 
Losses: total 0.06072, value 0.20718, policy 0.00025, entropy -0.00051, approx_kl 0.02127 clip_fraction 0.00157. 
Epoch 4/5. 
Losses: total 0.04542, value 0.18410, policy 0.00018, entropy -0.00051, approx_kl 0.02566 clip_fraction 0.00166. 
Epoch 5/5. 
Losses: total 0.04813, value 0.16696, policy 0.00012, entropy -0.00048, approx_kl 0.02876 clip_fraction 0.00173. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.727, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.601                    |
|    ep_rew_mean          | 0.727                    |
|    explained_variance   | 0.429                    |
|    len                  | 5.601 +/- 7.39 (63367)   |
|    len_d_1_pos          | 5.362 +/- 7.62 (23819)   |
|    len_d_2_pos          | 5.191 +/- 7.55 (2353)    |
|    len_d_3_pos          | 5.125 +/- 7.49 (2459)    |
|    len_d_4_pos          | 5.100 +/- 7.47 (1520)    |
|    len_d_unknown_neg    | 5.860 +/- 7.19 (33216)   |
|    len_neg              | 5.860 +/- 7.19 (33216)   |
|    len_pos              | 5.316 +/- 7.60 (30151)   |
|    proven_d_1_pos       | 0.717 +/- 0.45 (23819)   |
|    proven_d_2_pos       | 0.732 +/- 0.44 (2353)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (2459)    |
|    proven_d_4_pos       | 0.734 +/- 0.44 (1520)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (33216)   |
|    proven_neg           | 0.006 +/- 0.08 (33216)   |
|    proven_pos           | 0.720 +/- 0.45 (30151)   |
|    reward               | 0.727 +/- 0.69 (63367)   |
|    reward_d_1_pos       | 0.433 +/- 0.90 (23819)   |
|    reward_d_2_pos       | 0.464 +/- 0.89 (2353)    |
|    reward_d_3_pos       | 0.470 +/- 0.88 (2459)    |
|    reward_d_4_pos       | 0.467 +/- 0.88 (1520)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (33216)   |
|    reward_neg           | 0.988 +/- 0.15 (33216)   |
|    reward_pos           | 0.440 +/- 0.90 (30151)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 194                      |
|    time/fps             | 2189                     |
|    total_timesteps      | 360448                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.37s. FPS: 23930.40
Epoch 1/5. 
Losses: total 0.11838, value 0.28565, policy 0.00027, entropy -0.00042, approx_kl 0.00265 clip_fraction 0.00073. 
Epoch 2/5. 
Losses: total 0.07980, value 0.24257, policy 0.00023, entropy -0.00040, approx_kl 0.00887 clip_fraction 0.00096. 
Epoch 3/5. 
Losses: total 0.07177, value 0.21246, policy 0.00023, entropy -0.00043, approx_kl 0.01112 clip_fraction 0.00108. 
Epoch 4/5. 
Losses: total 0.05522, value 0.19095, policy 0.00015, entropy -0.00042, approx_kl 0.01255 clip_fraction 0.00112. 
Epoch 5/5. 
Losses: total 0.04842, value 0.17498, policy 0.00010, entropy -0.00039, approx_kl 0.01443 clip_fraction 0.00113. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.728, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.608                    |
|    ep_rew_mean          | 0.728                    |
|    explained_variance   | 0.435                    |
|    len                  | 5.608 +/- 7.40 (69065)   |
|    len_d_1_pos          | 5.360 +/- 7.62 (25966)   |
|    len_d_2_pos          | 5.283 +/- 7.61 (2545)    |
|    len_d_3_pos          | 5.097 +/- 7.45 (2694)    |
|    len_d_4_pos          | 5.050 +/- 7.43 (1649)    |
|    len_d_unknown_neg    | 5.871 +/- 7.20 (36211)   |
|    len_neg              | 5.871 +/- 7.20 (36211)   |
|    len_pos              | 5.317 +/- 7.60 (32854)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (25966)   |
|    proven_d_2_pos       | 0.727 +/- 0.45 (2545)    |
|    proven_d_3_pos       | 0.736 +/- 0.44 (2694)    |
|    proven_d_4_pos       | 0.736 +/- 0.44 (1649)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (36211)   |
|    proven_neg           | 0.006 +/- 0.08 (36211)   |
|    proven_pos           | 0.721 +/- 0.45 (32854)   |
|    reward               | 0.728 +/- 0.69 (69065)   |
|    reward_d_1_pos       | 0.435 +/- 0.90 (25966)   |
|    reward_d_2_pos       | 0.453 +/- 0.89 (2545)    |
|    reward_d_3_pos       | 0.472 +/- 0.88 (2694)    |
|    reward_d_4_pos       | 0.472 +/- 0.88 (1649)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (36211)   |
|    reward_neg           | 0.988 +/- 0.15 (36211)   |
|    reward_pos           | 0.441 +/- 0.90 (32854)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 209                      |
|    time/fps             | 2188                     |
|    total_timesteps      | 393216                   |
----------------------------------------------------

[Eval] Took 1.29 seconds

[Ranking] MRR: current=0.607, best=0.609 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.485                    |
|    Hits@10              | 0.940                    |
|    Hits@3               | 0.630                    |
|    MRR                  | 0.607                    |
|    len_d_-1_pos         | 12.771                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 7.993                    |
|    len_pos              | 8.500                    |
|    mrr_mean             | 0.607                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.008                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.008                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.37s. FPS: 23903.35
Epoch 1/5. 
Losses: total 0.13398, value 0.29872, policy 0.00034, entropy -0.00049, approx_kl 0.00385 clip_fraction 0.00082. 
Epoch 2/5. 
Losses: total 0.10446, value 0.25990, policy 0.00026, entropy -0.00045, approx_kl 0.01007 clip_fraction 0.00110. 
Epoch 3/5. 
Losses: total 0.07927, value 0.23222, policy 0.00020, entropy -0.00044, approx_kl 0.01033 clip_fraction 0.00119. 
Epoch 4/5. 
Losses: total 0.07303, value 0.21086, policy 0.00015, entropy -0.00041, approx_kl 0.01196 clip_fraction 0.00118. 
Epoch 5/5. 
Losses: total 0.05467, value 0.19418, policy 0.00010, entropy -0.00042, approx_kl 0.01397 clip_fraction 0.00128. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.728, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.609                    |
|    ep_rew_mean          | 0.728                    |
|    explained_variance   | 0.437                    |
|    len                  | 5.609 +/- 7.40 (74810)   |
|    len_d_1_pos          | 5.372 +/- 7.63 (28110)   |
|    len_d_2_pos          | 5.349 +/- 7.64 (2755)    |
|    len_d_3_pos          | 5.026 +/- 7.41 (2946)    |
|    len_d_4_pos          | 5.106 +/- 7.47 (1779)    |
|    len_d_unknown_neg    | 5.864 +/- 7.19 (39220)   |
|    len_neg              | 5.864 +/- 7.19 (39220)   |
|    len_pos              | 5.329 +/- 7.61 (35590)   |
|    proven_d_1_pos       | 0.717 +/- 0.45 (28110)   |
|    proven_d_2_pos       | 0.723 +/- 0.45 (2755)    |
|    proven_d_3_pos       | 0.741 +/- 0.44 (2946)    |
|    proven_d_4_pos       | 0.732 +/- 0.44 (1779)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (39220)   |
|    proven_neg           | 0.006 +/- 0.08 (39220)   |
|    proven_pos           | 0.720 +/- 0.45 (35590)   |
|    reward               | 0.728 +/- 0.69 (74810)   |
|    reward_d_1_pos       | 0.434 +/- 0.90 (28110)   |
|    reward_d_2_pos       | 0.445 +/- 0.90 (2755)    |
|    reward_d_3_pos       | 0.481 +/- 0.88 (2946)    |
|    reward_d_4_pos       | 0.464 +/- 0.89 (1779)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (39220)   |
|    reward_neg           | 0.988 +/- 0.15 (39220)   |
|    reward_pos           | 0.440 +/- 0.90 (35590)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 225                      |
|    time/fps             | 2013                     |
|    total_timesteps      | 425984                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.37s. FPS: 23947.47
Epoch 1/5. 
Losses: total 0.14260, value 0.31261, policy 0.00024, entropy -0.00072, approx_kl 0.00236 clip_fraction 0.00098. 
Epoch 2/5. 
Losses: total 0.11425, value 0.27909, policy 0.00007, entropy -0.00062, approx_kl 0.02107 clip_fraction 0.00117. 
Epoch 3/5. 
Losses: total 0.09121, value 0.25321, policy 0.00002, entropy -0.00059, approx_kl 0.02014 clip_fraction 0.00132. 
Epoch 4/5. 
Losses: total 0.08661, value 0.23221, policy -0.00004, entropy -0.00057, approx_kl 0.01964 clip_fraction 0.00141. 
Epoch 5/5. 
Losses: total 0.07416, value 0.21529, policy -0.00010, entropy -0.00056, approx_kl 0.01944 clip_fraction 0.00150. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.728, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.603                    |
|    ep_rew_mean          | 0.728                    |
|    explained_variance   | 0.421                    |
|    len                  | 5.603 +/- 7.40 (80681)   |
|    len_d_1_pos          | 5.350 +/- 7.62 (30374)   |
|    len_d_2_pos          | 5.382 +/- 7.66 (2956)    |
|    len_d_3_pos          | 5.036 +/- 7.42 (3153)    |
|    len_d_4_pos          | 5.181 +/- 7.54 (1897)    |
|    len_d_unknown_neg    | 5.861 +/- 7.19 (42301)   |
|    len_neg              | 5.861 +/- 7.19 (42301)   |
|    len_pos              | 5.319 +/- 7.60 (38380)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (30374)   |
|    proven_d_2_pos       | 0.721 +/- 0.45 (2956)    |
|    proven_d_3_pos       | 0.740 +/- 0.44 (3153)    |
|    proven_d_4_pos       | 0.729 +/- 0.44 (1897)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (42301)   |
|    proven_neg           | 0.006 +/- 0.08 (42301)   |
|    proven_pos           | 0.721 +/- 0.45 (38380)   |
|    reward               | 0.728 +/- 0.69 (80681)   |
|    reward_d_1_pos       | 0.436 +/- 0.90 (30374)   |
|    reward_d_2_pos       | 0.442 +/- 0.90 (2956)    |
|    reward_d_3_pos       | 0.480 +/- 0.88 (3153)    |
|    reward_d_4_pos       | 0.458 +/- 0.89 (1897)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (42301)   |
|    reward_neg           | 0.988 +/- 0.15 (42301)   |
|    reward_pos           | 0.441 +/- 0.90 (38380)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 240                      |
|    time/fps             | 2185                     |
|    total_timesteps      | 458752                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.36s. FPS: 24053.17
Epoch 1/5. 
Losses: total 0.14698, value 0.30744, policy 0.00034, entropy -0.00079, approx_kl 0.00072 clip_fraction 0.00089. 
Epoch 2/5. 
Losses: total 0.13379, value 0.28588, policy 0.00014, entropy -0.00069, approx_kl 0.00173 clip_fraction 0.00107. 
Epoch 3/5. 
Losses: total 0.11613, value 0.26832, policy 0.00004, entropy -0.00065, approx_kl 0.00229 clip_fraction 0.00110. 
Epoch 4/5. 
Losses: total 0.10019, value 0.25352, policy 0.00002, entropy -0.00061, approx_kl 0.00268 clip_fraction 0.00114. 
Epoch 5/5. 
Losses: total 0.10058, value 0.24054, policy -0.00000, entropy -0.00058, approx_kl 0.00301 clip_fraction 0.00120. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.599                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.453                    |
|    len                  | 5.599 +/- 7.40 (86501)   |
|    len_d_1_pos          | 5.334 +/- 7.61 (32593)   |
|    len_d_2_pos          | 5.410 +/- 7.69 (3155)    |
|    len_d_3_pos          | 5.043 +/- 7.42 (3374)    |
|    len_d_4_pos          | 5.152 +/- 7.53 (2021)    |
|    len_d_unknown_neg    | 5.864 +/- 7.20 (45358)   |
|    len_neg              | 5.864 +/- 7.20 (45358)   |
|    len_pos              | 5.307 +/- 7.60 (41143)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (32593)   |
|    proven_d_2_pos       | 0.721 +/- 0.45 (3155)    |
|    proven_d_3_pos       | 0.739 +/- 0.44 (3374)    |
|    proven_d_4_pos       | 0.732 +/- 0.44 (2021)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (45358)   |
|    proven_neg           | 0.006 +/- 0.08 (45358)   |
|    proven_pos           | 0.722 +/- 0.45 (41143)   |
|    reward               | 0.729 +/- 0.68 (86501)   |
|    reward_d_1_pos       | 0.438 +/- 0.90 (32593)   |
|    reward_d_2_pos       | 0.442 +/- 0.90 (3155)    |
|    reward_d_3_pos       | 0.478 +/- 0.88 (3374)    |
|    reward_d_4_pos       | 0.464 +/- 0.89 (2021)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (45358)   |
|    reward_neg           | 0.988 +/- 0.15 (45358)   |
|    reward_pos           | 0.443 +/- 0.90 (41143)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 255                      |
|    time/fps             | 2186                     |
|    total_timesteps      | 491520                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt
[PPO] Rollout collected in 1.37s. FPS: 23975.53
Epoch 1/5. 
Losses: total 0.14467, value 0.31543, policy 0.00009, entropy -0.00050, approx_kl 0.00006 clip_fraction 0.00034. 
Epoch 2/5. 
Losses: total 0.15731, value 0.30647, policy 0.00000, entropy -0.00046, approx_kl 0.00032 clip_fraction 0.00038. 
Epoch 3/5. 
Losses: total 0.14453, value 0.29868, policy -0.00004, entropy -0.00043, approx_kl 0.00064 clip_fraction 0.00045. 
Epoch 4/5. 
Losses: total 0.12411, value 0.29170, policy -0.00007, entropy -0.00042, approx_kl 0.00082 clip_fraction 0.00049. 
Epoch 5/5. 
Losses: total 0.13850, value 0.28528, policy -0.00009, entropy -0.00041, approx_kl 0.00093 clip_fraction 0.00053. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.602                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.446                    |
|    len                  | 5.602 +/- 7.40 (92228)   |
|    len_d_1_pos          | 5.343 +/- 7.62 (34729)   |
|    len_d_2_pos          | 5.415 +/- 7.69 (3365)    |
|    len_d_3_pos          | 5.060 +/- 7.43 (3604)    |
|    len_d_4_pos          | 5.099 +/- 7.49 (2149)    |
|    len_d_unknown_neg    | 5.863 +/- 7.20 (48381)   |
|    len_neg              | 5.863 +/- 7.20 (48381)   |
|    len_pos              | 5.313 +/- 7.60 (43847)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (34729)   |
|    proven_d_2_pos       | 0.721 +/- 0.45 (3365)    |
|    proven_d_3_pos       | 0.738 +/- 0.44 (3604)    |
|    proven_d_4_pos       | 0.733 +/- 0.44 (2149)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (48381)   |
|    proven_neg           | 0.006 +/- 0.08 (48381)   |
|    proven_pos           | 0.722 +/- 0.45 (43847)   |
|    reward               | 0.729 +/- 0.68 (92228)   |
|    reward_d_1_pos       | 0.439 +/- 0.90 (34729)   |
|    reward_d_2_pos       | 0.441 +/- 0.90 (3365)    |
|    reward_d_3_pos       | 0.477 +/- 0.88 (3604)    |
|    reward_d_4_pos       | 0.467 +/- 0.88 (2149)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (48381)   |
|    reward_neg           | 0.988 +/- 0.15 (48381)   |
|    reward_pos           | 0.444 +/- 0.90 (43847)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 270                      |
|    time/fps             | 2182                     |
|    total_timesteps      | 524288                   |
----------------------------------------------------

[Eval] Took 1.29 seconds

[Ranking] MRR: current=0.603, best=0.609 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.485                    |
|    Hits@10              | 0.965                    |
|    Hits@3               | 0.620                    |
|    MRR                  | 0.603                    |
|    len_d_-1_pos         | 12.875                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.036                    |
|    len_pos              | 8.550                    |
|    mrr_mean             | 0.603                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.010                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.010                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_04_20.pt

[Checkpoint] Restoring best model at end of training...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_04_04_20.pt
Loaded best model info: {'metric': 'mrr_mean', 'best_value': 0.6073029935359955, 'timesteps': 8, 'explained_variance': 0.4047859311103821}

[3/3] Running evaluation...

Results: MRR=0.3947, Hits@1=0.3640, Hits@3=0.3820, Hits@10=0.4390
Proven: pos=0.3740, neg=0.0118
Writing results to /home/castellanoontiv/Batched_Env/kge_experiments/runs/averaged_runs/experiments.csv

============================================================
All experiments completed!
============================================================


[2/10] Running: KGE Only
==============================================
Grid search: 1 params, 1 experiments.

============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: wn18rr-250-128-torchrl
======================================================================
Training: wn18rr
Envs: 128, Steps: 256, Timesteps: 0
Seed: 0
======================================================================

[1/3] Creating components...
[UnificationEngine] Capping max_fact_pairs from 34796 to 1000
[EnvOptimal] Compiled with mode=reduce-overhead, fullgraph=True

[2/3] Running training...
KGE Engine initialized with backend: pytorch (signature: torch_wn18rr_RotatE_1024_20260107_125531_s42)
[PPO] Compiled ranking_step (double-buffered) with mode=default

[Checkpoint] Loading existing model at start of training (load_model=True)...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_04_04_20.pt
[Ranking] Skipping initial evaluation as total_timesteps=0

[3/3] Running evaluation...
Building model and loading weights...
Weights loaded successfully.

Results: MRR=0.8410, Hits@1=0.7870, Hits@3=0.8750, Hits@10=0.9310
Proven: pos=0.3730, neg=0.0126
Writing results to /home/castellanoontiv/Batched_Env/kge_experiments/runs/averaged_runs/experiments.csv

============================================================
All experiments completed!
============================================================


[3/10] Running: Hybrid Baseline (KGE + RL fixed weights)
==============================================
Grid search: 1 params, 1 experiments.

============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: wn18rr-250-128-torchrl
======================================================================
Training: wn18rr
Envs: 128, Steps: 256, Timesteps: 500000
Seed: 0
======================================================================

[1/3] Creating components...
[UnificationEngine] Capping max_fact_pairs from 34796 to 1000
[EnvOptimal] Compiled with mode=reduce-overhead, fullgraph=True

[2/3] Running training...
KGE Engine initialized with backend: pytorch (signature: torch_wn18rr_RotatE_1024_20260107_125531_s42)
[PPO] Compiled ranking_step (double-buffered) with mode=default

[Checkpoint] Loading existing model at start of training (load_model=True)...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_04_04_20.pt

============================================================
Initial evaluation (untrained model)
============================================================
Building model and loading weights...
Weights loaded successfully.
[Eval] Took 8.18 seconds

[Ranking] MRR: current=0.942, best=0.942 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.980                    |
|    MRR                  | 0.942                    |
|    len_d_-1_pos         | 12.479                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 7.945                    |
|    len_pos              | 8.360                    |
|    mrr_mean             | 0.942                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.008                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.008                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

============================================================

[PPO] Rollout collected in 3.35s. FPS: 9771.37
Epoch 1/5. 
Losses: total 0.07782, value 0.17892, policy 0.00053, entropy -0.00047, approx_kl 0.01439 clip_fraction 0.00168. 
Epoch 2/5. 
Losses: total 0.04558, value 0.13898, policy 0.00052, entropy -0.00041, approx_kl 0.05125 clip_fraction 0.00240. 
Epoch 3/5. 
Losses: total 0.03763, value 0.11940, policy 0.00046, entropy -0.00041, approx_kl 0.05954 clip_fraction 0.00252. 
Epoch 4/5. 
Losses: total 0.03223, value 0.10754, policy 0.00040, entropy -0.00040, approx_kl 0.06547 clip_fraction 0.00252. 
Epoch 5/5. 
Losses: total 0.03500, value 0.09885, policy 0.00033, entropy -0.00039, approx_kl 0.06988 clip_fraction 0.00255. 
[PPO] Training completed in 14.29s
[Metrics] Reward (train): current=0.746, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.357                    |
|    ep_rew_mean          | 0.746                    |
|    explained_variance   | 0.575                    |
|    len                  | 5.357 +/- 7.23 (5872)    |
|    len_d_1_pos          | 4.908 +/- 7.33 (2257)    |
|    len_d_2_pos          | 5.374 +/- 7.56 (206)     |
|    len_d_3_pos          | 4.907 +/- 7.35 (225)     |
|    len_d_4_pos          | 4.621 +/- 7.02 (132)     |
|    len_d_unknown_neg    | 5.752 +/- 7.10 (3052)    |
|    len_neg              | 5.752 +/- 7.10 (3052)    |
|    len_pos              | 4.929 +/- 7.33 (2820)    |
|    proven_d_1_pos       | 0.743 +/- 0.44 (2257)    |
|    proven_d_2_pos       | 0.709 +/- 0.45 (206)     |
|    proven_d_3_pos       | 0.747 +/- 0.43 (225)     |
|    proven_d_4_pos       | 0.727 +/- 0.45 (132)     |
|    proven_d_unknown_neg | 0.005 +/- 0.07 (3052)    |
|    proven_neg           | 0.005 +/- 0.07 (3052)    |
|    proven_pos           | 0.740 +/- 0.44 (2820)    |
|    reward               | 0.746 +/- 0.67 (5872)    |
|    reward_d_1_pos       | 0.487 +/- 0.87 (2257)    |
|    reward_d_2_pos       | 0.417 +/- 0.91 (206)     |
|    reward_d_3_pos       | 0.493 +/- 0.87 (225)     |
|    reward_d_4_pos       | 0.455 +/- 0.89 (132)     |
|    reward_d_unknown_neg | 0.990 +/- 0.14 (3052)    |
|    reward_neg           | 0.990 +/- 0.14 (3052)    |
|    reward_pos           | 0.481 +/- 0.88 (2820)    |
|    success_rate         | 0.358                    |
|    time/elapsed         | 26                       |
|    time/fps             | 1232                     |
|    total_timesteps      | 32768                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.35s. FPS: 24231.36
Epoch 1/5. 
Losses: total 0.06263, value 0.17584, policy 0.00045, entropy -0.00076, approx_kl 0.03165 clip_fraction 0.00250. 
Epoch 2/5. 
Losses: total 0.05568, value 0.13688, policy 0.00040, entropy -0.00063, approx_kl 0.04082 clip_fraction 0.00256. 
Epoch 3/5. 
Losses: total 0.03344, value 0.11749, policy 0.00032, entropy -0.00061, approx_kl 0.05991 clip_fraction 0.00276. 
Epoch 4/5. 
Losses: total 0.03259, value 0.10546, policy 0.00027, entropy -0.00057, approx_kl 0.07938 clip_fraction 0.00293. 
Epoch 5/5. 
Losses: total 0.02907, value 0.09662, policy 0.00021, entropy -0.00054, approx_kl 0.08876 clip_fraction 0.00299. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.737, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.458                    |
|    ep_rew_mean          | 0.737                    |
|    explained_variance   | 0.611                    |
|    len                  | 5.458 +/- 7.28 (11689)   |
|    len_d_1_pos          | 5.180 +/- 7.50 (4469)    |
|    len_d_2_pos          | 5.083 +/- 7.40 (424)     |
|    len_d_3_pos          | 4.912 +/- 7.33 (432)     |
|    len_d_4_pos          | 4.647 +/- 7.03 (278)     |
|    len_d_unknown_neg    | 5.764 +/- 7.11 (6086)    |
|    len_neg              | 5.764 +/- 7.11 (6086)    |
|    len_pos              | 5.126 +/- 7.46 (5603)    |
|    proven_d_1_pos       | 0.731 +/- 0.44 (4469)    |
|    proven_d_2_pos       | 0.724 +/- 0.45 (424)     |
|    proven_d_3_pos       | 0.745 +/- 0.44 (432)     |
|    proven_d_4_pos       | 0.737 +/- 0.44 (278)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (6086)    |
|    proven_neg           | 0.006 +/- 0.08 (6086)    |
|    proven_pos           | 0.732 +/- 0.44 (5603)    |
|    reward               | 0.737 +/- 0.68 (11689)   |
|    reward_d_1_pos       | 0.463 +/- 0.89 (4469)    |
|    reward_d_2_pos       | 0.448 +/- 0.89 (424)     |
|    reward_d_3_pos       | 0.491 +/- 0.87 (432)     |
|    reward_d_4_pos       | 0.475 +/- 0.88 (278)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (6086)    |
|    reward_neg           | 0.987 +/- 0.16 (6086)    |
|    reward_pos           | 0.464 +/- 0.89 (5603)    |
|    success_rate         | 0.354                    |
|    time/elapsed         | 41                       |
|    time/fps             | 2208                     |
|    total_timesteps      | 65536                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.36s. FPS: 24096.28
Epoch 1/5. 
Losses: total 0.06686, value 0.18806, policy 0.00069, entropy -0.00083, approx_kl 0.02141 clip_fraction 0.00241. 
Epoch 2/5. 
Losses: total 0.04737, value 0.14598, policy 0.00058, entropy -0.00068, approx_kl 0.02646 clip_fraction 0.00247. 
Epoch 3/5. 
Losses: total 0.03879, value 0.12492, policy 0.00052, entropy -0.00069, approx_kl 0.03383 clip_fraction 0.00257. 
Epoch 4/5. 
Losses: total 0.03240, value 0.11157, policy 0.00065, entropy -0.00076, approx_kl 0.05857 clip_fraction 0.00329. 
Epoch 5/5. 
Losses: total 0.02735, value 0.10205, policy 0.00072, entropy -0.00077, approx_kl 0.09508 clip_fraction 0.00400. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.735, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.476                    |
|    ep_rew_mean          | 0.735                    |
|    explained_variance   | 0.596                    |
|    len                  | 5.476 +/- 7.30 (17545)   |
|    len_d_1_pos          | 5.201 +/- 7.52 (6686)    |
|    len_d_2_pos          | 5.400 +/- 7.66 (625)     |
|    len_d_3_pos          | 4.849 +/- 7.30 (656)     |
|    len_d_4_pos          | 5.078 +/- 7.45 (410)     |
|    len_d_unknown_neg    | 5.744 +/- 7.08 (9168)    |
|    len_neg              | 5.744 +/- 7.08 (9168)    |
|    len_pos              | 5.182 +/- 7.51 (8377)    |
|    proven_d_1_pos       | 0.728 +/- 0.44 (6686)    |
|    proven_d_2_pos       | 0.720 +/- 0.45 (625)     |
|    proven_d_3_pos       | 0.750 +/- 0.43 (656)     |
|    proven_d_4_pos       | 0.729 +/- 0.44 (410)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (9168)    |
|    proven_neg           | 0.007 +/- 0.08 (9168)    |
|    proven_pos           | 0.729 +/- 0.44 (8377)    |
|    reward               | 0.735 +/- 0.68 (17545)   |
|    reward_d_1_pos       | 0.456 +/- 0.89 (6686)    |
|    reward_d_2_pos       | 0.440 +/- 0.90 (625)     |
|    reward_d_3_pos       | 0.500 +/- 0.87 (656)     |
|    reward_d_4_pos       | 0.459 +/- 0.89 (410)     |
|    reward_d_unknown_neg | 0.986 +/- 0.16 (9168)    |
|    reward_neg           | 0.986 +/- 0.16 (9168)    |
|    reward_pos           | 0.459 +/- 0.89 (8377)    |
|    success_rate         | 0.352                    |
|    time/elapsed         | 56                       |
|    time/fps             | 2201                     |
|    total_timesteps      | 98304                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.38s. FPS: 23809.74
Epoch 1/5. 
Losses: total 0.08762, value 0.20151, policy 0.00110, entropy -0.00074, approx_kl 0.20432 clip_fraction 0.00507. 
Epoch 2/5. 
Losses: total 0.06111, value 0.15950, policy 0.00103, entropy -0.00071, approx_kl 0.22635 clip_fraction 0.00534. 
Epoch 3/5. 
Losses: total 0.04385, value 0.13673, policy 0.00099, entropy -0.00065, approx_kl 0.20660 clip_fraction 0.00499. 
Epoch 4/5. 
Losses: total 0.03927, value 0.12222, policy 0.00109, entropy -0.00059, approx_kl 0.22707 clip_fraction 0.00516. 
Epoch 5/5. 
Losses: total 0.04041, value 0.11181, policy 0.00103, entropy -0.00056, approx_kl 0.24148 clip_fraction 0.00514. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.733, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.444                    |
|    ep_rew_mean          | 0.733                    |
|    explained_variance   | 0.585                    |
|    len                  | 5.444 +/- 7.27 (23591)   |
|    len_d_1_pos          | 5.150 +/- 7.48 (8984)    |
|    len_d_2_pos          | 5.555 +/- 7.77 (833)     |
|    len_d_3_pos          | 4.837 +/- 7.30 (895)     |
|    len_d_4_pos          | 5.333 +/- 7.65 (549)     |
|    len_d_unknown_neg    | 5.701 +/- 7.05 (12330)   |
|    len_neg              | 5.701 +/- 7.05 (12330)   |
|    len_pos              | 5.164 +/- 7.50 (11261)   |
|    proven_d_1_pos       | 0.727 +/- 0.45 (8984)    |
|    proven_d_2_pos       | 0.711 +/- 0.45 (833)     |
|    proven_d_3_pos       | 0.755 +/- 0.43 (895)     |
|    proven_d_4_pos       | 0.719 +/- 0.45 (549)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (12330)   |
|    proven_neg           | 0.007 +/- 0.08 (12330)   |
|    proven_pos           | 0.728 +/- 0.45 (11261)   |
|    reward               | 0.733 +/- 0.68 (23591)   |
|    reward_d_1_pos       | 0.455 +/- 0.89 (8984)    |
|    reward_d_2_pos       | 0.421 +/- 0.91 (833)     |
|    reward_d_3_pos       | 0.511 +/- 0.86 (895)     |
|    reward_d_4_pos       | 0.439 +/- 0.90 (549)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (12330)   |
|    reward_neg           | 0.987 +/- 0.16 (12330)   |
|    reward_pos           | 0.456 +/- 0.89 (11261)   |
|    success_rate         | 0.351                    |
|    time/elapsed         | 71                       |
|    time/fps             | 2198                     |
|    total_timesteps      | 131072                   |
----------------------------------------------------

[Eval] Took 1.34 seconds

[Ranking] MRR: current=0.952, best=0.952 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.920                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.985                    |
|    MRR                  | 0.952                    |
|    len_d_-1_pos         | 14.062                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.550                    |
|    len_pos              | 9.120                    |
|    mrr_mean             | 0.952                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.005                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.005                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] New best eval model saved to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_04_10_59.pt (mrr_mean=0.9520)
[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.36s. FPS: 24074.06
Epoch 1/5. 
Losses: total 0.07985, value 0.22296, policy 0.00044, entropy -0.00067, approx_kl 0.02849 clip_fraction 0.00266. 
Epoch 2/5. 
Losses: total 0.05180, value 0.17668, policy 0.00040, entropy -0.00059, approx_kl 0.08388 clip_fraction 0.00340. 
Epoch 3/5. 
Losses: total 0.04435, value 0.15211, policy 0.00040, entropy -0.00056, approx_kl 0.10445 clip_fraction 0.00373. 
Epoch 4/5. 
Losses: total 0.04621, value 0.13613, policy 0.00041, entropy -0.00056, approx_kl 0.11921 clip_fraction 0.00391. 
Epoch 5/5. 
Losses: total 0.03939, value 0.12465, policy 0.00041, entropy -0.00058, approx_kl 0.14298 clip_fraction 0.00431. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.729, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.508                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.537                    |
|    len                  | 5.508 +/- 7.32 (29226)   |
|    len_d_1_pos          | 5.269 +/- 7.57 (11079)   |
|    len_d_2_pos          | 5.376 +/- 7.66 (1066)    |
|    len_d_3_pos          | 4.975 +/- 7.39 (1119)    |
|    len_d_4_pos          | 5.454 +/- 7.77 (679)     |
|    len_d_unknown_neg    | 5.732 +/- 7.07 (15283)   |
|    len_neg              | 5.732 +/- 7.07 (15283)   |
|    len_pos              | 5.262 +/- 7.57 (13943)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (11079)   |
|    proven_d_2_pos       | 0.721 +/- 0.45 (1066)    |
|    proven_d_3_pos       | 0.742 +/- 0.44 (1119)    |
|    proven_d_4_pos       | 0.720 +/- 0.45 (679)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (15283)   |
|    proven_neg           | 0.007 +/- 0.08 (15283)   |
|    proven_pos           | 0.723 +/- 0.45 (13943)   |
|    reward               | 0.729 +/- 0.68 (29226)   |
|    reward_d_1_pos       | 0.443 +/- 0.90 (11079)   |
|    reward_d_2_pos       | 0.443 +/- 0.90 (1066)    |
|    reward_d_3_pos       | 0.483 +/- 0.88 (1119)    |
|    reward_d_4_pos       | 0.440 +/- 0.90 (679)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (15283)   |
|    reward_neg           | 0.987 +/- 0.16 (15283)   |
|    reward_pos           | 0.446 +/- 0.89 (13943)   |
|    success_rate         | 0.349                    |
|    time/elapsed         | 87                       |
|    time/fps             | 2011                     |
|    total_timesteps      | 163840                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.36s. FPS: 24048.41
Epoch 1/5. 
Losses: total 0.08478, value 0.22631, policy 0.00063, entropy -0.00086, approx_kl 0.02086 clip_fraction 0.00223. 
Epoch 2/5. 
Losses: total 0.06381, value 0.17740, policy 0.00149, entropy -0.00075, approx_kl 0.02931 clip_fraction 0.00252. 
Epoch 3/5. 
Losses: total 0.05606, value 0.15114, policy 0.00117, entropy -0.00073, approx_kl 0.04158 clip_fraction 0.00285. 
Epoch 4/5. 
Losses: total 0.04408, value 0.13434, policy 0.00100, entropy -0.00071, approx_kl 0.04820 clip_fraction 0.00305. 
Epoch 5/5. 
Losses: total 0.03664, value 0.12227, policy 0.00085, entropy -0.00069, approx_kl 0.05200 clip_fraction 0.00315. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.732, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.510                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.503                    |
|    len                  | 5.510 +/- 7.32 (35043)   |
|    len_d_1_pos          | 5.240 +/- 7.55 (13279)   |
|    len_d_2_pos          | 5.282 +/- 7.60 (1279)    |
|    len_d_3_pos          | 4.828 +/- 7.27 (1339)    |
|    len_d_4_pos          | 5.451 +/- 7.73 (804)     |
|    len_d_unknown_neg    | 5.773 +/- 7.10 (18342)   |
|    len_neg              | 5.773 +/- 7.10 (18342)   |
|    len_pos              | 5.221 +/- 7.54 (16701)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (13279)   |
|    proven_d_2_pos       | 0.725 +/- 0.45 (1279)    |
|    proven_d_3_pos       | 0.753 +/- 0.43 (1339)    |
|    proven_d_4_pos       | 0.719 +/- 0.45 (804)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (18342)   |
|    proven_neg           | 0.006 +/- 0.08 (18342)   |
|    proven_pos           | 0.725 +/- 0.45 (16701)   |
|    reward               | 0.732 +/- 0.68 (35043)   |
|    reward_d_1_pos       | 0.446 +/- 0.89 (13279)   |
|    reward_d_2_pos       | 0.450 +/- 0.89 (1279)    |
|    reward_d_3_pos       | 0.506 +/- 0.86 (1339)    |
|    reward_d_4_pos       | 0.438 +/- 0.90 (804)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (18342)   |
|    reward_neg           | 0.987 +/- 0.16 (18342)   |
|    reward_pos           | 0.451 +/- 0.89 (16701)   |
|    success_rate         | 0.349                    |
|    time/elapsed         | 102                      |
|    time/fps             | 2198                     |
|    total_timesteps      | 196608                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.36s. FPS: 24099.95
Epoch 1/5. 
Losses: total 0.07870, value 0.22143, policy 0.00034, entropy -0.00079, approx_kl 0.02247 clip_fraction 0.00214. 
Epoch 2/5. 
Losses: total 0.06076, value 0.17899, policy 0.00034, entropy -0.00074, approx_kl 0.03725 clip_fraction 0.00255. 
Epoch 3/5. 
Losses: total 0.05595, value 0.15482, policy 0.00024, entropy -0.00068, approx_kl 0.04092 clip_fraction 0.00268. 
Epoch 4/5. 
Losses: total 0.04518, value 0.13884, policy 0.00023, entropy -0.00068, approx_kl 0.04541 clip_fraction 0.00282. 
Epoch 5/5. 
Losses: total 0.04450, value 0.12725, policy 0.00017, entropy -0.00064, approx_kl 0.04841 clip_fraction 0.00282. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.521                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.544                    |
|    len                  | 5.521 +/- 7.33 (40836)   |
|    len_d_1_pos          | 5.265 +/- 7.56 (15448)   |
|    len_d_2_pos          | 5.294 +/- 7.63 (1485)    |
|    len_d_3_pos          | 4.852 +/- 7.30 (1572)    |
|    len_d_4_pos          | 5.329 +/- 7.68 (964)     |
|    len_d_unknown_neg    | 5.780 +/- 7.11 (21367)   |
|    len_neg              | 5.780 +/- 7.11 (21367)   |
|    len_pos              | 5.237 +/- 7.55 (19469)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (15448)   |
|    proven_d_2_pos       | 0.725 +/- 0.45 (1485)    |
|    proven_d_3_pos       | 0.752 +/- 0.43 (1572)    |
|    proven_d_4_pos       | 0.729 +/- 0.44 (964)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (21367)   |
|    proven_neg           | 0.006 +/- 0.08 (21367)   |
|    proven_pos           | 0.725 +/- 0.45 (19469)   |
|    reward               | 0.731 +/- 0.68 (40836)   |
|    reward_d_1_pos       | 0.443 +/- 0.90 (15448)   |
|    reward_d_2_pos       | 0.451 +/- 0.89 (1485)    |
|    reward_d_3_pos       | 0.504 +/- 0.86 (1572)    |
|    reward_d_4_pos       | 0.459 +/- 0.89 (964)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (21367)   |
|    reward_neg           | 0.987 +/- 0.16 (21367)   |
|    reward_pos           | 0.449 +/- 0.89 (19469)   |
|    success_rate         | 0.349                    |
|    time/elapsed         | 117                      |
|    time/fps             | 2196                     |
|    total_timesteps      | 229376                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.36s. FPS: 24106.45
Epoch 1/5. 
Losses: total 0.08626, value 0.23185, policy 0.00026, entropy -0.00065, approx_kl 0.00584 clip_fraction 0.00159. 
Epoch 2/5. 
Losses: total 0.06258, value 0.18936, policy 0.00028, entropy -0.00069, approx_kl 0.02161 clip_fraction 0.00218. 
Epoch 3/5. 
Losses: total 0.05467, value 0.16469, policy 0.00028, entropy -0.00062, approx_kl 0.03030 clip_fraction 0.00233. 
Epoch 4/5. 
Losses: total 0.05313, value 0.14858, policy 0.00027, entropy -0.00059, approx_kl 0.04093 clip_fraction 0.00248. 
Epoch 5/5. 
Losses: total 0.04376, value 0.13720, policy 0.00022, entropy -0.00060, approx_kl 0.04651 clip_fraction 0.00260. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.732, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.530                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.524                    |
|    len                  | 5.530 +/- 7.33 (46626)   |
|    len_d_1_pos          | 5.247 +/- 7.55 (17577)   |
|    len_d_2_pos          | 5.194 +/- 7.55 (1724)    |
|    len_d_3_pos          | 4.856 +/- 7.29 (1802)    |
|    len_d_4_pos          | 5.412 +/- 7.73 (1099)    |
|    len_d_unknown_neg    | 5.813 +/- 7.13 (24424)   |
|    len_neg              | 5.813 +/- 7.13 (24424)   |
|    len_pos              | 5.219 +/- 7.54 (22202)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (17577)   |
|    proven_d_2_pos       | 0.731 +/- 0.44 (1724)    |
|    proven_d_3_pos       | 0.748 +/- 0.43 (1802)    |
|    proven_d_4_pos       | 0.724 +/- 0.45 (1099)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (24424)   |
|    proven_neg           | 0.007 +/- 0.08 (24424)   |
|    proven_pos           | 0.726 +/- 0.45 (22202)   |
|    reward               | 0.732 +/- 0.68 (46626)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (17577)   |
|    reward_d_2_pos       | 0.463 +/- 0.89 (1724)    |
|    reward_d_3_pos       | 0.496 +/- 0.87 (1802)    |
|    reward_d_4_pos       | 0.449 +/- 0.89 (1099)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (24424)   |
|    reward_neg           | 0.987 +/- 0.16 (24424)   |
|    reward_pos           | 0.451 +/- 0.89 (22202)   |
|    success_rate         | 0.349                    |
|    time/elapsed         | 132                      |
|    time/fps             | 2196                     |
|    total_timesteps      | 262144                   |
----------------------------------------------------

[Eval] Took 1.33 seconds

[Ranking] MRR: current=0.940, best=0.952 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.965                    |
|    MRR                  | 0.940                    |
|    len_d_-1_pos         | 13.104                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.389                    |
|    len_pos              | 8.660                    |
|    mrr_mean             | 0.940                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.008                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.008                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.35s. FPS: 24211.49
Epoch 1/5. 
Losses: total 0.10899, value 0.28573, policy 0.00068, entropy -0.00073, approx_kl 0.01100 clip_fraction 0.00192. 
Epoch 2/5. 
Losses: total 0.06362, value 0.22962, policy 0.00044, entropy -0.00066, approx_kl 0.02459 clip_fraction 0.00230. 
Epoch 3/5. 
Losses: total 0.06334, value 0.19468, policy 0.00034, entropy -0.00059, approx_kl 0.03367 clip_fraction 0.00251. 
Epoch 4/5. 
Losses: total 0.05303, value 0.17140, policy 0.00028, entropy -0.00055, approx_kl 0.04587 clip_fraction 0.00272. 
Epoch 5/5. 
Losses: total 0.04308, value 0.15475, policy 0.00021, entropy -0.00049, approx_kl 0.05498 clip_fraction 0.00282. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.542                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.413                    |
|    len                  | 5.542 +/- 7.34 (52370)   |
|    len_d_1_pos          | 5.309 +/- 7.60 (19742)   |
|    len_d_2_pos          | 5.110 +/- 7.50 (1939)    |
|    len_d_3_pos          | 4.990 +/- 7.39 (2005)    |
|    len_d_4_pos          | 5.333 +/- 7.69 (1237)    |
|    len_d_unknown_neg    | 5.790 +/- 7.12 (27447)   |
|    len_neg              | 5.790 +/- 7.12 (27447)   |
|    len_pos              | 5.269 +/- 7.58 (24923)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (19742)   |
|    proven_d_2_pos       | 0.736 +/- 0.44 (1939)    |
|    proven_d_3_pos       | 0.742 +/- 0.44 (2005)    |
|    proven_d_4_pos       | 0.728 +/- 0.44 (1237)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (27447)   |
|    proven_neg           | 0.006 +/- 0.08 (27447)   |
|    proven_pos           | 0.724 +/- 0.45 (24923)   |
|    reward               | 0.730 +/- 0.68 (52370)   |
|    reward_d_1_pos       | 0.440 +/- 0.90 (19742)   |
|    reward_d_2_pos       | 0.472 +/- 0.88 (1939)    |
|    reward_d_3_pos       | 0.483 +/- 0.88 (2005)    |
|    reward_d_4_pos       | 0.457 +/- 0.89 (1237)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (27447)   |
|    reward_neg           | 0.988 +/- 0.16 (27447)   |
|    reward_pos           | 0.447 +/- 0.89 (24923)   |
|    success_rate         | 0.348                    |
|    time/elapsed         | 148                      |
|    time/fps             | 2016                     |
|    total_timesteps      | 294912                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.37s. FPS: 23835.23
Epoch 1/5. 
Losses: total 0.10261, value 0.28296, policy 0.00066, entropy -0.00102, approx_kl 0.06222 clip_fraction 0.00311. 
Epoch 2/5. 
Losses: total 0.08471, value 0.23383, policy 0.00049, entropy -0.00084, approx_kl 0.08062 clip_fraction 0.00343. 
Epoch 3/5. 
Losses: total 0.06615, value 0.20013, policy 0.00039, entropy -0.00076, approx_kl 0.08197 clip_fraction 0.00349. 
Epoch 4/5. 
Losses: total 0.05852, value 0.17704, policy 0.00028, entropy -0.00072, approx_kl 0.08560 clip_fraction 0.00359. 
Epoch 5/5. 
Losses: total 0.04646, value 0.16038, policy 0.00023, entropy -0.00067, approx_kl 0.09094 clip_fraction 0.00366. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.579                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.419                    |
|    len                  | 5.579 +/- 7.37 (57802)   |
|    len_d_1_pos          | 5.346 +/- 7.62 (21758)   |
|    len_d_2_pos          | 5.096 +/- 7.48 (2151)    |
|    len_d_3_pos          | 5.076 +/- 7.46 (2215)    |
|    len_d_4_pos          | 5.224 +/- 7.61 (1379)    |
|    len_d_unknown_neg    | 5.833 +/- 7.15 (30299)   |
|    len_neg              | 5.833 +/- 7.15 (30299)   |
|    len_pos              | 5.299 +/- 7.60 (27503)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (21758)   |
|    proven_d_2_pos       | 0.736 +/- 0.44 (2151)    |
|    proven_d_3_pos       | 0.739 +/- 0.44 (2215)    |
|    proven_d_4_pos       | 0.735 +/- 0.44 (1379)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (30299)   |
|    proven_neg           | 0.006 +/- 0.08 (30299)   |
|    proven_pos           | 0.722 +/- 0.45 (27503)   |
|    reward               | 0.729 +/- 0.68 (57802)   |
|    reward_d_1_pos       | 0.437 +/- 0.90 (21758)   |
|    reward_d_2_pos       | 0.473 +/- 0.88 (2151)    |
|    reward_d_3_pos       | 0.478 +/- 0.88 (2215)    |
|    reward_d_4_pos       | 0.471 +/- 0.88 (1379)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (30299)   |
|    reward_neg           | 0.988 +/- 0.16 (30299)   |
|    reward_pos           | 0.445 +/- 0.90 (27503)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 163                      |
|    time/fps             | 2191                     |
|    total_timesteps      | 327680                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.35s. FPS: 24199.72
Epoch 1/5. 
Losses: total 0.11457, value 0.28661, policy 0.00064, entropy -0.00074, approx_kl 0.03578 clip_fraction 0.00241. 
Epoch 2/5. 
Losses: total 0.09097, value 0.23828, policy 0.00069, entropy -0.00066, approx_kl 0.05239 clip_fraction 0.00294. 
Epoch 3/5. 
Losses: total 0.05836, value 0.20620, policy 0.00062, entropy -0.00067, approx_kl 0.05046 clip_fraction 0.00302. 
Epoch 4/5. 
Losses: total 0.04330, value 0.18350, policy 0.00054, entropy -0.00070, approx_kl 0.04888 clip_fraction 0.00304. 
Epoch 5/5. 
Losses: total 0.04387, value 0.16651, policy 0.00046, entropy -0.00065, approx_kl 0.05038 clip_fraction 0.00298. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.586                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.426                    |
|    len                  | 5.586 +/- 7.38 (63536)   |
|    len_d_1_pos          | 5.336 +/- 7.61 (23914)   |
|    len_d_2_pos          | 5.131 +/- 7.51 (2360)    |
|    len_d_3_pos          | 5.103 +/- 7.47 (2441)    |
|    len_d_4_pos          | 5.322 +/- 7.68 (1499)    |
|    len_d_unknown_neg    | 5.845 +/- 7.17 (33322)   |
|    len_neg              | 5.845 +/- 7.17 (33322)   |
|    len_pos              | 5.301 +/- 7.59 (30214)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (23914)   |
|    proven_d_2_pos       | 0.732 +/- 0.44 (2360)    |
|    proven_d_3_pos       | 0.736 +/- 0.44 (2441)    |
|    proven_d_4_pos       | 0.730 +/- 0.44 (1499)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (33322)   |
|    proven_neg           | 0.006 +/- 0.08 (33322)   |
|    proven_pos           | 0.722 +/- 0.45 (30214)   |
|    reward               | 0.729 +/- 0.68 (63536)   |
|    reward_d_1_pos       | 0.438 +/- 0.90 (23914)   |
|    reward_d_2_pos       | 0.464 +/- 0.89 (2360)    |
|    reward_d_3_pos       | 0.472 +/- 0.88 (2441)    |
|    reward_d_4_pos       | 0.461 +/- 0.89 (1499)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (33322)   |
|    reward_neg           | 0.988 +/- 0.15 (33322)   |
|    reward_pos           | 0.444 +/- 0.90 (30214)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 178                      |
|    time/fps             | 2193                     |
|    total_timesteps      | 360448                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.35s. FPS: 24185.16
Epoch 1/5. 
Losses: total 0.11501, value 0.28850, policy 0.00064, entropy -0.00068, approx_kl 0.00906 clip_fraction 0.00174. 
Epoch 2/5. 
Losses: total 0.07995, value 0.24564, policy 0.00055, entropy -0.00069, approx_kl 0.01735 clip_fraction 0.00212. 
Epoch 3/5. 
Losses: total 0.07166, value 0.21536, policy 0.00041, entropy -0.00063, approx_kl 0.02076 clip_fraction 0.00217. 
Epoch 4/5. 
Losses: total 0.06181, value 0.19278, policy 0.00031, entropy -0.00059, approx_kl 0.02235 clip_fraction 0.00220. 
Epoch 5/5. 
Losses: total 0.04588, value 0.17568, policy 0.00024, entropy -0.00059, approx_kl 0.02519 clip_fraction 0.00228. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.589                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.428                    |
|    len                  | 5.589 +/- 7.38 (69275)   |
|    len_d_1_pos          | 5.338 +/- 7.61 (26057)   |
|    len_d_2_pos          | 5.200 +/- 7.55 (2554)    |
|    len_d_3_pos          | 5.069 +/- 7.43 (2674)    |
|    len_d_4_pos          | 5.201 +/- 7.59 (1639)    |
|    len_d_unknown_neg    | 5.853 +/- 7.17 (36351)   |
|    len_neg              | 5.853 +/- 7.17 (36351)   |
|    len_pos              | 5.299 +/- 7.59 (32924)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (26057)   |
|    proven_d_2_pos       | 0.729 +/- 0.44 (2554)    |
|    proven_d_3_pos       | 0.736 +/- 0.44 (2674)    |
|    proven_d_4_pos       | 0.736 +/- 0.44 (1639)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (36351)   |
|    proven_neg           | 0.006 +/- 0.08 (36351)   |
|    proven_pos           | 0.722 +/- 0.45 (32924)   |
|    reward               | 0.730 +/- 0.68 (69275)   |
|    reward_d_1_pos       | 0.439 +/- 0.90 (26057)   |
|    reward_d_2_pos       | 0.458 +/- 0.89 (2554)    |
|    reward_d_3_pos       | 0.472 +/- 0.88 (2674)    |
|    reward_d_4_pos       | 0.473 +/- 0.88 (1639)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (36351)   |
|    reward_neg           | 0.988 +/- 0.16 (36351)   |
|    reward_pos           | 0.445 +/- 0.90 (32924)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 193                      |
|    time/fps             | 2191                     |
|    total_timesteps      | 393216                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.950, best=0.952 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.920                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.975                    |
|    MRR                  | 0.950                    |
|    len_d_-1_pos         | 13.542                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.343                    |
|    len_pos              | 8.870                    |
|    mrr_mean             | 0.950                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.35s. FPS: 24191.98
Epoch 1/5. 
Losses: total 0.14500, value 0.30548, policy 0.00087, entropy -0.00094, approx_kl 0.01257 clip_fraction 0.00180. 
Epoch 2/5. 
Losses: total 0.10789, value 0.26849, policy 0.00054, entropy -0.00083, approx_kl 0.02376 clip_fraction 0.00220. 
Epoch 3/5. 
Losses: total 0.07951, value 0.24074, policy 0.00035, entropy -0.00078, approx_kl 0.02287 clip_fraction 0.00234. 
Epoch 4/5. 
Losses: total 0.07800, value 0.21933, policy 0.00020, entropy -0.00073, approx_kl 0.02490 clip_fraction 0.00243. 
Epoch 5/5. 
Losses: total 0.06315, value 0.20225, policy 0.00011, entropy -0.00070, approx_kl 0.02921 clip_fraction 0.00256. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.598                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.439                    |
|    len                  | 5.598 +/- 7.39 (74949)   |
|    len_d_1_pos          | 5.348 +/- 7.62 (28197)   |
|    len_d_2_pos          | 5.288 +/- 7.61 (2751)    |
|    len_d_3_pos          | 5.040 +/- 7.42 (2906)    |
|    len_d_4_pos          | 5.255 +/- 7.62 (1762)    |
|    len_d_unknown_neg    | 5.856 +/- 7.18 (39333)   |
|    len_neg              | 5.856 +/- 7.18 (39333)   |
|    len_pos              | 5.314 +/- 7.60 (35616)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (28197)   |
|    proven_d_2_pos       | 0.724 +/- 0.45 (2751)    |
|    proven_d_3_pos       | 0.738 +/- 0.44 (2906)    |
|    proven_d_4_pos       | 0.732 +/- 0.44 (1762)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (39333)   |
|    proven_neg           | 0.006 +/- 0.08 (39333)   |
|    proven_pos           | 0.722 +/- 0.45 (35616)   |
|    reward               | 0.729 +/- 0.68 (74949)   |
|    reward_d_1_pos       | 0.438 +/- 0.90 (28197)   |
|    reward_d_2_pos       | 0.447 +/- 0.89 (2751)    |
|    reward_d_3_pos       | 0.476 +/- 0.88 (2906)    |
|    reward_d_4_pos       | 0.464 +/- 0.89 (1762)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (39333)   |
|    reward_neg           | 0.988 +/- 0.16 (39333)   |
|    reward_pos           | 0.443 +/- 0.90 (35616)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 209                      |
|    time/fps             | 2013                     |
|    total_timesteps      | 425984                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.36s. FPS: 24145.96
Epoch 1/5. 
Losses: total 0.14215, value 0.30268, policy 0.00028, entropy -0.00123, approx_kl 0.00307 clip_fraction 0.00195. 
Epoch 2/5. 
Losses: total 0.13505, value 0.27214, policy 0.00019, entropy -0.00116, approx_kl 0.00924 clip_fraction 0.00227. 
Epoch 3/5. 
Losses: total 0.09595, value 0.24864, policy 0.00010, entropy -0.00106, approx_kl 0.01390 clip_fraction 0.00245. 
Epoch 4/5. 
Losses: total 0.08879, value 0.22928, policy -0.00000, entropy -0.00101, approx_kl 0.01871 clip_fraction 0.00259. 
Epoch 5/5. 
Losses: total 0.07476, value 0.21320, policy -0.00008, entropy -0.00097, approx_kl 0.02153 clip_fraction 0.00273. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.597                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.450                    |
|    len                  | 5.597 +/- 7.39 (80748)   |
|    len_d_1_pos          | 5.332 +/- 7.61 (30422)   |
|    len_d_2_pos          | 5.379 +/- 7.66 (2944)    |
|    len_d_3_pos          | 5.058 +/- 7.42 (3101)    |
|    len_d_4_pos          | 5.299 +/- 7.66 (1887)    |
|    len_d_unknown_neg    | 5.855 +/- 7.18 (42394)   |
|    len_neg              | 5.855 +/- 7.18 (42394)   |
|    len_pos              | 5.312 +/- 7.61 (38354)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (30422)   |
|    proven_d_2_pos       | 0.720 +/- 0.45 (2944)    |
|    proven_d_3_pos       | 0.736 +/- 0.44 (3101)    |
|    proven_d_4_pos       | 0.731 +/- 0.44 (1887)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (42394)   |
|    proven_neg           | 0.006 +/- 0.08 (42394)   |
|    proven_pos           | 0.722 +/- 0.45 (38354)   |
|    reward               | 0.729 +/- 0.68 (80748)   |
|    reward_d_1_pos       | 0.440 +/- 0.90 (30422)   |
|    reward_d_2_pos       | 0.440 +/- 0.90 (2944)    |
|    reward_d_3_pos       | 0.472 +/- 0.88 (3101)    |
|    reward_d_4_pos       | 0.463 +/- 0.89 (1887)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (42394)   |
|    reward_neg           | 0.988 +/- 0.16 (42394)   |
|    reward_pos           | 0.444 +/- 0.90 (38354)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 224                      |
|    time/fps             | 2188                     |
|    total_timesteps      | 458752                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.35s. FPS: 24198.24
Epoch 1/5. 
Losses: total 0.14377, value 0.30965, policy 0.00008, entropy -0.00093, approx_kl 0.00103 clip_fraction 0.00085. 
Epoch 2/5. 
Losses: total 0.12991, value 0.28807, policy -0.00003, entropy -0.00085, approx_kl 0.00166 clip_fraction 0.00111. 
Epoch 3/5. 
Losses: total 0.12830, value 0.27044, policy -0.00011, entropy -0.00082, approx_kl 0.00256 clip_fraction 0.00123. 
Epoch 4/5. 
Losses: total 0.09757, value 0.25546, policy -0.00016, entropy -0.00081, approx_kl 0.00382 clip_fraction 0.00134. 
Epoch 5/5. 
Losses: total 0.09733, value 0.24258, policy -0.00019, entropy -0.00080, approx_kl 0.00476 clip_fraction 0.00146. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.595                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.454                    |
|    len                  | 5.595 +/- 7.39 (86542)   |
|    len_d_1_pos          | 5.332 +/- 7.62 (32608)   |
|    len_d_2_pos          | 5.417 +/- 7.69 (3158)    |
|    len_d_3_pos          | 5.068 +/- 7.43 (3316)    |
|    len_d_4_pos          | 5.245 +/- 7.61 (2034)    |
|    len_d_unknown_neg    | 5.851 +/- 7.17 (45426)   |
|    len_neg              | 5.851 +/- 7.17 (45426)   |
|    len_pos              | 5.313 +/- 7.61 (41116)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (32608)   |
|    proven_d_2_pos       | 0.719 +/- 0.45 (3158)    |
|    proven_d_3_pos       | 0.736 +/- 0.44 (3316)    |
|    proven_d_4_pos       | 0.731 +/- 0.44 (2034)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (45426)   |
|    proven_neg           | 0.006 +/- 0.08 (45426)   |
|    proven_pos           | 0.722 +/- 0.45 (41116)   |
|    reward               | 0.729 +/- 0.68 (86542)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (32608)   |
|    reward_d_2_pos       | 0.438 +/- 0.90 (3158)    |
|    reward_d_3_pos       | 0.471 +/- 0.88 (3316)    |
|    reward_d_4_pos       | 0.461 +/- 0.89 (2034)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (45426)   |
|    reward_neg           | 0.987 +/- 0.16 (45426)   |
|    reward_pos           | 0.444 +/- 0.90 (41116)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 239                      |
|    time/fps             | 2187                     |
|    total_timesteps      | 491520                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt
[PPO] Rollout collected in 1.36s. FPS: 24159.03
Epoch 1/5. 
Losses: total 0.13158, value 0.32209, policy 0.00001, entropy -0.00104, approx_kl 0.00019 clip_fraction 0.00061. 
Epoch 2/5. 
Losses: total 0.14511, value 0.31305, policy -0.00008, entropy -0.00099, approx_kl 0.00053 clip_fraction 0.00084. 
Epoch 3/5. 
Losses: total 0.13880, value 0.30521, policy -0.00013, entropy -0.00093, approx_kl 0.00092 clip_fraction 0.00091. 
Epoch 4/5. 
Losses: total 0.12624, value 0.29814, policy -0.00014, entropy -0.00092, approx_kl 0.00116 clip_fraction 0.00097. 
Epoch 5/5. 
Losses: total 0.12708, value 0.29170, policy -0.00016, entropy -0.00089, approx_kl 0.00153 clip_fraction 0.00104. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.746 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.599                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.440                    |
|    len                  | 5.599 +/- 7.39 (92222)   |
|    len_d_1_pos          | 5.338 +/- 7.62 (34731)   |
|    len_d_2_pos          | 5.401 +/- 7.68 (3361)    |
|    len_d_3_pos          | 5.077 +/- 7.44 (3537)    |
|    len_d_4_pos          | 5.177 +/- 7.57 (2171)    |
|    len_d_unknown_neg    | 5.857 +/- 7.18 (48422)   |
|    len_neg              | 5.857 +/- 7.18 (48422)   |
|    len_pos              | 5.314 +/- 7.61 (43800)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (34731)   |
|    proven_d_2_pos       | 0.719 +/- 0.45 (3361)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (3537)    |
|    proven_d_4_pos       | 0.733 +/- 0.44 (2171)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (48422)   |
|    proven_neg           | 0.006 +/- 0.08 (48422)   |
|    proven_pos           | 0.723 +/- 0.45 (43800)   |
|    reward               | 0.730 +/- 0.68 (92222)   |
|    reward_d_1_pos       | 0.442 +/- 0.90 (34731)   |
|    reward_d_2_pos       | 0.438 +/- 0.90 (3361)    |
|    reward_d_3_pos       | 0.470 +/- 0.88 (3537)    |
|    reward_d_4_pos       | 0.467 +/- 0.88 (2171)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (48422)   |
|    reward_neg           | 0.988 +/- 0.16 (48422)   |
|    reward_pos           | 0.445 +/- 0.90 (43800)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 254                      |
|    time/fps             | 2185                     |
|    total_timesteps      | 524288                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.945, best=0.952 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.915                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.970                    |
|    MRR                  | 0.945                    |
|    len_d_-1_pos         | 14.188                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.434                    |
|    len_pos              | 9.180                    |
|    mrr_mean             | 0.945                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.010                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.010                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_10_59.pt

[Checkpoint] Restoring best model at end of training...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_04_10_59.pt
Loaded best model info: {'metric': 'mrr_mean', 'best_value': 0.9520021677017212, 'timesteps': 4, 'explained_variance': 0.5845876932144165}

[3/3] Running evaluation...

Results: MRR=0.8361, Hits@1=0.7780, Hits@3=0.8740, Hits@10=0.9310
Proven: pos=0.3690, neg=0.0117
Writing results to /home/castellanoontiv/Batched_Env/kge_experiments/runs/averaged_runs/experiments.csv

============================================================
All experiments completed!
============================================================


[4/10] Running: Neural Bridge (Linear)
==============================================
Grid search: 1 params, 1 experiments.

============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: wn18rr-250-128-torchrl
======================================================================
Training: wn18rr
Envs: 128, Steps: 256, Timesteps: 500000
Seed: 0
======================================================================

[1/3] Creating components...
[UnificationEngine] Capping max_fact_pairs from 34796 to 1000
[EnvOptimal] Compiled with mode=reduce-overhead, fullgraph=True

[2/3] Running training...
KGE Engine initialized with backend: pytorch (signature: torch_wn18rr_RotatE_1024_20260107_125531_s42)
[NeuralBridge] Created LinearBridge with init_alpha=0.5
[PPO] Compiled ranking_step (double-buffered) with mode=default

[Checkpoint] Loading existing model at start of training (load_model=True)...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_04_10_59.pt

============================================================
Initial evaluation (untrained model)
============================================================
Building model and loading weights...
Weights loaded successfully.
[Eval] Took 8.09 seconds

[Ranking] MRR: current=0.942, best=0.942 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.980                    |
|    MRR                  | 0.942                    |
|    len_d_-1_pos         | 14.062                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.391                    |
|    len_pos              | 9.120                    |
|    mrr_mean             | 0.942                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.007                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.007                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

============================================================

[PPO] Rollout collected in 3.31s. FPS: 9888.32
Epoch 1/5. 
Losses: total 0.07053, value 0.16107, policy 0.00110, entropy -0.00090, approx_kl 0.03546 clip_fraction 0.00305. 
Epoch 2/5. 
Losses: total 0.04070, value 0.13168, policy 0.00082, entropy -0.00086, approx_kl 0.07296 clip_fraction 0.00385. 
Epoch 3/5. 
Losses: total 0.03156, value 0.11653, policy 0.00060, entropy -0.00078, approx_kl 0.11500 clip_fraction 0.00432. 
Epoch 4/5. 
Losses: total 0.03741, value 0.10640, policy 0.00043, entropy -0.00072, approx_kl 0.12854 clip_fraction 0.00439. 
Epoch 5/5. 
Losses: total 0.03102, value 0.09875, policy 0.00036, entropy -0.00069, approx_kl 0.14143 clip_fraction 0.00463. 
[PPO] Training completed in 14.31s
[Metrics] Reward (train): current=0.747, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.410                    |
|    ep_rew_mean          | 0.747                    |
|    explained_variance   | 0.680                    |
|    len                  | 5.410 +/- 7.24 (5819)    |
|    len_d_1_pos          | 4.902 +/- 7.30 (2246)    |
|    len_d_2_pos          | 5.606 +/- 7.74 (193)     |
|    len_d_3_pos          | 5.710 +/- 7.88 (221)     |
|    len_d_4_pos          | 4.947 +/- 7.28 (131)     |
|    len_d_unknown_neg    | 5.771 +/- 7.09 (3028)    |
|    len_neg              | 5.771 +/- 7.09 (3028)    |
|    len_pos              | 5.017 +/- 7.39 (2791)    |
|    proven_d_1_pos       | 0.750 +/- 0.43 (2246)    |
|    proven_d_2_pos       | 0.699 +/- 0.46 (193)     |
|    proven_d_3_pos       | 0.710 +/- 0.45 (221)     |
|    proven_d_4_pos       | 0.718 +/- 0.45 (131)     |
|    proven_d_unknown_neg | 0.005 +/- 0.07 (3028)    |
|    proven_neg           | 0.005 +/- 0.07 (3028)    |
|    proven_pos           | 0.742 +/- 0.44 (2791)    |
|    reward               | 0.747 +/- 0.66 (5819)    |
|    reward_d_1_pos       | 0.500 +/- 0.87 (2246)    |
|    reward_d_2_pos       | 0.399 +/- 0.92 (193)     |
|    reward_d_3_pos       | 0.421 +/- 0.91 (221)     |
|    reward_d_4_pos       | 0.435 +/- 0.90 (131)     |
|    reward_d_unknown_neg | 0.991 +/- 0.14 (3028)    |
|    reward_neg           | 0.991 +/- 0.14 (3028)    |
|    reward_pos           | 0.483 +/- 0.88 (2791)    |
|    success_rate         | 0.358                    |
|    time/elapsed         | 26                       |
|    time/fps             | 1239                     |
|    total_timesteps      | 32768                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.35s. FPS: 24232.98
Epoch 1/5. 
Losses: total 0.07097, value 0.16424, policy 0.00086, entropy -0.00068, approx_kl 0.02549 clip_fraction 0.00278. 
Epoch 2/5. 
Losses: total 0.04156, value 0.13213, policy 0.00090, entropy -0.00063, approx_kl 0.06708 clip_fraction 0.00372. 
Epoch 3/5. 
Losses: total 0.03952, value 0.11548, policy 0.00084, entropy -0.00061, approx_kl 0.07892 clip_fraction 0.00385. 
Epoch 4/5. 
Losses: total 0.03957, value 0.10479, policy 0.00080, entropy -0.00055, approx_kl 0.09375 clip_fraction 0.00394. 
Epoch 5/5. 
Losses: total 0.03372, value 0.09687, policy 0.00072, entropy -0.00050, approx_kl 0.10476 clip_fraction 0.00403. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.737, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.561                    |
|    ep_rew_mean          | 0.737                    |
|    explained_variance   | 0.662                    |
|    len                  | 5.561 +/- 7.35 (11467)   |
|    len_d_1_pos          | 5.240 +/- 7.54 (4348)    |
|    len_d_2_pos          | 4.927 +/- 7.25 (423)     |
|    len_d_3_pos          | 5.530 +/- 7.78 (436)     |
|    len_d_4_pos          | 5.222 +/- 7.48 (266)     |
|    len_d_unknown_neg    | 5.855 +/- 7.16 (5994)    |
|    len_neg              | 5.855 +/- 7.16 (5994)    |
|    len_pos              | 5.238 +/- 7.54 (5473)    |
|    proven_d_1_pos       | 0.732 +/- 0.44 (4348)    |
|    proven_d_2_pos       | 0.730 +/- 0.44 (423)     |
|    proven_d_3_pos       | 0.713 +/- 0.45 (436)     |
|    proven_d_4_pos       | 0.714 +/- 0.45 (266)     |
|    proven_d_unknown_neg | 0.005 +/- 0.07 (5994)    |
|    proven_neg           | 0.005 +/- 0.07 (5994)    |
|    proven_pos           | 0.730 +/- 0.44 (5473)    |
|    reward               | 0.737 +/- 0.68 (11467)   |
|    reward_d_1_pos       | 0.465 +/- 0.89 (4348)    |
|    reward_d_2_pos       | 0.461 +/- 0.89 (423)     |
|    reward_d_3_pos       | 0.427 +/- 0.90 (436)     |
|    reward_d_4_pos       | 0.429 +/- 0.90 (266)     |
|    reward_d_unknown_neg | 0.990 +/- 0.14 (5994)    |
|    reward_neg           | 0.990 +/- 0.14 (5994)    |
|    reward_pos           | 0.460 +/- 0.89 (5473)    |
|    success_rate         | 0.351                    |
|    time/elapsed         | 41                       |
|    time/fps             | 2209                     |
|    total_timesteps      | 65536                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24166.40
Epoch 1/5. 
Losses: total 0.07429, value 0.16841, policy 0.00125, entropy -0.00080, approx_kl 0.03693 clip_fraction 0.00259. 
Epoch 2/5. 
Losses: total 0.04719, value 0.13508, policy 0.00101, entropy -0.00070, approx_kl 0.05812 clip_fraction 0.00307. 
Epoch 3/5. 
Losses: total 0.04082, value 0.11839, policy 0.00085, entropy -0.00067, approx_kl 0.08427 clip_fraction 0.00336. 
Epoch 4/5. 
Losses: total 0.04298, value 0.10731, policy 0.00076, entropy -0.00064, approx_kl 0.09693 clip_fraction 0.00350. 
Epoch 5/5. 
Losses: total 0.02414, value 0.09908, policy 0.00067, entropy -0.00059, approx_kl 0.10976 clip_fraction 0.00361. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.735, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.596                    |
|    ep_rew_mean          | 0.735                    |
|    explained_variance   | 0.663                    |
|    len                  | 5.596 +/- 7.37 (17162)   |
|    len_d_1_pos          | 5.260 +/- 7.57 (6512)    |
|    len_d_2_pos          | 5.522 +/- 7.71 (609)     |
|    len_d_3_pos          | 5.297 +/- 7.65 (650)     |
|    len_d_4_pos          | 5.485 +/- 7.72 (394)     |
|    len_d_unknown_neg    | 5.870 +/- 7.15 (8997)    |
|    len_neg              | 5.870 +/- 7.15 (8997)    |
|    len_pos              | 5.293 +/- 7.59 (8165)    |
|    proven_d_1_pos       | 0.730 +/- 0.44 (6512)    |
|    proven_d_2_pos       | 0.708 +/- 0.45 (609)     |
|    proven_d_3_pos       | 0.728 +/- 0.45 (650)     |
|    proven_d_4_pos       | 0.711 +/- 0.45 (394)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (8997)    |
|    proven_neg           | 0.006 +/- 0.08 (8997)    |
|    proven_pos           | 0.727 +/- 0.45 (8165)    |
|    reward               | 0.735 +/- 0.68 (17162)   |
|    reward_d_1_pos       | 0.460 +/- 0.89 (6512)    |
|    reward_d_2_pos       | 0.415 +/- 0.91 (609)     |
|    reward_d_3_pos       | 0.455 +/- 0.89 (650)     |
|    reward_d_4_pos       | 0.421 +/- 0.91 (394)     |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (8997)    |
|    reward_neg           | 0.988 +/- 0.15 (8997)    |
|    reward_pos           | 0.455 +/- 0.89 (8165)    |
|    success_rate         | 0.349                    |
|    time/elapsed         | 56                       |
|    time/fps             | 2202                     |
|    total_timesteps      | 98304                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.35s. FPS: 24212.86
Epoch 1/5. 
Losses: total 0.06598, value 0.17957, policy 0.00032, entropy -0.00068, approx_kl 0.00742 clip_fraction 0.00156. 
Epoch 2/5. 
Losses: total 0.04434, value 0.14144, policy 0.00030, entropy -0.00053, approx_kl 0.01678 clip_fraction 0.00172. 
Epoch 3/5. 
Losses: total 0.03852, value 0.12089, policy 0.00028, entropy -0.00050, approx_kl 0.03209 clip_fraction 0.00228. 
Epoch 4/5. 
Losses: total 0.03191, value 0.10825, policy 0.00017, entropy -0.00047, approx_kl 0.03724 clip_fraction 0.00233. 
Epoch 5/5. 
Losses: total 0.02972, value 0.09908, policy 0.00010, entropy -0.00044, approx_kl 0.04147 clip_fraction 0.00236. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.734, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.604                    |
|    ep_rew_mean          | 0.734                    |
|    explained_variance   | 0.648                    |
|    len                  | 5.604 +/- 7.37 (22919)   |
|    len_d_1_pos          | 5.256 +/- 7.56 (8679)    |
|    len_d_2_pos          | 5.574 +/- 7.76 (810)     |
|    len_d_3_pos          | 5.312 +/- 7.63 (858)     |
|    len_d_4_pos          | 5.651 +/- 7.84 (533)     |
|    len_d_unknown_neg    | 5.875 +/- 7.15 (12039)   |
|    len_neg              | 5.875 +/- 7.15 (12039)   |
|    len_pos              | 5.303 +/- 7.60 (10880)   |
|    proven_d_1_pos       | 0.729 +/- 0.44 (8679)    |
|    proven_d_2_pos       | 0.707 +/- 0.45 (810)     |
|    proven_d_3_pos       | 0.730 +/- 0.44 (858)     |
|    proven_d_4_pos       | 0.705 +/- 0.46 (533)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (12039)   |
|    proven_neg           | 0.006 +/- 0.08 (12039)   |
|    proven_pos           | 0.726 +/- 0.45 (10880)   |
|    reward               | 0.734 +/- 0.68 (22919)   |
|    reward_d_1_pos       | 0.458 +/- 0.89 (8679)    |
|    reward_d_2_pos       | 0.415 +/- 0.91 (810)     |
|    reward_d_3_pos       | 0.459 +/- 0.89 (858)     |
|    reward_d_4_pos       | 0.411 +/- 0.91 (533)     |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (12039)   |
|    reward_neg           | 0.988 +/- 0.15 (12039)   |
|    reward_pos           | 0.452 +/- 0.89 (10880)   |
|    success_rate         | 0.348                    |
|    time/elapsed         | 71                       |
|    time/fps             | 2204                     |
|    total_timesteps      | 131072                   |
----------------------------------------------------

[Eval] Took 1.35 seconds

[Ranking] MRR: current=0.955, best=0.955 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.925                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.985                    |
|    MRR                  | 0.955                    |
|    len_d_-1_pos         | 12.917                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.352                    |
|    len_pos              | 8.570                    |
|    mrr_mean             | 0.955                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.007                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.007                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] New best eval model saved to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_04_16_16.pt (mrr_mean=0.9545)
[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24117.09
Epoch 1/5. 
Losses: total 0.08282, value 0.22657, policy 0.00081, entropy -0.00051, approx_kl 0.06908 clip_fraction 0.00247. 
Epoch 2/5. 
Losses: total 0.05642, value 0.17227, policy 0.00091, entropy -0.00058, approx_kl 0.12115 clip_fraction 0.00362. 
Epoch 3/5. 
Losses: total 0.03853, value 0.14406, policy 0.00081, entropy -0.00056, approx_kl 0.15169 clip_fraction 0.00389. 
Epoch 4/5. 
Losses: total 0.04627, value 0.12673, policy 0.00064, entropy -0.00051, approx_kl 0.14742 clip_fraction 0.00373. 
Epoch 5/5. 
Losses: total 0.03513, value 0.11465, policy 0.00057, entropy -0.00051, approx_kl 0.15823 clip_fraction 0.00393. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.640                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.516                    |
|    len                  | 5.640 +/- 7.40 (28544)   |
|    len_d_1_pos          | 5.344 +/- 7.63 (10785)   |
|    len_d_2_pos          | 5.491 +/- 7.71 (1030)    |
|    len_d_3_pos          | 5.362 +/- 7.65 (1076)    |
|    len_d_4_pos          | 5.454 +/- 7.73 (679)     |
|    len_d_unknown_neg    | 5.891 +/- 7.16 (14974)   |
|    len_neg              | 5.891 +/- 7.16 (14974)   |
|    len_pos              | 5.362 +/- 7.64 (13570)   |
|    proven_d_1_pos       | 0.724 +/- 0.45 (10785)   |
|    proven_d_2_pos       | 0.711 +/- 0.45 (1030)    |
|    proven_d_3_pos       | 0.725 +/- 0.45 (1076)    |
|    proven_d_4_pos       | 0.720 +/- 0.45 (679)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (14974)   |
|    proven_neg           | 0.006 +/- 0.08 (14974)   |
|    proven_pos           | 0.723 +/- 0.45 (13570)   |
|    reward               | 0.730 +/- 0.68 (28544)   |
|    reward_d_1_pos       | 0.448 +/- 0.89 (10785)   |
|    reward_d_2_pos       | 0.421 +/- 0.91 (1030)    |
|    reward_d_3_pos       | 0.450 +/- 0.89 (1076)    |
|    reward_d_4_pos       | 0.440 +/- 0.90 (679)     |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (14974)   |
|    reward_neg           | 0.988 +/- 0.15 (14974)   |
|    reward_pos           | 0.446 +/- 0.90 (13570)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 87                       |
|    time/fps             | 2011                     |
|    total_timesteps      | 163840                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24113.13
Epoch 1/5. 
Losses: total 0.09528, value 0.23925, policy 0.00117, entropy -0.00083, approx_kl 0.06380 clip_fraction 0.00327. 
Epoch 2/5. 
Losses: total 0.06092, value 0.18539, policy 0.00100, entropy -0.00078, approx_kl 0.07093 clip_fraction 0.00360. 
Epoch 3/5. 
Losses: total 0.05589, value 0.15609, policy 0.00090, entropy -0.00069, approx_kl 0.08519 clip_fraction 0.00365. 
Epoch 4/5. 
Losses: total 0.04387, value 0.13765, policy 0.00075, entropy -0.00069, approx_kl 0.08931 clip_fraction 0.00374. 
Epoch 5/5. 
Losses: total 0.03500, value 0.12455, policy 0.00065, entropy -0.00065, approx_kl 0.09836 clip_fraction 0.00377. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.733, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.594                    |
|    ep_rew_mean          | 0.733                    |
|    explained_variance   | 0.498                    |
|    len                  | 5.594 +/- 7.37 (34519)   |
|    len_d_1_pos          | 5.278 +/- 7.58 (13039)   |
|    len_d_2_pos          | 5.276 +/- 7.58 (1266)    |
|    len_d_3_pos          | 5.173 +/- 7.52 (1298)    |
|    len_d_4_pos          | 5.486 +/- 7.73 (805)     |
|    len_d_unknown_neg    | 5.878 +/- 7.15 (18111)   |
|    len_neg              | 5.878 +/- 7.15 (18111)   |
|    len_pos              | 5.280 +/- 7.58 (16408)   |
|    proven_d_1_pos       | 0.726 +/- 0.45 (13039)   |
|    proven_d_2_pos       | 0.722 +/- 0.45 (1266)    |
|    proven_d_3_pos       | 0.734 +/- 0.44 (1298)    |
|    proven_d_4_pos       | 0.713 +/- 0.45 (805)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (18111)   |
|    proven_neg           | 0.006 +/- 0.08 (18111)   |
|    proven_pos           | 0.725 +/- 0.45 (16408)   |
|    reward               | 0.733 +/- 0.68 (34519)   |
|    reward_d_1_pos       | 0.451 +/- 0.89 (13039)   |
|    reward_d_2_pos       | 0.444 +/- 0.90 (1266)    |
|    reward_d_3_pos       | 0.468 +/- 0.88 (1298)    |
|    reward_d_4_pos       | 0.426 +/- 0.90 (805)     |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (18111)   |
|    reward_neg           | 0.988 +/- 0.15 (18111)   |
|    reward_pos           | 0.451 +/- 0.89 (16408)   |
|    success_rate         | 0.348                    |
|    time/elapsed         | 102                      |
|    time/fps             | 2198                     |
|    total_timesteps      | 196608                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24105.86
Epoch 1/5. 
Losses: total 0.08731, value 0.23971, policy 0.00590, entropy -0.00067, approx_kl 0.02018 clip_fraction 0.00198. 
Epoch 2/5. 
Losses: total 0.05406, value 0.19216, policy 0.00323, entropy -0.00064, approx_kl 0.03404 clip_fraction 0.00249. 
Epoch 3/5. 
Losses: total 0.06985, value 0.16476, policy 0.00228, entropy -0.00058, approx_kl 0.04610 clip_fraction 0.00254. 
Epoch 4/5. 
Losses: total 0.04886, value 0.14631, policy 0.00182, entropy -0.00056, approx_kl 0.05685 clip_fraction 0.00272. 
Epoch 5/5. 
Losses: total 0.03821, value 0.13287, policy 0.00154, entropy -0.00054, approx_kl 0.06777 clip_fraction 0.00290. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.732, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.551                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.509                    |
|    len                  | 5.551 +/- 7.34 (40611)   |
|    len_d_1_pos          | 5.277 +/- 7.57 (15320)   |
|    len_d_2_pos          | 5.280 +/- 7.59 (1482)    |
|    len_d_3_pos          | 5.140 +/- 7.49 (1526)    |
|    len_d_4_pos          | 5.228 +/- 7.57 (978)     |
|    len_d_unknown_neg    | 5.810 +/- 7.11 (21305)   |
|    len_neg              | 5.810 +/- 7.11 (21305)   |
|    len_pos              | 5.264 +/- 7.57 (19306)   |
|    proven_d_1_pos       | 0.724 +/- 0.45 (15320)   |
|    proven_d_2_pos       | 0.721 +/- 0.45 (1482)    |
|    proven_d_3_pos       | 0.732 +/- 0.44 (1526)    |
|    proven_d_4_pos       | 0.726 +/- 0.45 (978)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (21305)   |
|    proven_neg           | 0.006 +/- 0.08 (21305)   |
|    proven_pos           | 0.724 +/- 0.45 (19306)   |
|    reward               | 0.732 +/- 0.68 (40611)   |
|    reward_d_1_pos       | 0.448 +/- 0.89 (15320)   |
|    reward_d_2_pos       | 0.443 +/- 0.90 (1482)    |
|    reward_d_3_pos       | 0.464 +/- 0.89 (1526)    |
|    reward_d_4_pos       | 0.452 +/- 0.89 (978)     |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (21305)   |
|    reward_neg           | 0.988 +/- 0.15 (21305)   |
|    reward_pos           | 0.449 +/- 0.89 (19306)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 117                      |
|    time/fps             | 2197                     |
|    total_timesteps      | 229376                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24121.43
Epoch 1/5. 
Losses: total 0.09054, value 0.24225, policy 0.00059, entropy -0.00054, approx_kl 0.03371 clip_fraction 0.00201. 
Epoch 2/5. 
Losses: total 0.06398, value 0.19464, policy 0.00063, entropy -0.00052, approx_kl 0.05795 clip_fraction 0.00261. 
Epoch 3/5. 
Losses: total 0.05002, value 0.16571, policy 0.00056, entropy -0.00053, approx_kl 0.05897 clip_fraction 0.00264. 
Epoch 4/5. 
Losses: total 0.04471, value 0.14677, policy 0.00050, entropy -0.00055, approx_kl 0.06502 clip_fraction 0.00281. 
Epoch 5/5. 
Losses: total 0.05138, value 0.13334, policy 0.00041, entropy -0.00055, approx_kl 0.09060 clip_fraction 0.00324. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.732, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.536                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.511                    |
|    len                  | 5.536 +/- 7.33 (46571)   |
|    len_d_1_pos          | 5.250 +/- 7.56 (17517)   |
|    len_d_2_pos          | 5.168 +/- 7.50 (1723)    |
|    len_d_3_pos          | 5.072 +/- 7.42 (1774)    |
|    len_d_4_pos          | 5.303 +/- 7.61 (1118)    |
|    len_d_unknown_neg    | 5.811 +/- 7.12 (24439)   |
|    len_neg              | 5.811 +/- 7.12 (24439)   |
|    len_pos              | 5.232 +/- 7.55 (22132)   |
|    proven_d_1_pos       | 0.725 +/- 0.45 (17517)   |
|    proven_d_2_pos       | 0.726 +/- 0.45 (1723)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (1774)    |
|    proven_d_4_pos       | 0.722 +/- 0.45 (1118)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (24439)   |
|    proven_neg           | 0.006 +/- 0.08 (24439)   |
|    proven_pos           | 0.726 +/- 0.45 (22132)   |
|    reward               | 0.732 +/- 0.68 (46571)   |
|    reward_d_1_pos       | 0.450 +/- 0.89 (17517)   |
|    reward_d_2_pos       | 0.452 +/- 0.89 (1723)    |
|    reward_d_3_pos       | 0.466 +/- 0.88 (1774)    |
|    reward_d_4_pos       | 0.444 +/- 0.90 (1118)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (24439)   |
|    reward_neg           | 0.987 +/- 0.16 (24439)   |
|    reward_pos           | 0.451 +/- 0.89 (22132)   |
|    success_rate         | 0.348                    |
|    time/elapsed         | 132                      |
|    time/fps             | 2196                     |
|    total_timesteps      | 262144                   |
----------------------------------------------------

[Eval] Took 1.34 seconds

[Ranking] MRR: current=0.940, best=0.955 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.965                    |
|    MRR                  | 0.940                    |
|    len_d_-1_pos         | 11.917                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 10.500                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 7.735                    |
|    len_pos              | 7.900                    |
|    mrr_mean             | 0.940                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.007                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.007                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24096.30
Epoch 1/5. 
Losses: total 0.11939, value 0.29014, policy 0.00058, entropy -0.00046, approx_kl 0.03767 clip_fraction 0.00217. 
Epoch 2/5. 
Losses: total 0.06731, value 0.23187, policy 0.00064, entropy -0.00050, approx_kl 0.05724 clip_fraction 0.00313. 
Epoch 3/5. 
Losses: total 0.06622, value 0.19533, policy 0.00072, entropy -0.00049, approx_kl 0.07898 clip_fraction 0.00354. 
Epoch 4/5. 
Losses: total 0.04941, value 0.17113, policy 0.00061, entropy -0.00048, approx_kl 0.07707 clip_fraction 0.00346. 
Epoch 5/5. 
Losses: total 0.04234, value 0.15373, policy 0.00058, entropy -0.00045, approx_kl 0.08280 clip_fraction 0.00350. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.732, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.502                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.414                    |
|    len                  | 5.502 +/- 7.31 (52732)   |
|    len_d_1_pos          | 5.256 +/- 7.56 (19845)   |
|    len_d_2_pos          | 5.109 +/- 7.46 (1960)    |
|    len_d_3_pos          | 5.025 +/- 7.40 (2001)    |
|    len_d_4_pos          | 5.179 +/- 7.53 (1248)    |
|    len_d_unknown_neg    | 5.756 +/- 7.09 (27678)   |
|    len_neg              | 5.756 +/- 7.09 (27678)   |
|    len_pos              | 5.222 +/- 7.54 (25054)   |
|    proven_d_1_pos       | 0.724 +/- 0.45 (19845)   |
|    proven_d_2_pos       | 0.729 +/- 0.44 (1960)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (2001)    |
|    proven_d_4_pos       | 0.727 +/- 0.45 (1248)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (27678)   |
|    proven_neg           | 0.006 +/- 0.08 (27678)   |
|    proven_pos           | 0.725 +/- 0.45 (25054)   |
|    reward               | 0.732 +/- 0.68 (52732)   |
|    reward_d_1_pos       | 0.447 +/- 0.89 (19845)   |
|    reward_d_2_pos       | 0.458 +/- 0.89 (1960)    |
|    reward_d_3_pos       | 0.469 +/- 0.88 (2001)    |
|    reward_d_4_pos       | 0.454 +/- 0.89 (1248)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (27678)   |
|    reward_neg           | 0.987 +/- 0.16 (27678)   |
|    reward_pos           | 0.450 +/- 0.89 (25054)   |
|    success_rate         | 0.348                    |
|    time/elapsed         | 148                      |
|    time/fps             | 2012                     |
|    total_timesteps      | 294912                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24068.01
Epoch 1/5. 
Losses: total 0.11692, value 0.27436, policy 0.00038, entropy -0.00073, approx_kl 0.00564 clip_fraction 0.00150. 
Epoch 2/5. 
Losses: total 0.07143, value 0.22623, policy 0.00032, entropy -0.00073, approx_kl 0.01584 clip_fraction 0.00203. 
Epoch 3/5. 
Losses: total 0.06622, value 0.19402, policy 0.00018, entropy -0.00074, approx_kl 0.03229 clip_fraction 0.00260. 
Epoch 4/5. 
Losses: total 0.05464, value 0.17152, policy 0.00017, entropy -0.00068, approx_kl 0.05043 clip_fraction 0.00294. 
Epoch 5/5. 
Losses: total 0.04376, value 0.15517, policy 0.00016, entropy -0.00067, approx_kl 0.05611 clip_fraction 0.00309. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.508                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.468                    |
|    len                  | 5.508 +/- 7.32 (58529)   |
|    len_d_1_pos          | 5.270 +/- 7.57 (22033)   |
|    len_d_2_pos          | 5.150 +/- 7.50 (2174)    |
|    len_d_3_pos          | 5.091 +/- 7.45 (2222)    |
|    len_d_4_pos          | 5.123 +/- 7.49 (1395)    |
|    len_d_unknown_neg    | 5.751 +/- 7.09 (30705)   |
|    len_neg              | 5.751 +/- 7.09 (30705)   |
|    len_pos              | 5.239 +/- 7.55 (27824)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (22033)   |
|    proven_d_2_pos       | 0.726 +/- 0.45 (2174)    |
|    proven_d_3_pos       | 0.730 +/- 0.44 (2222)    |
|    proven_d_4_pos       | 0.730 +/- 0.44 (1395)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (30705)   |
|    proven_neg           | 0.006 +/- 0.08 (30705)   |
|    proven_pos           | 0.723 +/- 0.45 (27824)   |
|    reward               | 0.730 +/- 0.68 (58529)   |
|    reward_d_1_pos       | 0.444 +/- 0.90 (22033)   |
|    reward_d_2_pos       | 0.452 +/- 0.89 (2174)    |
|    reward_d_3_pos       | 0.461 +/- 0.89 (2222)    |
|    reward_d_4_pos       | 0.461 +/- 0.89 (1395)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (30705)   |
|    reward_neg           | 0.987 +/- 0.16 (30705)   |
|    reward_pos           | 0.447 +/- 0.89 (27824)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 163                      |
|    time/fps             | 2193                     |
|    total_timesteps      | 327680                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24180.06
Epoch 1/5. 
Losses: total 0.11269, value 0.28881, policy 0.00035, entropy -0.00073, approx_kl 0.01297 clip_fraction 0.00201. 
Epoch 2/5. 
Losses: total 0.08388, value 0.24091, policy 0.00020, entropy -0.00060, approx_kl 0.01716 clip_fraction 0.00195. 
Epoch 3/5. 
Losses: total 0.06926, value 0.20839, policy 0.00020, entropy -0.00062, approx_kl 0.02337 clip_fraction 0.00231. 
Epoch 4/5. 
Losses: total 0.04351, value 0.18518, policy 0.00014, entropy -0.00056, approx_kl 0.02754 clip_fraction 0.00239. 
Epoch 5/5. 
Losses: total 0.04393, value 0.16782, policy 0.00012, entropy -0.00052, approx_kl 0.03277 clip_fraction 0.00251. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.514                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.433                    |
|    len                  | 5.514 +/- 7.32 (64333)   |
|    len_d_1_pos          | 5.271 +/- 7.57 (24224)   |
|    len_d_2_pos          | 5.142 +/- 7.49 (2389)    |
|    len_d_3_pos          | 5.118 +/- 7.48 (2444)    |
|    len_d_4_pos          | 5.269 +/- 7.59 (1519)    |
|    len_d_unknown_neg    | 5.755 +/- 7.09 (33757)   |
|    len_neg              | 5.755 +/- 7.09 (33757)   |
|    len_pos              | 5.249 +/- 7.56 (30576)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (24224)   |
|    proven_d_2_pos       | 0.725 +/- 0.45 (2389)    |
|    proven_d_3_pos       | 0.730 +/- 0.44 (2444)    |
|    proven_d_4_pos       | 0.724 +/- 0.45 (1519)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (33757)   |
|    proven_neg           | 0.006 +/- 0.08 (33757)   |
|    proven_pos           | 0.723 +/- 0.45 (30576)   |
|    reward               | 0.730 +/- 0.68 (64333)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (24224)   |
|    reward_d_2_pos       | 0.449 +/- 0.89 (2389)    |
|    reward_d_3_pos       | 0.459 +/- 0.89 (2444)    |
|    reward_d_4_pos       | 0.447 +/- 0.89 (1519)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (33757)   |
|    reward_neg           | 0.987 +/- 0.16 (33757)   |
|    reward_pos           | 0.446 +/- 0.89 (30576)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 178                      |
|    time/fps             | 2193                     |
|    total_timesteps      | 360448                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24008.98
Epoch 1/5. 
Losses: total 0.11852, value 0.28814, policy 0.00017, entropy -0.00057, approx_kl 0.00384 clip_fraction 0.00122. 
Epoch 2/5. 
Losses: total 0.08093, value 0.24645, policy 0.00003, entropy -0.00055, approx_kl 0.01058 clip_fraction 0.00153. 
Epoch 3/5. 
Losses: total 0.08248, value 0.21657, policy -0.00002, entropy -0.00054, approx_kl 0.01546 clip_fraction 0.00176. 
Epoch 4/5. 
Losses: total 0.06363, value 0.19457, policy -0.00008, entropy -0.00051, approx_kl 0.02235 clip_fraction 0.00195. 
Epoch 5/5. 
Losses: total 0.04687, value 0.17810, policy -0.00012, entropy -0.00049, approx_kl 0.02859 clip_fraction 0.00214. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.509                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.439                    |
|    len                  | 5.509 +/- 7.32 (70231)   |
|    len_d_1_pos          | 5.260 +/- 7.56 (26455)   |
|    len_d_2_pos          | 5.201 +/- 7.53 (2573)    |
|    len_d_3_pos          | 5.032 +/- 7.41 (2689)    |
|    len_d_4_pos          | 5.177 +/- 7.52 (1646)    |
|    len_d_unknown_neg    | 5.759 +/- 7.09 (36868)   |
|    len_neg              | 5.759 +/- 7.09 (36868)   |
|    len_pos              | 5.233 +/- 7.55 (33363)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (26455)   |
|    proven_d_2_pos       | 0.723 +/- 0.45 (2573)    |
|    proven_d_3_pos       | 0.734 +/- 0.44 (2689)    |
|    proven_d_4_pos       | 0.728 +/- 0.44 (1646)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (36868)   |
|    proven_neg           | 0.006 +/- 0.08 (36868)   |
|    proven_pos           | 0.724 +/- 0.45 (33363)   |
|    reward               | 0.731 +/- 0.68 (70231)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (26455)   |
|    reward_d_2_pos       | 0.446 +/- 0.90 (2573)    |
|    reward_d_3_pos       | 0.468 +/- 0.88 (2689)    |
|    reward_d_4_pos       | 0.457 +/- 0.89 (1646)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (36868)   |
|    reward_neg           | 0.988 +/- 0.16 (36868)   |
|    reward_pos           | 0.448 +/- 0.89 (33363)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 193                      |
|    time/fps             | 2190                     |
|    total_timesteps      | 393216                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.950, best=0.955 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.920                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.975                    |
|    MRR                  | 0.950                    |
|    len_d_-1_pos         | 12.958                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 11.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 7.969                    |
|    len_pos              | 8.410                    |
|    mrr_mean             | 0.950                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24115.09
Epoch 1/5. 
Losses: total 0.13867, value 0.29821, policy 0.00007, entropy -0.00080, approx_kl 0.00154 clip_fraction 0.00095. 
Epoch 2/5. 
Losses: total 0.09419, value 0.26011, policy 0.00003, entropy -0.00073, approx_kl 0.00748 clip_fraction 0.00133. 
Epoch 3/5. 
Losses: total 0.08281, value 0.23236, policy 0.00003, entropy -0.00065, approx_kl 0.01296 clip_fraction 0.00161. 
Epoch 4/5. 
Losses: total 0.07239, value 0.21097, policy -0.00003, entropy -0.00061, approx_kl 0.01505 clip_fraction 0.00175. 
Epoch 5/5. 
Losses: total 0.06182, value 0.19407, policy -0.00007, entropy -0.00058, approx_kl 0.01719 clip_fraction 0.00186. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.520                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.445                    |
|    len                  | 5.520 +/- 7.32 (75976)   |
|    len_d_1_pos          | 5.282 +/- 7.58 (28619)   |
|    len_d_2_pos          | 5.272 +/- 7.56 (2773)    |
|    len_d_3_pos          | 4.962 +/- 7.36 (2945)    |
|    len_d_4_pos          | 5.199 +/- 7.53 (1767)    |
|    len_d_unknown_neg    | 5.764 +/- 7.10 (39872)   |
|    len_neg              | 5.764 +/- 7.10 (39872)   |
|    len_pos              | 5.251 +/- 7.56 (36104)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (28619)   |
|    proven_d_2_pos       | 0.718 +/- 0.45 (2773)    |
|    proven_d_3_pos       | 0.739 +/- 0.44 (2945)    |
|    proven_d_4_pos       | 0.729 +/- 0.44 (1767)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (39872)   |
|    proven_neg           | 0.006 +/- 0.08 (39872)   |
|    proven_pos           | 0.723 +/- 0.45 (36104)   |
|    reward               | 0.730 +/- 0.68 (75976)   |
|    reward_d_1_pos       | 0.443 +/- 0.90 (28619)   |
|    reward_d_2_pos       | 0.437 +/- 0.90 (2773)    |
|    reward_d_3_pos       | 0.477 +/- 0.88 (2945)    |
|    reward_d_4_pos       | 0.459 +/- 0.89 (1767)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (39872)   |
|    reward_neg           | 0.988 +/- 0.16 (39872)   |
|    reward_pos           | 0.446 +/- 0.90 (36104)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 209                      |
|    time/fps             | 2012                     |
|    total_timesteps      | 425984                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24069.30
Epoch 1/5. 
Losses: total 0.13652, value 0.30497, policy 0.00047, entropy -0.00079, approx_kl 0.00557 clip_fraction 0.00116. 
Epoch 2/5. 
Losses: total 0.09941, value 0.27327, policy 0.00024, entropy -0.00066, approx_kl 0.00963 clip_fraction 0.00136. 
Epoch 3/5. 
Losses: total 0.10148, value 0.24887, policy 0.00015, entropy -0.00064, approx_kl 0.01183 clip_fraction 0.00146. 
Epoch 4/5. 
Losses: total 0.07722, value 0.22856, policy 0.00009, entropy -0.00062, approx_kl 0.01308 clip_fraction 0.00151. 
Epoch 5/5. 
Losses: total 0.08028, value 0.21161, policy 0.00004, entropy -0.00059, approx_kl 0.01463 clip_fraction 0.00154. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.518                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.440                    |
|    len                  | 5.518 +/- 7.32 (81873)   |
|    len_d_1_pos          | 5.256 +/- 7.56 (30907)   |
|    len_d_2_pos          | 5.320 +/- 7.60 (2977)    |
|    len_d_3_pos          | 5.025 +/- 7.41 (3131)    |
|    len_d_4_pos          | 5.246 +/- 7.58 (1890)    |
|    len_d_unknown_neg    | 5.768 +/- 7.10 (42968)   |
|    len_neg              | 5.768 +/- 7.10 (42968)   |
|    len_pos              | 5.242 +/- 7.55 (38905)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (30907)   |
|    proven_d_2_pos       | 0.718 +/- 0.45 (2977)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (3131)    |
|    proven_d_4_pos       | 0.730 +/- 0.44 (1890)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (42968)   |
|    proven_neg           | 0.006 +/- 0.08 (42968)   |
|    proven_pos           | 0.723 +/- 0.45 (38905)   |
|    reward               | 0.731 +/- 0.68 (81873)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (30907)   |
|    reward_d_2_pos       | 0.435 +/- 0.90 (2977)    |
|    reward_d_3_pos       | 0.470 +/- 0.88 (3131)    |
|    reward_d_4_pos       | 0.459 +/- 0.89 (1890)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (42968)   |
|    reward_neg           | 0.988 +/- 0.16 (42968)   |
|    reward_pos           | 0.447 +/- 0.89 (38905)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 224                      |
|    time/fps             | 2188                     |
|    total_timesteps      | 458752                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24147.11
Epoch 1/5. 
Losses: total 0.14191, value 0.29575, policy 0.00017, entropy -0.00066, approx_kl 0.00298 clip_fraction 0.00085. 
Epoch 2/5. 
Losses: total 0.12541, value 0.27417, policy 0.00003, entropy -0.00057, approx_kl 0.00597 clip_fraction 0.00107. 
Epoch 3/5. 
Losses: total 0.11847, value 0.25642, policy -0.00006, entropy -0.00051, approx_kl 0.00745 clip_fraction 0.00116. 
Epoch 4/5. 
Losses: total 0.09380, value 0.24141, policy -0.00009, entropy -0.00050, approx_kl 0.00976 clip_fraction 0.00126. 
Epoch 5/5. 
Losses: total 0.09773, value 0.22855, policy -0.00014, entropy -0.00050, approx_kl 0.01173 clip_fraction 0.00137. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.510                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.481                    |
|    len                  | 5.510 +/- 7.32 (87868)   |
|    len_d_1_pos          | 5.238 +/- 7.55 (33187)   |
|    len_d_2_pos          | 5.337 +/- 7.62 (3194)    |
|    len_d_3_pos          | 5.016 +/- 7.40 (3355)    |
|    len_d_4_pos          | 5.190 +/- 7.55 (2036)    |
|    len_d_unknown_neg    | 5.767 +/- 7.10 (46096)   |
|    len_neg              | 5.767 +/- 7.10 (46096)   |
|    len_pos              | 5.226 +/- 7.54 (41772)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (33187)   |
|    proven_d_2_pos       | 0.718 +/- 0.45 (3194)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (3355)    |
|    proven_d_4_pos       | 0.731 +/- 0.44 (2036)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (46096)   |
|    proven_neg           | 0.006 +/- 0.08 (46096)   |
|    proven_pos           | 0.724 +/- 0.45 (41772)   |
|    reward               | 0.731 +/- 0.68 (87868)   |
|    reward_d_1_pos       | 0.446 +/- 0.90 (33187)   |
|    reward_d_2_pos       | 0.436 +/- 0.90 (3194)    |
|    reward_d_3_pos       | 0.469 +/- 0.88 (3355)    |
|    reward_d_4_pos       | 0.462 +/- 0.89 (2036)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (46096)   |
|    reward_neg           | 0.988 +/- 0.16 (46096)   |
|    reward_pos           | 0.448 +/- 0.89 (41772)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 239                      |
|    time/fps             | 2186                     |
|    total_timesteps      | 491520                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt
[PPO] Rollout collected in 1.36s. FPS: 24052.22
Epoch 1/5. 
Losses: total 0.11924, value 0.31618, policy 0.00024, entropy -0.00070, approx_kl 0.00052 clip_fraction 0.00067. 
Epoch 2/5. 
Losses: total 0.12922, value 0.30758, policy 0.00007, entropy -0.00068, approx_kl 0.00053 clip_fraction 0.00075. 
Epoch 3/5. 
Losses: total 0.13095, value 0.29977, policy -0.00001, entropy -0.00067, approx_kl 0.00064 clip_fraction 0.00083. 
Epoch 4/5. 
Losses: total 0.12424, value 0.29273, policy -0.00007, entropy -0.00066, approx_kl 0.00070 clip_fraction 0.00089. 
Epoch 5/5. 
Losses: total 0.11012, value 0.28633, policy -0.00010, entropy -0.00065, approx_kl 0.00081 clip_fraction 0.00095. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.747 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.509                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.466                    |
|    len                  | 5.509 +/- 7.32 (93735)   |
|    len_d_1_pos          | 5.254 +/- 7.56 (35364)   |
|    len_d_2_pos          | 5.302 +/- 7.60 (3425)    |
|    len_d_3_pos          | 5.030 +/- 7.41 (3585)    |
|    len_d_4_pos          | 5.114 +/- 7.49 (2168)    |
|    len_d_unknown_neg    | 5.759 +/- 7.10 (49193)   |
|    len_neg              | 5.759 +/- 7.10 (49193)   |
|    len_pos              | 5.233 +/- 7.55 (44542)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (35364)   |
|    proven_d_2_pos       | 0.721 +/- 0.45 (3425)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (3585)    |
|    proven_d_4_pos       | 0.734 +/- 0.44 (2168)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (49193)   |
|    proven_neg           | 0.006 +/- 0.08 (49193)   |
|    proven_pos           | 0.724 +/- 0.45 (44542)   |
|    reward               | 0.731 +/- 0.68 (93735)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (35364)   |
|    reward_d_2_pos       | 0.442 +/- 0.90 (3425)    |
|    reward_d_3_pos       | 0.467 +/- 0.88 (3585)    |
|    reward_d_4_pos       | 0.469 +/- 0.88 (2168)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (49193)   |
|    reward_neg           | 0.987 +/- 0.16 (49193)   |
|    reward_pos           | 0.448 +/- 0.89 (44542)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 254                      |
|    time/fps             | 2184                     |
|    total_timesteps      | 524288                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.945, best=0.955 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.915                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.970                    |
|    MRR                  | 0.945                    |
|    len_d_-1_pos         | 12.604                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 11.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 7.981                    |
|    len_pos              | 8.240                    |
|    mrr_mean             | 0.945                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.010                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.010                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_04_16_16.pt

[Checkpoint] Restoring best model at end of training...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_04_16_16.pt
Loaded best model info: {'metric': 'mrr_mean', 'best_value': 0.9545021653175354, 'timesteps': 4, 'explained_variance': 0.6482330560684204}

[2.5/3] Training neural bridge on validation data...
[NeuralBridge] Training neural bridge on 100 queries...
Traceback (most recent call last):
  File "/home/castellanoontiv/Batched_Env/kge_experiments/runner_kge.py", line 380, in <module>
    run_wrapper(cfg)
    ~~~~~~~~~~~^^^^^
  File "/home/castellanoontiv/Batched_Env/kge_experiments/runner_kge.py", line 350, in run_wrapper
    results = run_experiment(config)
  File "/home/castellanoontiv/Batched_Env/kge_experiments/train.py", line 391, in run_experiment
    ppo.train_neural_bridge(
    ~~~~~~~~~~~~~~~~~~~~~~~^
        queries=valid_queries_tensor,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<4 lines>...
        lr=getattr(config, 'neural_bridge_lr', 0.01),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/castellanoontiv/Batched_Env/kge_experiments/ppo.py", line 1375, in train_neural_bridge
    result = trainer.train(queries, sampler, n_corruptions, corruption_modes, self)
TypeError: NeuralBridgeTrainer.train() takes 1 positional argument but 6 were given


==============================================
Starting KGE Integration Experiments
Dataset: wn18rr
Timesteps: 500000
Eval: 100 queries, 10 corruptions
Test: 500 queries, 100 corruptions
Started at: Thu Jan  8 09:34:01 AM CET 2026
==============================================

[4/10] Running: Neural Bridge (Linear)
==============================================
Grid search: 1 params, 1 experiments.

============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: wn18rr-250-128-torchrl
======================================================================
Training: wn18rr
Envs: 128, Steps: 256, Timesteps: 500000
Seed: 0
======================================================================

[1/3] Creating components...
[UnificationEngine] Capping max_fact_pairs from 34796 to 1000
[EnvOptimal] Compiled with mode=reduce-overhead, fullgraph=True

[2/3] Running training...
KGE Engine initialized with backend: pytorch (signature: torch_wn18rr_RotatE_1024_20260107_125531_s42)
[NeuralBridge] Created LinearBridge with init_alpha=0.5
[PPO] Compiled ranking_step (double-buffered) with mode=default

[Checkpoint] Loading existing model at start of training (load_model=True)...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_04_16_16.pt

============================================================
Initial evaluation (untrained model)
============================================================
Building model and loading weights...
Weights loaded successfully.
[Eval] Took 8.29 seconds

[Ranking] MRR: current=0.942, best=0.942 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.980                    |
|    MRR                  | 0.942                    |
|    len_d_-1_pos         | 12.917                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.203                    |
|    len_pos              | 8.570                    |
|    mrr_mean             | 0.942                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

============================================================

[PPO] Rollout collected in 3.37s. FPS: 9733.86
Epoch 1/5. 
Losses: total 0.06102, value 0.13394, policy 0.00063, entropy -0.00054, approx_kl 0.03408 clip_fraction 0.00201. 
Epoch 2/5. 
Losses: total 0.03476, value 0.10948, policy 0.00064, entropy -0.00052, approx_kl 0.04979 clip_fraction 0.00232. 
Epoch 3/5. 
Losses: total 0.03470, value 0.09692, policy 0.00058, entropy -0.00050, approx_kl 0.05279 clip_fraction 0.00244. 
Epoch 4/5. 
Losses: total 0.02561, value 0.08880, policy 0.00058, entropy -0.00049, approx_kl 0.06215 clip_fraction 0.00258. 
Epoch 5/5. 
Losses: total 0.02691, value 0.08305, policy 0.00058, entropy -0.00044, approx_kl 0.07583 clip_fraction 0.00273. 
[PPO] Training completed in 14.39s
[Metrics] Reward (train): current=0.748, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.419                    |
|    ep_rew_mean          | 0.748                    |
|    explained_variance   | 0.732                    |
|    len                  | 5.419 +/- 7.24 (5815)    |
|    len_d_1_pos          | 4.913 +/- 7.31 (2222)    |
|    len_d_2_pos          | 5.342 +/- 7.47 (202)     |
|    len_d_3_pos          | 5.257 +/- 7.57 (218)     |
|    len_d_4_pos          | 4.370 +/- 6.76 (146)     |
|    len_d_unknown_neg    | 5.857 +/- 7.13 (3027)    |
|    len_neg              | 5.857 +/- 7.13 (3027)    |
|    len_pos              | 4.943 +/- 7.32 (2788)    |
|    proven_d_1_pos       | 0.748 +/- 0.43 (2222)    |
|    proven_d_2_pos       | 0.708 +/- 0.45 (202)     |
|    proven_d_3_pos       | 0.729 +/- 0.44 (218)     |
|    proven_d_4_pos       | 0.753 +/- 0.43 (146)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (3027)    |
|    proven_neg           | 0.006 +/- 0.08 (3027)    |
|    proven_pos           | 0.744 +/- 0.44 (2788)    |
|    reward               | 0.748 +/- 0.66 (5815)    |
|    reward_d_1_pos       | 0.496 +/- 0.87 (2222)    |
|    reward_d_2_pos       | 0.416 +/- 0.91 (202)     |
|    reward_d_3_pos       | 0.459 +/- 0.89 (218)     |
|    reward_d_4_pos       | 0.507 +/- 0.86 (146)     |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (3027)    |
|    reward_neg           | 0.988 +/- 0.15 (3027)    |
|    reward_pos           | 0.488 +/- 0.87 (2788)    |
|    success_rate         | 0.360                    |
|    time/elapsed         | 26                       |
|    time/fps             | 1223                     |
|    total_timesteps      | 32768                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.35s. FPS: 24184.99
Epoch 1/5. 
Losses: total 0.05555, value 0.15300, policy 0.00028, entropy -0.00061, approx_kl 0.04024 clip_fraction 0.00201. 
Epoch 2/5. 
Losses: total 0.04629, value 0.12261, policy 0.00035, entropy -0.00063, approx_kl 0.10423 clip_fraction 0.00317. 
Epoch 3/5. 
Losses: total 0.03413, value 0.10670, policy 0.00022, entropy -0.00060, approx_kl 0.09583 clip_fraction 0.00330. 
Epoch 4/5. 
Losses: total 0.03424, value 0.09626, policy 0.00015, entropy -0.00059, approx_kl 0.10920 clip_fraction 0.00343. 
Epoch 5/5. 
Losses: total 0.02553, value 0.08867, policy 0.00021, entropy -0.00057, approx_kl 0.14391 clip_fraction 0.00390. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.735, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.630                    |
|    ep_rew_mean          | 0.735                    |
|    explained_variance   | 0.690                    |
|    len                  | 5.630 +/- 7.36 (11353)   |
|    len_d_1_pos          | 5.259 +/- 7.56 (4288)    |
|    len_d_2_pos          | 5.139 +/- 7.41 (416)     |
|    len_d_3_pos          | 5.585 +/- 7.74 (412)     |
|    len_d_4_pos          | 4.888 +/- 7.21 (286)     |
|    len_d_unknown_neg    | 5.970 +/- 7.18 (5951)    |
|    len_neg              | 5.970 +/- 7.18 (5951)    |
|    len_pos              | 5.255 +/- 7.55 (5402)    |
|    proven_d_1_pos       | 0.731 +/- 0.44 (4288)    |
|    proven_d_2_pos       | 0.724 +/- 0.45 (416)     |
|    proven_d_3_pos       | 0.711 +/- 0.45 (412)     |
|    proven_d_4_pos       | 0.741 +/- 0.44 (286)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (5951)    |
|    proven_neg           | 0.007 +/- 0.08 (5951)    |
|    proven_pos           | 0.729 +/- 0.44 (5402)    |
|    reward               | 0.735 +/- 0.68 (11353)   |
|    reward_d_1_pos       | 0.461 +/- 0.89 (4288)    |
|    reward_d_2_pos       | 0.447 +/- 0.89 (416)     |
|    reward_d_3_pos       | 0.422 +/- 0.91 (412)     |
|    reward_d_4_pos       | 0.483 +/- 0.88 (286)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (5951)    |
|    reward_neg           | 0.987 +/- 0.16 (5951)    |
|    reward_pos           | 0.458 +/- 0.89 (5402)    |
|    success_rate         | 0.350                    |
|    time/elapsed         | 41                       |
|    time/fps             | 2207                     |
|    total_timesteps      | 65536                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.36s. FPS: 24106.53
Epoch 1/5. 
Losses: total 0.05361, value 0.14883, policy 0.00042, entropy -0.00039, approx_kl 0.01961 clip_fraction 0.00168. 
Epoch 2/5. 
Losses: total 0.03940, value 0.11590, policy 0.00112, entropy -0.00040, approx_kl 0.02591 clip_fraction 0.00179. 
Epoch 3/5. 
Losses: total 0.03161, value 0.09947, policy 0.00133, entropy -0.00038, approx_kl 0.03787 clip_fraction 0.00199. 
Epoch 4/5. 
Losses: total 0.03669, value 0.08945, policy 0.00153, entropy -0.00038, approx_kl 0.05396 clip_fraction 0.00227. 
Epoch 5/5. 
Losses: total 0.02659, value 0.08211, policy 0.00156, entropy -0.00038, approx_kl 0.07034 clip_fraction 0.00247. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.732, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.663                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.687                    |
|    len                  | 5.663 +/- 7.39 (16974)   |
|    len_d_1_pos          | 5.315 +/- 7.61 (6386)    |
|    len_d_2_pos          | 5.391 +/- 7.60 (622)     |
|    len_d_3_pos          | 5.470 +/- 7.71 (615)     |
|    len_d_4_pos          | 5.388 +/- 7.58 (415)     |
|    len_d_unknown_neg    | 5.956 +/- 7.18 (8936)    |
|    len_neg              | 5.956 +/- 7.18 (8936)    |
|    len_pos              | 5.337 +/- 7.61 (8038)    |
|    proven_d_1_pos       | 0.727 +/- 0.45 (6386)    |
|    proven_d_2_pos       | 0.722 +/- 0.45 (622)     |
|    proven_d_3_pos       | 0.720 +/- 0.45 (615)     |
|    proven_d_4_pos       | 0.718 +/- 0.45 (415)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (8936)    |
|    proven_neg           | 0.007 +/- 0.08 (8936)    |
|    proven_pos           | 0.726 +/- 0.45 (8038)    |
|    reward               | 0.732 +/- 0.68 (16974)   |
|    reward_d_1_pos       | 0.454 +/- 0.89 (6386)    |
|    reward_d_2_pos       | 0.444 +/- 0.90 (622)     |
|    reward_d_3_pos       | 0.441 +/- 0.90 (615)     |
|    reward_d_4_pos       | 0.436 +/- 0.90 (415)     |
|    reward_d_unknown_neg | 0.985 +/- 0.17 (8936)    |
|    reward_neg           | 0.985 +/- 0.17 (8936)    |
|    reward_pos           | 0.451 +/- 0.89 (8038)    |
|    success_rate         | 0.347                    |
|    time/elapsed         | 56                       |
|    time/fps             | 2200                     |
|    total_timesteps      | 98304                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.37s. FPS: 23983.21
Epoch 1/5. 
Losses: total 0.05067, value 0.14595, policy 0.00015, entropy -0.00033, approx_kl 0.00566 clip_fraction 0.00089. 
Epoch 2/5. 
Losses: total 0.03979, value 0.11552, policy 0.00040, entropy -0.00025, approx_kl 0.03741 clip_fraction 0.00151. 
Epoch 3/5. 
Losses: total 0.03717, value 0.10054, policy 0.00046, entropy -0.00024, approx_kl 0.05258 clip_fraction 0.00178. 
Epoch 4/5. 
Losses: total 0.03147, value 0.09056, policy 0.00046, entropy -0.00027, approx_kl 0.05438 clip_fraction 0.00190. 
Epoch 5/5. 
Losses: total 0.02900, value 0.08356, policy 0.00044, entropy -0.00027, approx_kl 0.06164 clip_fraction 0.00201. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.732, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.646                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.695                    |
|    len                  | 5.646 +/- 7.38 (22747)   |
|    len_d_1_pos          | 5.314 +/- 7.60 (8552)    |
|    len_d_2_pos          | 5.454 +/- 7.66 (823)     |
|    len_d_3_pos          | 5.401 +/- 7.68 (845)     |
|    len_d_4_pos          | 5.572 +/- 7.71 (554)     |
|    len_d_unknown_neg    | 5.917 +/- 7.16 (11973)   |
|    len_neg              | 5.917 +/- 7.16 (11973)   |
|    len_pos              | 5.345 +/- 7.61 (10774)   |
|    proven_d_1_pos       | 0.725 +/- 0.45 (8552)    |
|    proven_d_2_pos       | 0.721 +/- 0.45 (823)     |
|    proven_d_3_pos       | 0.724 +/- 0.45 (845)     |
|    proven_d_4_pos       | 0.706 +/- 0.46 (554)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (11973)   |
|    proven_neg           | 0.006 +/- 0.08 (11973)   |
|    proven_pos           | 0.724 +/- 0.45 (10774)   |
|    reward               | 0.732 +/- 0.68 (22747)   |
|    reward_d_1_pos       | 0.451 +/- 0.89 (8552)    |
|    reward_d_2_pos       | 0.441 +/- 0.90 (823)     |
|    reward_d_3_pos       | 0.449 +/- 0.89 (845)     |
|    reward_d_4_pos       | 0.412 +/- 0.91 (554)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (11973)   |
|    reward_neg           | 0.987 +/- 0.16 (11973)   |
|    reward_pos           | 0.448 +/- 0.89 (10774)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 71                       |
|    time/fps             | 2197                     |
|    total_timesteps      | 131072                   |
----------------------------------------------------

[Eval] Took 1.32 seconds

[Ranking] MRR: current=0.955, best=0.955 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.925                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.985                    |
|    MRR                  | 0.955                    |
|    len_d_-1_pos         | 12.646                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.289                    |
|    len_pos              | 8.440                    |
|    mrr_mean             | 0.955                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.007                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.007                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] New best eval model saved to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_09_34_05.pt (mrr_mean=0.9545)
[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.36s. FPS: 24068.71
Epoch 1/5. 
Losses: total 0.08150, value 0.23818, policy 0.00034, entropy -0.00054, approx_kl 0.03435 clip_fraction 0.00214. 
Epoch 2/5. 
Losses: total 0.06197, value 0.18388, policy 0.00035, entropy -0.00051, approx_kl 0.04490 clip_fraction 0.00215. 
Epoch 3/5. 
Losses: total 0.03945, value 0.15444, policy 0.00023, entropy -0.00046, approx_kl 0.05010 clip_fraction 0.00209. 
Epoch 4/5. 
Losses: total 0.04315, value 0.13563, policy 0.00015, entropy -0.00045, approx_kl 0.05760 clip_fraction 0.00224. 
Epoch 5/5. 
Losses: total 0.03500, value 0.12244, policy 0.00011, entropy -0.00045, approx_kl 0.06312 clip_fraction 0.00231. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.729, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.675                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.499                    |
|    len                  | 5.675 +/- 7.41 (28358)   |
|    len_d_1_pos          | 5.380 +/- 7.64 (10645)   |
|    len_d_2_pos          | 5.357 +/- 7.61 (1048)    |
|    len_d_3_pos          | 5.451 +/- 7.68 (1057)    |
|    len_d_4_pos          | 5.517 +/- 7.72 (686)     |
|    len_d_unknown_neg    | 5.932 +/- 7.17 (14922)   |
|    len_neg              | 5.932 +/- 7.17 (14922)   |
|    len_pos              | 5.391 +/- 7.64 (13436)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (10645)   |
|    proven_d_2_pos       | 0.725 +/- 0.45 (1048)    |
|    proven_d_3_pos       | 0.720 +/- 0.45 (1057)    |
|    proven_d_4_pos       | 0.714 +/- 0.45 (686)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (14922)   |
|    proven_neg           | 0.006 +/- 0.08 (14922)   |
|    proven_pos           | 0.721 +/- 0.45 (13436)   |
|    reward               | 0.729 +/- 0.68 (28358)   |
|    reward_d_1_pos       | 0.442 +/- 0.90 (10645)   |
|    reward_d_2_pos       | 0.450 +/- 0.89 (1048)    |
|    reward_d_3_pos       | 0.440 +/- 0.90 (1057)    |
|    reward_d_4_pos       | 0.429 +/- 0.90 (686)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (14922)   |
|    reward_neg           | 0.987 +/- 0.16 (14922)   |
|    reward_pos           | 0.442 +/- 0.90 (13436)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 87                       |
|    time/fps             | 2014                     |
|    total_timesteps      | 163840                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.36s. FPS: 24074.03
Epoch 1/5. 
Losses: total 0.08645, value 0.24412, policy 0.00056, entropy -0.00053, approx_kl 0.01062 clip_fraction 0.00146. 
Epoch 2/5. 
Losses: total 0.06414, value 0.18791, policy 0.00039, entropy -0.00048, approx_kl 0.03029 clip_fraction 0.00188. 
Epoch 3/5. 
Losses: total 0.04684, value 0.15675, policy 0.00031, entropy -0.00041, approx_kl 0.04377 clip_fraction 0.00208. 
Epoch 4/5. 
Losses: total 0.04018, value 0.13710, policy 0.00030, entropy -0.00041, approx_kl 0.05186 clip_fraction 0.00230. 
Epoch 5/5. 
Losses: total 0.03106, value 0.12331, policy 0.00026, entropy -0.00041, approx_kl 0.05641 clip_fraction 0.00237. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.731, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.658                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.484                    |
|    len                  | 5.658 +/- 7.40 (34128)   |
|    len_d_1_pos          | 5.347 +/- 7.62 (12821)   |
|    len_d_2_pos          | 5.220 +/- 7.53 (1275)    |
|    len_d_3_pos          | 5.315 +/- 7.60 (1260)    |
|    len_d_4_pos          | 5.524 +/- 7.70 (813)     |
|    len_d_unknown_neg    | 5.942 +/- 7.18 (17959)   |
|    len_neg              | 5.942 +/- 7.18 (17959)   |
|    len_pos              | 5.343 +/- 7.61 (16169)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (12821)   |
|    proven_d_2_pos       | 0.732 +/- 0.44 (1275)    |
|    proven_d_3_pos       | 0.727 +/- 0.45 (1260)    |
|    proven_d_4_pos       | 0.711 +/- 0.45 (813)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (17959)   |
|    proven_neg           | 0.006 +/- 0.08 (17959)   |
|    proven_pos           | 0.723 +/- 0.45 (16169)   |
|    reward               | 0.731 +/- 0.68 (34128)   |
|    reward_d_1_pos       | 0.444 +/- 0.90 (12821)   |
|    reward_d_2_pos       | 0.464 +/- 0.89 (1275)    |
|    reward_d_3_pos       | 0.454 +/- 0.89 (1260)    |
|    reward_d_4_pos       | 0.422 +/- 0.91 (813)     |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (17959)   |
|    reward_neg           | 0.988 +/- 0.16 (17959)   |
|    reward_pos           | 0.445 +/- 0.90 (16169)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 102                      |
|    time/fps             | 2196                     |
|    total_timesteps      | 196608                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.36s. FPS: 24089.63
Epoch 1/5. 
Losses: total 0.09472, value 0.25357, policy 0.00071, entropy -0.00054, approx_kl 0.01363 clip_fraction 0.00143. 
Epoch 2/5. 
Losses: total 0.05409, value 0.20116, policy 0.00070, entropy -0.00050, approx_kl 0.02285 clip_fraction 0.00163. 
Epoch 3/5. 
Losses: total 0.05561, value 0.17034, policy 0.00070, entropy -0.00044, approx_kl 0.02879 clip_fraction 0.00174. 
Epoch 4/5. 
Losses: total 0.04218, value 0.15023, policy 0.00065, entropy -0.00042, approx_kl 0.03344 clip_fraction 0.00182. 
Epoch 5/5. 
Losses: total 0.03455, value 0.13607, policy 0.00057, entropy -0.00044, approx_kl 0.04388 clip_fraction 0.00200. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.731, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.654                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.489                    |
|    len                  | 5.654 +/- 7.40 (39884)   |
|    len_d_1_pos          | 5.340 +/- 7.62 (15001)   |
|    len_d_2_pos          | 5.283 +/- 7.58 (1479)    |
|    len_d_3_pos          | 5.330 +/- 7.62 (1469)    |
|    len_d_4_pos          | 5.377 +/- 7.64 (979)     |
|    len_d_unknown_neg    | 5.941 +/- 7.18 (20956)   |
|    len_neg              | 5.941 +/- 7.18 (20956)   |
|    len_pos              | 5.337 +/- 7.62 (18928)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (15001)   |
|    proven_d_2_pos       | 0.728 +/- 0.45 (1479)    |
|    proven_d_3_pos       | 0.728 +/- 0.45 (1469)    |
|    proven_d_4_pos       | 0.722 +/- 0.45 (979)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (20956)   |
|    proven_neg           | 0.007 +/- 0.08 (20956)   |
|    proven_pos           | 0.723 +/- 0.45 (18928)   |
|    reward               | 0.731 +/- 0.68 (39884)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (15001)   |
|    reward_d_2_pos       | 0.455 +/- 0.89 (1479)    |
|    reward_d_3_pos       | 0.455 +/- 0.89 (1469)    |
|    reward_d_4_pos       | 0.444 +/- 0.90 (979)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (20956)   |
|    reward_neg           | 0.987 +/- 0.16 (20956)   |
|    reward_pos           | 0.447 +/- 0.89 (18928)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 117                      |
|    time/fps             | 2195                     |
|    total_timesteps      | 229376                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.36s. FPS: 24101.46
Epoch 1/5. 
Losses: total 0.09445, value 0.24248, policy 0.00055, entropy -0.00059, approx_kl 0.02119 clip_fraction 0.00183. 
Epoch 2/5. 
Losses: total 0.05803, value 0.19281, policy 0.00053, entropy -0.00056, approx_kl 0.03231 clip_fraction 0.00217. 
Epoch 3/5. 
Losses: total 0.04075, value 0.16416, policy 0.00049, entropy -0.00053, approx_kl 0.04003 clip_fraction 0.00229. 
Epoch 4/5. 
Losses: total 0.04801, value 0.14515, policy 0.00036, entropy -0.00050, approx_kl 0.04532 clip_fraction 0.00230. 
Epoch 5/5. 
Losses: total 0.04293, value 0.13172, policy 0.00025, entropy -0.00047, approx_kl 0.05254 clip_fraction 0.00238. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.733, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.645                    |
|    ep_rew_mean          | 0.733                    |
|    explained_variance   | 0.476                    |
|    len                  | 5.645 +/- 7.40 (45696)   |
|    len_d_1_pos          | 5.282 +/- 7.58 (17184)   |
|    len_d_2_pos          | 5.244 +/- 7.56 (1690)    |
|    len_d_3_pos          | 5.276 +/- 7.59 (1702)    |
|    len_d_4_pos          | 5.400 +/- 7.66 (1118)    |
|    len_d_unknown_neg    | 5.972 +/- 7.21 (24002)   |
|    len_neg              | 5.972 +/- 7.21 (24002)   |
|    len_pos              | 5.284 +/- 7.58 (21694)   |
|    proven_d_1_pos       | 0.725 +/- 0.45 (17184)   |
|    proven_d_2_pos       | 0.730 +/- 0.44 (1690)    |
|    proven_d_3_pos       | 0.731 +/- 0.44 (1702)    |
|    proven_d_4_pos       | 0.724 +/- 0.45 (1118)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (24002)   |
|    proven_neg           | 0.007 +/- 0.08 (24002)   |
|    proven_pos           | 0.726 +/- 0.45 (21694)   |
|    reward               | 0.733 +/- 0.68 (45696)   |
|    reward_d_1_pos       | 0.451 +/- 0.89 (17184)   |
|    reward_d_2_pos       | 0.459 +/- 0.89 (1690)    |
|    reward_d_3_pos       | 0.462 +/- 0.89 (1702)    |
|    reward_d_4_pos       | 0.447 +/- 0.89 (1118)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (24002)   |
|    reward_neg           | 0.987 +/- 0.16 (24002)   |
|    reward_pos           | 0.452 +/- 0.89 (21694)   |
|    success_rate         | 0.348                    |
|    time/elapsed         | 132                      |
|    time/fps             | 2193                     |
|    total_timesteps      | 262144                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.940, best=0.955 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.965                    |
|    MRR                  | 0.940                    |
|    len_d_-1_pos         | 12.917                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.091                    |
|    len_pos              | 8.570                    |
|    mrr_mean             | 0.940                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.36s. FPS: 24050.65
Epoch 1/5. 
Losses: total 0.09939, value 0.28434, policy 0.00007, entropy -0.00034, approx_kl 0.00140 clip_fraction 0.00076. 
Epoch 2/5. 
Losses: total 0.07883, value 0.22703, policy 0.00009, entropy -0.00031, approx_kl 0.00519 clip_fraction 0.00087. 
Epoch 3/5. 
Losses: total 0.05656, value 0.19095, policy 0.00011, entropy -0.00028, approx_kl 0.01325 clip_fraction 0.00116. 
Epoch 4/5. 
Losses: total 0.05031, value 0.16697, policy 0.00013, entropy -0.00027, approx_kl 0.02028 clip_fraction 0.00127. 
Epoch 5/5. 
Losses: total 0.03559, value 0.14990, policy 0.00014, entropy -0.00027, approx_kl 0.02517 clip_fraction 0.00137. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.731, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.652                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.408                    |
|    len                  | 5.652 +/- 7.40 (51351)   |
|    len_d_1_pos          | 5.331 +/- 7.61 (19295)   |
|    len_d_2_pos          | 5.285 +/- 7.59 (1888)    |
|    len_d_3_pos          | 5.321 +/- 7.64 (1904)    |
|    len_d_4_pos          | 5.395 +/- 7.66 (1244)    |
|    len_d_unknown_neg    | 5.943 +/- 7.20 (27020)   |
|    len_neg              | 5.943 +/- 7.20 (27020)   |
|    len_pos              | 5.330 +/- 7.61 (24331)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (19295)   |
|    proven_d_2_pos       | 0.729 +/- 0.44 (1888)    |
|    proven_d_3_pos       | 0.730 +/- 0.44 (1904)    |
|    proven_d_4_pos       | 0.724 +/- 0.45 (1244)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (27020)   |
|    proven_neg           | 0.006 +/- 0.08 (27020)   |
|    proven_pos           | 0.724 +/- 0.45 (24331)   |
|    reward               | 0.731 +/- 0.68 (51351)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (19295)   |
|    reward_d_2_pos       | 0.458 +/- 0.89 (1888)    |
|    reward_d_3_pos       | 0.459 +/- 0.89 (1904)    |
|    reward_d_4_pos       | 0.449 +/- 0.89 (1244)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (27020)   |
|    reward_neg           | 0.987 +/- 0.16 (27020)   |
|    reward_pos           | 0.447 +/- 0.89 (24331)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 148                      |
|    time/fps             | 2015                     |
|    total_timesteps      | 294912                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.36s. FPS: 24112.29
Epoch 1/5. 
Losses: total 0.11220, value 0.28349, policy 0.00050, entropy -0.00059, approx_kl 0.00447 clip_fraction 0.00116. 
Epoch 2/5. 
Losses: total 0.07919, value 0.23267, policy 0.00037, entropy -0.00060, approx_kl 0.02559 clip_fraction 0.00191. 
Epoch 3/5. 
Losses: total 0.06577, value 0.19892, policy 0.00034, entropy -0.00065, approx_kl 0.05124 clip_fraction 0.00246. 
Epoch 4/5. 
Losses: total 0.05822, value 0.17551, policy 0.00022, entropy -0.00061, approx_kl 0.05669 clip_fraction 0.00255. 
Epoch 5/5. 
Losses: total 0.04876, value 0.15861, policy 0.00017, entropy -0.00060, approx_kl 0.06759 clip_fraction 0.00269. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.730, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.669                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.428                    |
|    len                  | 5.669 +/- 7.41 (56906)   |
|    len_d_1_pos          | 5.363 +/- 7.63 (21372)   |
|    len_d_2_pos          | 5.393 +/- 7.66 (2097)    |
|    len_d_3_pos          | 5.416 +/- 7.69 (2113)    |
|    len_d_4_pos          | 5.327 +/- 7.63 (1384)    |
|    len_d_unknown_neg    | 5.941 +/- 7.20 (29940)   |
|    len_neg              | 5.941 +/- 7.20 (29940)   |
|    len_pos              | 5.367 +/- 7.63 (26966)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (21372)   |
|    proven_d_2_pos       | 0.722 +/- 0.45 (2097)    |
|    proven_d_3_pos       | 0.726 +/- 0.45 (2113)    |
|    proven_d_4_pos       | 0.729 +/- 0.44 (1384)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (29940)   |
|    proven_neg           | 0.006 +/- 0.08 (29940)   |
|    proven_pos           | 0.722 +/- 0.45 (26966)   |
|    reward               | 0.730 +/- 0.68 (56906)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (21372)   |
|    reward_d_2_pos       | 0.445 +/- 0.90 (2097)    |
|    reward_d_3_pos       | 0.451 +/- 0.89 (2113)    |
|    reward_d_4_pos       | 0.458 +/- 0.89 (1384)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (29940)   |
|    reward_neg           | 0.988 +/- 0.16 (29940)   |
|    reward_pos           | 0.443 +/- 0.90 (26966)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 163                      |
|    time/fps             | 2192                     |
|    total_timesteps      | 327680                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.36s. FPS: 24078.06
Epoch 1/5. 
Losses: total 0.10400, value 0.29151, policy 0.00012, entropy -0.00048, approx_kl 0.00699 clip_fraction 0.00110. 
Epoch 2/5. 
Losses: total 0.08460, value 0.24167, policy 0.00016, entropy -0.00039, approx_kl 0.01349 clip_fraction 0.00130. 
Epoch 3/5. 
Losses: total 0.07164, value 0.20819, policy 0.00016, entropy -0.00039, approx_kl 0.01537 clip_fraction 0.00140. 
Epoch 4/5. 
Losses: total 0.05058, value 0.18486, policy 0.00016, entropy -0.00039, approx_kl 0.01552 clip_fraction 0.00146. 
Epoch 5/5. 
Losses: total 0.04921, value 0.16763, policy 0.00014, entropy -0.00038, approx_kl 0.01882 clip_fraction 0.00151. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.730, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.669                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.427                    |
|    len                  | 5.669 +/- 7.42 (62611)   |
|    len_d_1_pos          | 5.373 +/- 7.64 (23504)   |
|    len_d_2_pos          | 5.373 +/- 7.65 (2315)    |
|    len_d_3_pos          | 5.399 +/- 7.68 (2350)    |
|    len_d_4_pos          | 5.460 +/- 7.73 (1499)    |
|    len_d_unknown_neg    | 5.930 +/- 7.20 (32943)   |
|    len_neg              | 5.930 +/- 7.20 (32943)   |
|    len_pos              | 5.380 +/- 7.65 (29668)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (23504)   |
|    proven_d_2_pos       | 0.724 +/- 0.45 (2315)    |
|    proven_d_3_pos       | 0.724 +/- 0.45 (2350)    |
|    proven_d_4_pos       | 0.722 +/- 0.45 (1499)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (32943)   |
|    proven_neg           | 0.006 +/- 0.08 (32943)   |
|    proven_pos           | 0.721 +/- 0.45 (29668)   |
|    reward               | 0.730 +/- 0.68 (62611)   |
|    reward_d_1_pos       | 0.442 +/- 0.90 (23504)   |
|    reward_d_2_pos       | 0.447 +/- 0.89 (2315)    |
|    reward_d_3_pos       | 0.449 +/- 0.89 (2350)    |
|    reward_d_4_pos       | 0.445 +/- 0.90 (1499)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (32943)   |
|    reward_neg           | 0.988 +/- 0.15 (32943)   |
|    reward_pos           | 0.443 +/- 0.90 (29668)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 178                      |
|    time/fps             | 2190                     |
|    total_timesteps      | 360448                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.36s. FPS: 24055.10
Epoch 1/5. 
Losses: total 0.10684, value 0.29281, policy 0.00030, entropy -0.00071, approx_kl 0.00476 clip_fraction 0.00110. 
Epoch 2/5. 
Losses: total 0.07960, value 0.24863, policy 0.00008, entropy -0.00062, approx_kl 0.01158 clip_fraction 0.00150. 
Epoch 3/5. 
Losses: total 0.07469, value 0.21801, policy 0.00003, entropy -0.00061, approx_kl 0.01635 clip_fraction 0.00173. 
Epoch 4/5. 
Losses: total 0.06484, value 0.19560, policy 0.00003, entropy -0.00063, approx_kl 0.01918 clip_fraction 0.00191. 
Epoch 5/5. 
Losses: total 0.05139, value 0.17861, policy 0.00001, entropy -0.00060, approx_kl 0.02376 clip_fraction 0.00201. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.730, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.665                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.423                    |
|    len                  | 5.665 +/- 7.42 (68377)   |
|    len_d_1_pos          | 5.373 +/- 7.64 (25667)   |
|    len_d_2_pos          | 5.468 +/- 7.71 (2509)    |
|    len_d_3_pos          | 5.377 +/- 7.65 (2578)    |
|    len_d_4_pos          | 5.315 +/- 7.63 (1647)    |
|    len_d_unknown_neg    | 5.924 +/- 7.20 (35976)   |
|    len_neg              | 5.924 +/- 7.20 (35976)   |
|    len_pos              | 5.377 +/- 7.64 (32401)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (25667)   |
|    proven_d_2_pos       | 0.719 +/- 0.45 (2509)    |
|    proven_d_3_pos       | 0.726 +/- 0.45 (2578)    |
|    proven_d_4_pos       | 0.732 +/- 0.44 (1647)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (35976)   |
|    proven_neg           | 0.006 +/- 0.08 (35976)   |
|    proven_pos           | 0.722 +/- 0.45 (32401)   |
|    reward               | 0.730 +/- 0.68 (68377)   |
|    reward_d_1_pos       | 0.442 +/- 0.90 (25667)   |
|    reward_d_2_pos       | 0.437 +/- 0.90 (2509)    |
|    reward_d_3_pos       | 0.452 +/- 0.89 (2578)    |
|    reward_d_4_pos       | 0.463 +/- 0.89 (1647)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (35976)   |
|    reward_neg           | 0.988 +/- 0.16 (35976)   |
|    reward_pos           | 0.443 +/- 0.90 (32401)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 193                      |
|    time/fps             | 2188                     |
|    total_timesteps      | 393216                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.950, best=0.955 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.920                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.975                    |
|    MRR                  | 0.950                    |
|    len_d_-1_pos         | 13.021                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.180                    |
|    len_pos              | 8.620                    |
|    mrr_mean             | 0.950                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.36s. FPS: 24007.58
Epoch 1/5. 
Losses: total 0.14208, value 0.30025, policy 0.00037, entropy -0.00053, approx_kl 0.00498 clip_fraction 0.00113. 
Epoch 2/5. 
Losses: total 0.09721, value 0.26065, policy 0.00026, entropy -0.00047, approx_kl 0.01010 clip_fraction 0.00113. 
Epoch 3/5. 
Losses: total 0.07624, value 0.23195, policy 0.00016, entropy -0.00045, approx_kl 0.01305 clip_fraction 0.00124. 
Epoch 4/5. 
Losses: total 0.07182, value 0.20995, policy 0.00009, entropy -0.00042, approx_kl 0.01498 clip_fraction 0.00130. 
Epoch 5/5. 
Losses: total 0.05802, value 0.19280, policy 0.00003, entropy -0.00041, approx_kl 0.01621 clip_fraction 0.00135. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.729, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.674                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.422                    |
|    len                  | 5.674 +/- 7.43 (73969)   |
|    len_d_1_pos          | 5.390 +/- 7.65 (27758)   |
|    len_d_2_pos          | 5.507 +/- 7.73 (2712)    |
|    len_d_3_pos          | 5.317 +/- 7.62 (2812)    |
|    len_d_4_pos          | 5.384 +/- 7.68 (1773)    |
|    len_d_unknown_neg    | 5.928 +/- 7.20 (38914)   |
|    len_neg              | 5.928 +/- 7.20 (38914)   |
|    len_pos              | 5.393 +/- 7.66 (35055)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (27758)   |
|    proven_d_2_pos       | 0.716 +/- 0.45 (2712)    |
|    proven_d_3_pos       | 0.729 +/- 0.44 (2812)    |
|    proven_d_4_pos       | 0.729 +/- 0.44 (1773)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (38914)   |
|    proven_neg           | 0.006 +/- 0.08 (38914)   |
|    proven_pos           | 0.721 +/- 0.45 (35055)   |
|    reward               | 0.729 +/- 0.68 (73969)   |
|    reward_d_1_pos       | 0.440 +/- 0.90 (27758)   |
|    reward_d_2_pos       | 0.432 +/- 0.90 (2712)    |
|    reward_d_3_pos       | 0.459 +/- 0.89 (2812)    |
|    reward_d_4_pos       | 0.457 +/- 0.89 (1773)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (38914)   |
|    reward_neg           | 0.988 +/- 0.16 (38914)   |
|    reward_pos           | 0.442 +/- 0.90 (35055)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 209                      |
|    time/fps             | 2010                     |
|    total_timesteps      | 425984                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.36s. FPS: 24051.60
Epoch 1/5. 
Losses: total 0.13352, value 0.30705, policy 0.00068, entropy -0.00063, approx_kl 0.00758 clip_fraction 0.00110. 
Epoch 2/5. 
Losses: total 0.11479, value 0.27646, policy 0.00045, entropy -0.00061, approx_kl 0.01280 clip_fraction 0.00130. 
Epoch 3/5. 
Losses: total 0.09881, value 0.25285, policy 0.00028, entropy -0.00058, approx_kl 0.01592 clip_fraction 0.00145. 
Epoch 4/5. 
Losses: total 0.08393, value 0.23339, policy 0.00020, entropy -0.00056, approx_kl 0.01775 clip_fraction 0.00156. 
Epoch 5/5. 
Losses: total 0.07770, value 0.21728, policy 0.00015, entropy -0.00054, approx_kl 0.01939 clip_fraction 0.00164. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.729, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.677                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.435                    |
|    len                  | 5.677 +/- 7.43 (79642)   |
|    len_d_1_pos          | 5.386 +/- 7.65 (29921)   |
|    len_d_2_pos          | 5.513 +/- 7.74 (2908)    |
|    len_d_3_pos          | 5.356 +/- 7.64 (3014)    |
|    len_d_4_pos          | 5.408 +/- 7.71 (1897)    |
|    len_d_unknown_neg    | 5.932 +/- 7.21 (41902)   |
|    len_neg              | 5.932 +/- 7.21 (41902)   |
|    len_pos              | 5.395 +/- 7.66 (37740)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (29921)   |
|    proven_d_2_pos       | 0.717 +/- 0.45 (2908)    |
|    proven_d_3_pos       | 0.727 +/- 0.45 (3014)    |
|    proven_d_4_pos       | 0.729 +/- 0.44 (1897)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (41902)   |
|    proven_neg           | 0.006 +/- 0.08 (41902)   |
|    proven_pos           | 0.721 +/- 0.45 (37740)   |
|    reward               | 0.729 +/- 0.68 (79642)   |
|    reward_d_1_pos       | 0.440 +/- 0.90 (29921)   |
|    reward_d_2_pos       | 0.434 +/- 0.90 (2908)    |
|    reward_d_3_pos       | 0.454 +/- 0.89 (3014)    |
|    reward_d_4_pos       | 0.458 +/- 0.89 (1897)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (41902)   |
|    reward_neg           | 0.988 +/- 0.16 (41902)   |
|    reward_pos           | 0.442 +/- 0.90 (37740)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 224                      |
|    time/fps             | 2185                     |
|    total_timesteps      | 458752                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.36s. FPS: 24094.93
Epoch 1/5. 
Losses: total 0.16111, value 0.30804, policy 0.00234, entropy -0.00067, approx_kl 0.00253 clip_fraction 0.00089. 
Epoch 2/5. 
Losses: total 0.12892, value 0.28762, policy 0.00160, entropy -0.00055, approx_kl 0.00434 clip_fraction 0.00101. 
Epoch 3/5. 
Losses: total 0.12428, value 0.27046, policy 0.00100, entropy -0.00048, approx_kl 0.00587 clip_fraction 0.00111. 
Epoch 4/5. 
Losses: total 0.11167, value 0.25577, policy 0.00070, entropy -0.00045, approx_kl 0.00654 clip_fraction 0.00115. 
Epoch 5/5. 
Losses: total 0.08906, value 0.24298, policy 0.00051, entropy -0.00044, approx_kl 0.00698 clip_fraction 0.00119. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.729, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.666                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.456                    |
|    len                  | 5.666 +/- 7.43 (85507)   |
|    len_d_1_pos          | 5.382 +/- 7.65 (32121)   |
|    len_d_2_pos          | 5.500 +/- 7.74 (3127)    |
|    len_d_3_pos          | 5.332 +/- 7.63 (3242)    |
|    len_d_4_pos          | 5.369 +/- 7.67 (2040)    |
|    len_d_unknown_neg    | 5.917 +/- 7.20 (44977)   |
|    len_neg              | 5.917 +/- 7.20 (44977)   |
|    len_pos              | 5.386 +/- 7.66 (40530)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (32121)   |
|    proven_d_2_pos       | 0.718 +/- 0.45 (3127)    |
|    proven_d_3_pos       | 0.728 +/- 0.44 (3242)    |
|    proven_d_4_pos       | 0.729 +/- 0.44 (2040)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (44977)   |
|    proven_neg           | 0.006 +/- 0.08 (44977)   |
|    proven_pos           | 0.721 +/- 0.45 (40530)   |
|    reward               | 0.729 +/- 0.68 (85507)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (32121)   |
|    reward_d_2_pos       | 0.436 +/- 0.90 (3127)    |
|    reward_d_3_pos       | 0.457 +/- 0.89 (3242)    |
|    reward_d_4_pos       | 0.458 +/- 0.89 (2040)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (44977)   |
|    reward_neg           | 0.988 +/- 0.16 (44977)   |
|    reward_pos           | 0.443 +/- 0.90 (40530)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 239                      |
|    time/fps             | 2185                     |
|    total_timesteps      | 491520                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt
[PPO] Rollout collected in 1.37s. FPS: 23982.32
Epoch 1/5. 
Losses: total 0.15298, value 0.31923, policy 0.00007, entropy -0.00050, approx_kl 0.00015 clip_fraction 0.00049. 
Epoch 2/5. 
Losses: total 0.15854, value 0.31040, policy -0.00002, entropy -0.00046, approx_kl 0.00044 clip_fraction 0.00058. 
Epoch 3/5. 
Losses: total 0.12283, value 0.30292, policy -0.00005, entropy -0.00046, approx_kl 0.00066 clip_fraction 0.00065. 
Epoch 4/5. 
Losses: total 0.11943, value 0.29627, policy -0.00006, entropy -0.00045, approx_kl 0.00088 clip_fraction 0.00069. 
Epoch 5/5. 
Losses: total 0.12838, value 0.29015, policy -0.00008, entropy -0.00045, approx_kl 0.00108 clip_fraction 0.00073. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.730, best=0.748 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.667                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.445                    |
|    len                  | 5.667 +/- 7.43 (91179)   |
|    len_d_1_pos          | 5.388 +/- 7.65 (34243)   |
|    len_d_2_pos          | 5.434 +/- 7.70 (3343)    |
|    len_d_3_pos          | 5.317 +/- 7.62 (3457)    |
|    len_d_4_pos          | 5.272 +/- 7.62 (2178)    |
|    len_d_unknown_neg    | 5.926 +/- 7.21 (47958)   |
|    len_neg              | 5.926 +/- 7.21 (47958)   |
|    len_pos              | 5.380 +/- 7.65 (43221)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (34243)   |
|    proven_d_2_pos       | 0.721 +/- 0.45 (3343)    |
|    proven_d_3_pos       | 0.728 +/- 0.45 (3457)    |
|    proven_d_4_pos       | 0.734 +/- 0.44 (2178)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (47958)   |
|    proven_neg           | 0.006 +/- 0.08 (47958)   |
|    proven_pos           | 0.722 +/- 0.45 (43221)   |
|    reward               | 0.730 +/- 0.68 (91179)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (34243)   |
|    reward_d_2_pos       | 0.442 +/- 0.90 (3343)    |
|    reward_d_3_pos       | 0.456 +/- 0.89 (3457)    |
|    reward_d_4_pos       | 0.467 +/- 0.88 (2178)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (47958)   |
|    reward_neg           | 0.988 +/- 0.16 (47958)   |
|    reward_pos           | 0.444 +/- 0.90 (43221)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 254                      |
|    time/fps             | 2182                     |
|    total_timesteps      | 524288                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.948, best=0.955 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.920                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.970                    |
|    MRR                  | 0.948                    |
|    len_d_-1_pos         | 13.062                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.243                    |
|    len_pos              | 8.640                    |
|    mrr_mean             | 0.948                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.010                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.010                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_34_05.pt

[Checkpoint] Restoring best model at end of training...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_09_34_05.pt
Loaded best model info: {'metric': 'mrr_mean', 'best_value': 0.9545021653175354, 'timesteps': 4, 'explained_variance': 0.6948950290679932}

[2.5/3] Training neural bridge on validation data...
[NeuralBridge] Training neural bridge on 100 queries...
[NeuralBridge] Training on 200 queries, 11 candidates each
  Epoch 10/100: loss=-0.6634, alpha=0.4751
  Epoch 20/100: loss=-0.6830, alpha=0.4507
  Epoch 30/100: loss=-0.7004, alpha=0.4273
  Epoch 40/100: loss=-0.7155, alpha=0.4052
  Epoch 50/100: loss=-0.7285, alpha=0.3844
  Epoch 60/100: loss=-0.7397, alpha=0.3652
  Epoch 70/100: loss=-0.7494, alpha=0.3473
  Epoch 80/100: loss=-0.7578, alpha=0.3308
  Epoch 90/100: loss=-0.7651, alpha=0.3155
  Epoch 100/100: loss=-0.7714, alpha=0.3013
[NeuralBridge] Trained alpha: 0.3013

[3/3] Running evaluation...

Results: MRR=0.8416, Hits@1=0.7920, Hits@3=0.8760, Hits@10=0.9330
Proven: pos=0.3720, neg=0.0121
Writing results to /home/castellanoontiv/Batched_Env/kge_experiments/runs/averaged_runs/experiments.csv

============================================================
All experiments completed!
============================================================


[5/10] Running: Neural Bridge (Gated)
==============================================
Grid search: 1 params, 1 experiments.

============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: wn18rr-250-128-torchrl
======================================================================
Training: wn18rr
Envs: 128, Steps: 256, Timesteps: 500000
Seed: 0
======================================================================

[1/3] Creating components...
[UnificationEngine] Capping max_fact_pairs from 34796 to 1000
[EnvOptimal] Compiled with mode=reduce-overhead, fullgraph=True

[2/3] Running training...
KGE Engine initialized with backend: pytorch (signature: torch_wn18rr_RotatE_1024_20260107_125531_s42)
[NeuralBridge] Created GatedBridge with init_alpha_success=0.7, init_alpha_fail=0.2
[PPO] Compiled ranking_step (double-buffered) with mode=default

[Checkpoint] Loading existing model at start of training (load_model=True)...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_09_34_05.pt

============================================================
Initial evaluation (untrained model)
============================================================
Building model and loading weights...
Weights loaded successfully.
[Eval] Took 8.09 seconds

[Ranking] MRR: current=0.938, best=0.938 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.900                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.975                    |
|    MRR                  | 0.938                    |
|    len_d_-1_pos         | 12.646                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.251                    |
|    len_pos              | 8.440                    |
|    mrr_mean             | 0.938                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

============================================================

[PPO] Rollout collected in 3.31s. FPS: 9898.53
Epoch 1/5. 
Losses: total 0.05187, value 0.11949, policy 0.00076, entropy -0.00042, approx_kl 0.01990 clip_fraction 0.00189. 
Epoch 2/5. 
Losses: total 0.03085, value 0.09693, policy 0.00082, entropy -0.00038, approx_kl 0.04177 clip_fraction 0.00220. 
Epoch 3/5. 
Losses: total 0.02896, value 0.08543, policy 0.00084, entropy -0.00041, approx_kl 0.06992 clip_fraction 0.00270. 
Epoch 4/5. 
Losses: total 0.02418, value 0.07813, policy 0.00074, entropy -0.00036, approx_kl 0.07344 clip_fraction 0.00263. 
Epoch 5/5. 
Losses: total 0.02403, value 0.07285, policy 0.00070, entropy -0.00033, approx_kl 0.08426 clip_fraction 0.00276. 
[PPO] Training completed in 14.28s
[Metrics] Reward (train): current=0.738, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.476                    |
|    ep_rew_mean          | 0.738                    |
|    explained_variance   | 0.753                    |
|    len                  | 5.476 +/- 7.26 (5751)    |
|    len_d_1_pos          | 4.929 +/- 7.29 (2216)    |
|    len_d_2_pos          | 5.131 +/- 7.31 (199)     |
|    len_d_3_pos          | 5.575 +/- 7.75 (219)     |
|    len_d_4_pos          | 5.721 +/- 7.77 (122)     |
|    len_d_unknown_neg    | 5.886 +/- 7.14 (2995)    |
|    len_neg              | 5.886 +/- 7.14 (2995)    |
|    len_pos              | 5.030 +/- 7.36 (2756)    |
|    proven_d_1_pos       | 0.740 +/- 0.44 (2216)    |
|    proven_d_2_pos       | 0.719 +/- 0.45 (199)     |
|    proven_d_3_pos       | 0.708 +/- 0.45 (219)     |
|    proven_d_4_pos       | 0.680 +/- 0.47 (122)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (2995)    |
|    proven_neg           | 0.006 +/- 0.08 (2995)    |
|    proven_pos           | 0.733 +/- 0.44 (2756)    |
|    reward               | 0.738 +/- 0.67 (5751)    |
|    reward_d_1_pos       | 0.480 +/- 0.88 (2216)    |
|    reward_d_2_pos       | 0.437 +/- 0.90 (199)     |
|    reward_d_3_pos       | 0.416 +/- 0.91 (219)     |
|    reward_d_4_pos       | 0.361 +/- 0.93 (122)     |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (2995)    |
|    reward_neg           | 0.988 +/- 0.15 (2995)    |
|    reward_pos           | 0.467 +/- 0.88 (2756)    |
|    success_rate         | 0.355                    |
|    time/elapsed         | 26                       |
|    time/fps             | 1241                     |
|    total_timesteps      | 32768                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.35s. FPS: 24184.20
Epoch 1/5. 
Losses: total 0.04448, value 0.13060, policy 0.00015, entropy -0.00043, approx_kl 0.02255 clip_fraction 0.00186. 
Epoch 2/5. 
Losses: total 0.04325, value 0.10439, policy 0.00011, entropy -0.00047, approx_kl 0.03147 clip_fraction 0.00204. 
Epoch 3/5. 
Losses: total 0.03700, value 0.09108, policy 0.00015, entropy -0.00047, approx_kl 0.05227 clip_fraction 0.00249. 
Epoch 4/5. 
Losses: total 0.03053, value 0.08291, policy 0.00016, entropy -0.00046, approx_kl 0.06592 clip_fraction 0.00269. 
Epoch 5/5. 
Losses: total 0.02468, value 0.07670, policy 0.00013, entropy -0.00044, approx_kl 0.07505 clip_fraction 0.00276. 
[PPO] Training completed in 13.33s
[Metrics] Reward (train): current=0.731, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.578                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.733                    |
|    len                  | 5.578 +/- 7.33 (11433)   |
|    len_d_1_pos          | 5.251 +/- 7.53 (4328)    |
|    len_d_2_pos          | 4.908 +/- 7.22 (411)     |
|    len_d_3_pos          | 5.584 +/- 7.75 (423)     |
|    len_d_4_pos          | 5.171 +/- 7.37 (269)     |
|    len_d_unknown_neg    | 5.877 +/- 7.13 (6002)    |
|    len_neg              | 5.877 +/- 7.13 (6002)    |
|    len_pos              | 5.247 +/- 7.52 (5431)    |
|    proven_d_1_pos       | 0.725 +/- 0.45 (4328)    |
|    proven_d_2_pos       | 0.737 +/- 0.44 (411)     |
|    proven_d_3_pos       | 0.716 +/- 0.45 (423)     |
|    proven_d_4_pos       | 0.717 +/- 0.45 (269)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (6002)    |
|    proven_neg           | 0.007 +/- 0.08 (6002)    |
|    proven_pos           | 0.725 +/- 0.45 (5431)    |
|    reward               | 0.731 +/- 0.68 (11433)   |
|    reward_d_1_pos       | 0.451 +/- 0.89 (4328)    |
|    reward_d_2_pos       | 0.474 +/- 0.88 (411)     |
|    reward_d_3_pos       | 0.433 +/- 0.90 (423)     |
|    reward_d_4_pos       | 0.435 +/- 0.90 (269)     |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (6002)    |
|    reward_neg           | 0.986 +/- 0.17 (6002)    |
|    reward_pos           | 0.450 +/- 0.89 (5431)    |
|    success_rate         | 0.348                    |
|    time/elapsed         | 41                       |
|    time/fps             | 2220                     |
|    total_timesteps      | 65536                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.36s. FPS: 24112.11
Epoch 1/5. 
Losses: total 0.04730, value 0.13559, policy 0.00176, entropy -0.00059, approx_kl 0.11985 clip_fraction 0.00269. 
Epoch 2/5. 
Losses: total 0.04290, value 0.10945, policy 0.00134, entropy -0.00055, approx_kl 0.14203 clip_fraction 0.00288. 
Epoch 3/5. 
Losses: total 0.03121, value 0.09566, policy 0.00129, entropy -0.00050, approx_kl 0.23810 clip_fraction 0.00369. 
Epoch 4/5. 
Losses: total 0.03368, value 0.08643, policy 0.00110, entropy -0.00047, approx_kl 0.21465 clip_fraction 0.00343. 
Epoch 5/5. 
Losses: total 0.02411, value 0.07977, policy 0.00097, entropy -0.00044, approx_kl 0.19270 clip_fraction 0.00324. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.603                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.730                    |
|    len                  | 5.603 +/- 7.35 (17147)   |
|    len_d_1_pos          | 5.301 +/- 7.58 (6490)    |
|    len_d_2_pos          | 5.183 +/- 7.47 (616)     |
|    len_d_3_pos          | 5.487 +/- 7.72 (638)     |
|    len_d_4_pos          | 5.633 +/- 7.70 (387)     |
|    len_d_unknown_neg    | 5.856 +/- 7.12 (9016)    |
|    len_neg              | 5.856 +/- 7.12 (9016)    |
|    len_pos              | 5.323 +/- 7.59 (8131)    |
|    proven_d_1_pos       | 0.723 +/- 0.45 (6490)    |
|    proven_d_2_pos       | 0.734 +/- 0.44 (616)     |
|    proven_d_3_pos       | 0.719 +/- 0.45 (638)     |
|    proven_d_4_pos       | 0.700 +/- 0.46 (387)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (9016)    |
|    proven_neg           | 0.007 +/- 0.08 (9016)    |
|    proven_pos           | 0.722 +/- 0.45 (8131)    |
|    reward               | 0.729 +/- 0.68 (17147)   |
|    reward_d_1_pos       | 0.446 +/- 0.90 (6490)    |
|    reward_d_2_pos       | 0.468 +/- 0.88 (616)     |
|    reward_d_3_pos       | 0.439 +/- 0.90 (638)     |
|    reward_d_4_pos       | 0.401 +/- 0.92 (387)     |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (9016)    |
|    reward_neg           | 0.986 +/- 0.17 (9016)    |
|    reward_pos           | 0.445 +/- 0.90 (8131)    |
|    success_rate         | 0.346                    |
|    time/elapsed         | 56                       |
|    time/fps             | 2201                     |
|    total_timesteps      | 98304                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.37s. FPS: 23952.99
Epoch 1/5. 
Losses: total 0.04694, value 0.12973, policy 0.00078, entropy -0.00056, approx_kl 0.02176 clip_fraction 0.00195. 
Epoch 2/5. 
Losses: total 0.03990, value 0.10370, policy 0.00074, entropy -0.00048, approx_kl 0.03556 clip_fraction 0.00246. 
Epoch 3/5. 
Losses: total 0.04189, value 0.09120, policy 0.00068, entropy -0.00048, approx_kl 0.05899 clip_fraction 0.00281. 
Epoch 4/5. 
Losses: total 0.02381, value 0.08333, policy 0.00060, entropy -0.00046, approx_kl 0.05783 clip_fraction 0.00280. 
Epoch 5/5. 
Losses: total 0.02646, value 0.07762, policy 0.00054, entropy -0.00040, approx_kl 0.06340 clip_fraction 0.00283. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.585                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.736                    |
|    len                  | 5.585 +/- 7.34 (22986)   |
|    len_d_1_pos          | 5.290 +/- 7.57 (8701)    |
|    len_d_2_pos          | 5.355 +/- 7.58 (820)     |
|    len_d_3_pos          | 5.353 +/- 7.63 (868)     |
|    len_d_4_pos          | 5.619 +/- 7.73 (527)     |
|    len_d_unknown_neg    | 5.828 +/- 7.10 (12070)   |
|    len_neg              | 5.828 +/- 7.10 (12070)   |
|    len_pos              | 5.316 +/- 7.59 (10916)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (8701)    |
|    proven_d_2_pos       | 0.723 +/- 0.45 (820)     |
|    proven_d_3_pos       | 0.728 +/- 0.44 (868)     |
|    proven_d_4_pos       | 0.698 +/- 0.46 (527)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (12070)   |
|    proven_neg           | 0.007 +/- 0.08 (12070)   |
|    proven_pos           | 0.722 +/- 0.45 (10916)   |
|    reward               | 0.729 +/- 0.68 (22986)   |
|    reward_d_1_pos       | 0.447 +/- 0.89 (8701)    |
|    reward_d_2_pos       | 0.446 +/- 0.89 (820)     |
|    reward_d_3_pos       | 0.456 +/- 0.89 (868)     |
|    reward_d_4_pos       | 0.397 +/- 0.92 (527)     |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (12070)   |
|    reward_neg           | 0.986 +/- 0.17 (12070)   |
|    reward_pos           | 0.445 +/- 0.90 (10916)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 70                       |
|    time/fps             | 2199                     |
|    total_timesteps      | 131072                   |
----------------------------------------------------

[Eval] Took 1.32 seconds

[Ranking] MRR: current=0.947, best=0.947 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.915                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.985                    |
|    MRR                  | 0.947                    |
|    len_d_-1_pos         | 12.604                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.201                    |
|    len_pos              | 8.420                    |
|    mrr_mean             | 0.947                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.007                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.007                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] New best eval model saved to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_09_39_24.pt (mrr_mean=0.9470)
[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.37s. FPS: 23942.31
Epoch 1/5. 
Losses: total 0.10006, value 0.23412, policy 0.00062, entropy -0.00065, approx_kl 0.01466 clip_fraction 0.00201. 
Epoch 2/5. 
Losses: total 0.05542, value 0.17865, policy 0.00043, entropy -0.00062, approx_kl 0.02651 clip_fraction 0.00226. 
Epoch 3/5. 
Losses: total 0.04682, value 0.14994, policy 0.00032, entropy -0.00060, approx_kl 0.03775 clip_fraction 0.00237. 
Epoch 4/5. 
Losses: total 0.03868, value 0.13193, policy 0.00027, entropy -0.00062, approx_kl 0.04919 clip_fraction 0.00253. 
Epoch 5/5. 
Losses: total 0.03558, value 0.11928, policy 0.00023, entropy -0.00061, approx_kl 0.06466 clip_fraction 0.00273. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.727, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.638                    |
|    ep_rew_mean          | 0.727                    |
|    explained_variance   | 0.504                    |
|    len                  | 5.638 +/- 7.37 (28537)   |
|    len_d_1_pos          | 5.356 +/- 7.61 (10747)   |
|    len_d_2_pos          | 5.329 +/- 7.58 (1033)    |
|    len_d_3_pos          | 5.427 +/- 7.66 (1086)    |
|    len_d_4_pos          | 5.551 +/- 7.75 (661)     |
|    len_d_unknown_neg    | 5.879 +/- 7.14 (15010)   |
|    len_neg              | 5.879 +/- 7.14 (15010)   |
|    len_pos              | 5.369 +/- 7.62 (13527)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (10747)   |
|    proven_d_2_pos       | 0.725 +/- 0.45 (1033)    |
|    proven_d_3_pos       | 0.722 +/- 0.45 (1086)    |
|    proven_d_4_pos       | 0.714 +/- 0.45 (661)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (15010)   |
|    proven_neg           | 0.007 +/- 0.08 (15010)   |
|    proven_pos           | 0.719 +/- 0.45 (13527)   |
|    reward               | 0.727 +/- 0.69 (28537)   |
|    reward_d_1_pos       | 0.437 +/- 0.90 (10747)   |
|    reward_d_2_pos       | 0.450 +/- 0.89 (1033)    |
|    reward_d_3_pos       | 0.444 +/- 0.90 (1086)    |
|    reward_d_4_pos       | 0.428 +/- 0.90 (661)     |
|    reward_d_unknown_neg | 0.986 +/- 0.16 (15010)   |
|    reward_neg           | 0.986 +/- 0.16 (15010)   |
|    reward_pos           | 0.438 +/- 0.90 (13527)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 87                       |
|    time/fps             | 2014                     |
|    total_timesteps      | 163840                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.36s. FPS: 24050.70
Epoch 1/5. 
Losses: total 0.09372, value 0.24718, policy 0.00047, entropy -0.00066, approx_kl 0.02598 clip_fraction 0.00253. 
Epoch 2/5. 
Losses: total 0.05554, value 0.19047, policy 0.00052, entropy -0.00061, approx_kl 0.04326 clip_fraction 0.00299. 
Epoch 3/5. 
Losses: total 0.05449, value 0.16042, policy 0.00048, entropy -0.00061, approx_kl 0.05645 clip_fraction 0.00311. 
Epoch 4/5. 
Losses: total 0.04457, value 0.14087, policy 0.00048, entropy -0.00059, approx_kl 0.08534 clip_fraction 0.00344. 
Epoch 5/5. 
Losses: total 0.03993, value 0.12695, policy 0.00044, entropy -0.00058, approx_kl 0.09592 clip_fraction 0.00355. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.727, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.628                    |
|    ep_rew_mean          | 0.727                    |
|    explained_variance   | 0.466                    |
|    len                  | 5.628 +/- 7.36 (34299)   |
|    len_d_1_pos          | 5.339 +/- 7.59 (12914)   |
|    len_d_2_pos          | 5.290 +/- 7.56 (1249)    |
|    len_d_3_pos          | 5.284 +/- 7.58 (1291)    |
|    len_d_4_pos          | 5.581 +/- 7.73 (785)     |
|    len_d_unknown_neg    | 5.885 +/- 7.14 (18060)   |
|    len_neg              | 5.885 +/- 7.14 (18060)   |
|    len_pos              | 5.343 +/- 7.60 (16239)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (12914)   |
|    proven_d_2_pos       | 0.727 +/- 0.45 (1249)    |
|    proven_d_3_pos       | 0.731 +/- 0.44 (1291)    |
|    proven_d_4_pos       | 0.708 +/- 0.45 (785)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (18060)   |
|    proven_neg           | 0.007 +/- 0.08 (18060)   |
|    proven_pos           | 0.720 +/- 0.45 (16239)   |
|    reward               | 0.727 +/- 0.69 (34299)   |
|    reward_d_1_pos       | 0.437 +/- 0.90 (12914)   |
|    reward_d_2_pos       | 0.454 +/- 0.89 (1249)    |
|    reward_d_3_pos       | 0.462 +/- 0.89 (1291)    |
|    reward_d_4_pos       | 0.417 +/- 0.91 (785)     |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (18060)   |
|    reward_neg           | 0.986 +/- 0.17 (18060)   |
|    reward_pos           | 0.439 +/- 0.90 (16239)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 102                      |
|    time/fps             | 2198                     |
|    total_timesteps      | 196608                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.36s. FPS: 24066.55
Epoch 1/5. 
Losses: total 0.08426, value 0.24839, policy 0.00021, entropy -0.00071, approx_kl 0.01085 clip_fraction 0.00140. 
Epoch 2/5. 
Losses: total 0.04877, value 0.19411, policy 0.00027, entropy -0.00057, approx_kl 0.02246 clip_fraction 0.00165. 
Epoch 3/5. 
Losses: total 0.05565, value 0.16316, policy 0.00019, entropy -0.00050, approx_kl 0.03079 clip_fraction 0.00183. 
Epoch 4/5. 
Losses: total 0.04334, value 0.14309, policy 0.00013, entropy -0.00049, approx_kl 0.03653 clip_fraction 0.00199. 
Epoch 5/5. 
Losses: total 0.04270, value 0.12900, policy 0.00009, entropy -0.00046, approx_kl 0.04093 clip_fraction 0.00205. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.728, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.625                    |
|    ep_rew_mean          | 0.728                    |
|    explained_variance   | 0.477                    |
|    len                  | 5.625 +/- 7.36 (40079)   |
|    len_d_1_pos          | 5.342 +/- 7.60 (15081)   |
|    len_d_2_pos          | 5.381 +/- 7.62 (1448)    |
|    len_d_3_pos          | 5.275 +/- 7.59 (1505)    |
|    len_d_4_pos          | 5.423 +/- 7.66 (946)     |
|    len_d_unknown_neg    | 5.877 +/- 7.13 (21099)   |
|    len_neg              | 5.877 +/- 7.13 (21099)   |
|    len_pos              | 5.344 +/- 7.60 (18980)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (15081)   |
|    proven_d_2_pos       | 0.720 +/- 0.45 (1448)    |
|    proven_d_3_pos       | 0.734 +/- 0.44 (1505)    |
|    proven_d_4_pos       | 0.720 +/- 0.45 (946)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (21099)   |
|    proven_neg           | 0.007 +/- 0.08 (21099)   |
|    proven_pos           | 0.721 +/- 0.45 (18980)   |
|    reward               | 0.728 +/- 0.69 (40079)   |
|    reward_d_1_pos       | 0.439 +/- 0.90 (15081)   |
|    reward_d_2_pos       | 0.441 +/- 0.90 (1448)    |
|    reward_d_3_pos       | 0.467 +/- 0.88 (1505)    |
|    reward_d_4_pos       | 0.440 +/- 0.90 (946)     |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (21099)   |
|    reward_neg           | 0.986 +/- 0.17 (21099)   |
|    reward_pos           | 0.441 +/- 0.90 (18980)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 117                      |
|    time/fps             | 2197                     |
|    total_timesteps      | 229376                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.36s. FPS: 24052.53
Epoch 1/5. 
Losses: total 0.10640, value 0.25153, policy 0.00072, entropy -0.00061, approx_kl 0.04006 clip_fraction 0.00226. 
Epoch 2/5. 
Losses: total 0.06364, value 0.20092, policy 0.00057, entropy -0.00049, approx_kl 0.04652 clip_fraction 0.00240. 
Epoch 3/5. 
Losses: total 0.05774, value 0.17113, policy 0.00043, entropy -0.00044, approx_kl 0.04347 clip_fraction 0.00232. 
Epoch 4/5. 
Losses: total 0.04739, value 0.15167, policy 0.00029, entropy -0.00044, approx_kl 0.04217 clip_fraction 0.00235. 
Epoch 5/5. 
Losses: total 0.04117, value 0.13774, policy 0.00021, entropy -0.00044, approx_kl 0.04550 clip_fraction 0.00240. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.728, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.630                    |
|    ep_rew_mean          | 0.728                    |
|    explained_variance   | 0.488                    |
|    len                  | 5.630 +/- 7.37 (45801)   |
|    len_d_1_pos          | 5.333 +/- 7.60 (17221)   |
|    len_d_2_pos          | 5.340 +/- 7.60 (1675)    |
|    len_d_3_pos          | 5.270 +/- 7.57 (1712)    |
|    len_d_4_pos          | 5.428 +/- 7.67 (1090)    |
|    len_d_unknown_neg    | 5.898 +/- 7.15 (24103)   |
|    len_neg              | 5.898 +/- 7.15 (24103)   |
|    len_pos              | 5.333 +/- 7.60 (21698)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (17221)   |
|    proven_d_2_pos       | 0.723 +/- 0.45 (1675)    |
|    proven_d_3_pos       | 0.731 +/- 0.44 (1712)    |
|    proven_d_4_pos       | 0.721 +/- 0.45 (1090)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (24103)   |
|    proven_neg           | 0.007 +/- 0.08 (24103)   |
|    proven_pos           | 0.721 +/- 0.45 (21698)   |
|    reward               | 0.728 +/- 0.69 (45801)   |
|    reward_d_1_pos       | 0.440 +/- 0.90 (17221)   |
|    reward_d_2_pos       | 0.446 +/- 0.90 (1675)    |
|    reward_d_3_pos       | 0.463 +/- 0.89 (1712)    |
|    reward_d_4_pos       | 0.442 +/- 0.90 (1090)    |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (24103)   |
|    reward_neg           | 0.986 +/- 0.17 (24103)   |
|    reward_pos           | 0.442 +/- 0.90 (21698)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 131                      |
|    time/fps             | 2195                     |
|    total_timesteps      | 262144                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.937, best=0.947 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.900                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.965                    |
|    MRR                  | 0.937                    |
|    len_d_-1_pos         | 12.500                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.073                    |
|    len_pos              | 8.370                    |
|    mrr_mean             | 0.937                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.004                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.004                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.36s. FPS: 24119.10
Epoch 1/5. 
Losses: total 0.10129, value 0.28232, policy 0.00009, entropy -0.00049, approx_kl 0.01166 clip_fraction 0.00137. 
Epoch 2/5. 
Losses: total 0.06710, value 0.22445, policy 0.00023, entropy -0.00060, approx_kl 0.02466 clip_fraction 0.00186. 
Epoch 3/5. 
Losses: total 0.05801, value 0.18959, policy 0.00013, entropy -0.00055, approx_kl 0.04369 clip_fraction 0.00220. 
Epoch 4/5. 
Losses: total 0.04338, value 0.16617, policy 0.00006, entropy -0.00053, approx_kl 0.06014 clip_fraction 0.00243. 
Epoch 5/5. 
Losses: total 0.03481, value 0.14952, policy 0.00000, entropy -0.00052, approx_kl 0.06995 clip_fraction 0.00256. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.727, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.624                    |
|    ep_rew_mean          | 0.727                    |
|    explained_variance   | 0.414                    |
|    len                  | 5.624 +/- 7.37 (51574)   |
|    len_d_1_pos          | 5.365 +/- 7.62 (19366)   |
|    len_d_2_pos          | 5.300 +/- 7.59 (1893)    |
|    len_d_3_pos          | 5.263 +/- 7.57 (1936)    |
|    len_d_4_pos          | 5.373 +/- 7.64 (1229)    |
|    len_d_unknown_neg    | 5.868 +/- 7.13 (27150)   |
|    len_neg              | 5.868 +/- 7.13 (27150)   |
|    len_pos              | 5.353 +/- 7.61 (24424)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (19366)   |
|    proven_d_2_pos       | 0.725 +/- 0.45 (1893)    |
|    proven_d_3_pos       | 0.731 +/- 0.44 (1936)    |
|    proven_d_4_pos       | 0.723 +/- 0.45 (1229)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (27150)   |
|    proven_neg           | 0.007 +/- 0.08 (27150)   |
|    proven_pos           | 0.720 +/- 0.45 (24424)   |
|    reward               | 0.727 +/- 0.69 (51574)   |
|    reward_d_1_pos       | 0.435 +/- 0.90 (19366)   |
|    reward_d_2_pos       | 0.451 +/- 0.89 (1893)    |
|    reward_d_3_pos       | 0.463 +/- 0.89 (1936)    |
|    reward_d_4_pos       | 0.447 +/- 0.89 (1229)    |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (27150)   |
|    reward_neg           | 0.986 +/- 0.17 (27150)   |
|    reward_pos           | 0.439 +/- 0.90 (24424)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 148                      |
|    time/fps             | 2018                     |
|    total_timesteps      | 294912                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.36s. FPS: 24045.37
Epoch 1/5. 
Losses: total 0.12146, value 0.27452, policy 0.00021, entropy -0.00063, approx_kl 0.01049 clip_fraction 0.00143. 
Epoch 2/5. 
Losses: total 0.08121, value 0.22423, policy 0.00017, entropy -0.00063, approx_kl 0.02020 clip_fraction 0.00172. 
Epoch 3/5. 
Losses: total 0.06383, value 0.19193, policy 0.00011, entropy -0.00061, approx_kl 0.03401 clip_fraction 0.00199. 
Epoch 4/5. 
Losses: total 0.05633, value 0.16917, policy 0.00004, entropy -0.00062, approx_kl 0.04319 clip_fraction 0.00215. 
Epoch 5/5. 
Losses: total 0.04222, value 0.15243, policy 0.00001, entropy -0.00060, approx_kl 0.04466 clip_fraction 0.00221. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.727, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.635                    |
|    ep_rew_mean          | 0.727                    |
|    explained_variance   | 0.444                    |
|    len                  | 5.635 +/- 7.37 (57205)   |
|    len_d_1_pos          | 5.375 +/- 7.62 (21469)   |
|    len_d_2_pos          | 5.322 +/- 7.60 (2105)    |
|    len_d_3_pos          | 5.351 +/- 7.63 (2151)    |
|    len_d_4_pos          | 5.326 +/- 7.63 (1366)    |
|    len_d_unknown_neg    | 5.877 +/- 7.14 (30114)   |
|    len_neg              | 5.877 +/- 7.14 (30114)   |
|    len_pos              | 5.366 +/- 7.62 (27091)   |
|    proven_d_1_pos       | 0.717 +/- 0.45 (21469)   |
|    proven_d_2_pos       | 0.723 +/- 0.45 (2105)    |
|    proven_d_3_pos       | 0.728 +/- 0.45 (2151)    |
|    proven_d_4_pos       | 0.728 +/- 0.44 (1366)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (30114)   |
|    proven_neg           | 0.007 +/- 0.08 (30114)   |
|    proven_pos           | 0.719 +/- 0.45 (27091)   |
|    reward               | 0.727 +/- 0.69 (57205)   |
|    reward_d_1_pos       | 0.434 +/- 0.90 (21469)   |
|    reward_d_2_pos       | 0.445 +/- 0.90 (2105)    |
|    reward_d_3_pos       | 0.455 +/- 0.89 (2151)    |
|    reward_d_4_pos       | 0.457 +/- 0.89 (1366)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (30114)   |
|    reward_neg           | 0.987 +/- 0.16 (30114)   |
|    reward_pos           | 0.438 +/- 0.90 (27091)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 163                      |
|    time/fps             | 2192                     |
|    total_timesteps      | 327680                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.36s. FPS: 24044.82
Epoch 1/5. 
Losses: total 0.11166, value 0.30265, policy 0.00028, entropy -0.00063, approx_kl 0.00542 clip_fraction 0.00128. 
Epoch 2/5. 
Losses: total 0.08789, value 0.25214, policy 0.00013, entropy -0.00058, approx_kl 0.01552 clip_fraction 0.00145. 
Epoch 3/5. 
Losses: total 0.07376, value 0.21761, policy 0.00007, entropy -0.00053, approx_kl 0.03742 clip_fraction 0.00183. 
Epoch 4/5. 
Losses: total 0.04940, value 0.19257, policy -0.00002, entropy -0.00048, approx_kl 0.04671 clip_fraction 0.00212. 
Epoch 5/5. 
Losses: total 0.05341, value 0.17394, policy -0.00004, entropy -0.00046, approx_kl 0.05968 clip_fraction 0.00236. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.727, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.622                    |
|    ep_rew_mean          | 0.727                    |
|    explained_variance   | 0.410                    |
|    len                  | 5.622 +/- 7.37 (63095)   |
|    len_d_1_pos          | 5.364 +/- 7.62 (23675)   |
|    len_d_2_pos          | 5.278 +/- 7.56 (2336)    |
|    len_d_3_pos          | 5.324 +/- 7.59 (2387)    |
|    len_d_4_pos          | 5.344 +/- 7.64 (1487)    |
|    len_d_unknown_neg    | 5.864 +/- 7.13 (33210)   |
|    len_neg              | 5.864 +/- 7.13 (33210)   |
|    len_pos              | 5.353 +/- 7.61 (29885)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (23675)   |
|    proven_d_2_pos       | 0.724 +/- 0.45 (2336)    |
|    proven_d_3_pos       | 0.725 +/- 0.45 (2387)    |
|    proven_d_4_pos       | 0.727 +/- 0.45 (1487)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (33210)   |
|    proven_neg           | 0.006 +/- 0.08 (33210)   |
|    proven_pos           | 0.719 +/- 0.45 (29885)   |
|    reward               | 0.727 +/- 0.69 (63095)   |
|    reward_d_1_pos       | 0.436 +/- 0.90 (23675)   |
|    reward_d_2_pos       | 0.449 +/- 0.89 (2336)    |
|    reward_d_3_pos       | 0.450 +/- 0.89 (2387)    |
|    reward_d_4_pos       | 0.454 +/- 0.89 (1487)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (33210)   |
|    reward_neg           | 0.987 +/- 0.16 (33210)   |
|    reward_pos           | 0.439 +/- 0.90 (29885)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 178                      |
|    time/fps             | 2191                     |
|    total_timesteps      | 360448                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.39s. FPS: 23640.58
Epoch 1/5. 
Losses: total 0.11996, value 0.29320, policy 0.00048, entropy -0.00057, approx_kl 0.00709 clip_fraction 0.00089. 
Epoch 2/5. 
Losses: total 0.08347, value 0.24861, policy 0.00027, entropy -0.00052, approx_kl 0.01727 clip_fraction 0.00122. 
Epoch 3/5. 
Losses: total 0.07676, value 0.21723, policy 0.00013, entropy -0.00044, approx_kl 0.01865 clip_fraction 0.00129. 
Epoch 4/5. 
Losses: total 0.06939, value 0.19405, policy 0.00005, entropy -0.00039, approx_kl 0.01921 clip_fraction 0.00132. 
Epoch 5/5. 
Losses: total 0.04635, value 0.17639, policy 0.00001, entropy -0.00038, approx_kl 0.01968 clip_fraction 0.00134. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.727, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.628                    |
|    ep_rew_mean          | 0.727                    |
|    explained_variance   | 0.425                    |
|    len                  | 5.628 +/- 7.37 (68774)   |
|    len_d_1_pos          | 5.367 +/- 7.62 (25811)   |
|    len_d_2_pos          | 5.371 +/- 7.62 (2536)    |
|    len_d_3_pos          | 5.321 +/- 7.58 (2609)    |
|    len_d_4_pos          | 5.258 +/- 7.58 (1618)    |
|    len_d_unknown_neg    | 5.872 +/- 7.14 (36200)   |
|    len_neg              | 5.872 +/- 7.14 (36200)   |
|    len_pos              | 5.358 +/- 7.61 (32574)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (25811)   |
|    proven_d_2_pos       | 0.718 +/- 0.45 (2536)    |
|    proven_d_3_pos       | 0.724 +/- 0.45 (2609)    |
|    proven_d_4_pos       | 0.732 +/- 0.44 (1618)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (36200)   |
|    proven_neg           | 0.006 +/- 0.08 (36200)   |
|    proven_pos           | 0.719 +/- 0.45 (32574)   |
|    reward               | 0.727 +/- 0.69 (68774)   |
|    reward_d_1_pos       | 0.435 +/- 0.90 (25811)   |
|    reward_d_2_pos       | 0.437 +/- 0.90 (2536)    |
|    reward_d_3_pos       | 0.447 +/- 0.89 (2609)    |
|    reward_d_4_pos       | 0.464 +/- 0.89 (1618)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (36200)   |
|    reward_neg           | 0.987 +/- 0.16 (36200)   |
|    reward_pos           | 0.438 +/- 0.90 (32574)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 193                      |
|    time/fps             | 2185                     |
|    total_timesteps      | 393216                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.946, best=0.947 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.915                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.970                    |
|    MRR                  | 0.946                    |
|    len_d_-1_pos         | 12.500                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 7.972                    |
|    len_pos              | 8.370                    |
|    mrr_mean             | 0.946                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.007                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.007                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.36s. FPS: 24027.30
Epoch 1/5. 
Losses: total 0.13051, value 0.29960, policy 0.00022, entropy -0.00049, approx_kl 0.00084 clip_fraction 0.00076. 
Epoch 2/5. 
Losses: total 0.10004, value 0.26084, policy 0.00013, entropy -0.00042, approx_kl 0.00270 clip_fraction 0.00089. 
Epoch 3/5. 
Losses: total 0.06940, value 0.23226, policy 0.00007, entropy -0.00038, approx_kl 0.00416 clip_fraction 0.00097. 
Epoch 4/5. 
Losses: total 0.06987, value 0.20990, policy 0.00002, entropy -0.00038, approx_kl 0.00753 clip_fraction 0.00108. 
Epoch 5/5. 
Losses: total 0.05678, value 0.19214, policy -0.00003, entropy -0.00036, approx_kl 0.01064 clip_fraction 0.00118. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.727, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.627                    |
|    ep_rew_mean          | 0.727                    |
|    explained_variance   | 0.436                    |
|    len                  | 5.627 +/- 7.38 (74538)   |
|    len_d_1_pos          | 5.380 +/- 7.63 (27956)   |
|    len_d_2_pos          | 5.409 +/- 7.63 (2741)    |
|    len_d_3_pos          | 5.266 +/- 7.55 (2862)    |
|    len_d_4_pos          | 5.352 +/- 7.65 (1739)    |
|    len_d_unknown_neg    | 5.856 +/- 7.14 (39240)   |
|    len_neg              | 5.856 +/- 7.14 (39240)   |
|    len_pos              | 5.372 +/- 7.62 (35298)   |
|    proven_d_1_pos       | 0.717 +/- 0.45 (27956)   |
|    proven_d_2_pos       | 0.715 +/- 0.45 (2741)    |
|    proven_d_3_pos       | 0.726 +/- 0.45 (2862)    |
|    proven_d_4_pos       | 0.728 +/- 0.44 (1739)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (39240)   |
|    proven_neg           | 0.006 +/- 0.08 (39240)   |
|    proven_pos           | 0.718 +/- 0.45 (35298)   |
|    reward               | 0.727 +/- 0.69 (74538)   |
|    reward_d_1_pos       | 0.434 +/- 0.90 (27956)   |
|    reward_d_2_pos       | 0.431 +/- 0.90 (2741)    |
|    reward_d_3_pos       | 0.452 +/- 0.89 (2862)    |
|    reward_d_4_pos       | 0.456 +/- 0.89 (1739)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (39240)   |
|    reward_neg           | 0.988 +/- 0.16 (39240)   |
|    reward_pos           | 0.436 +/- 0.90 (35298)   |
|    success_rate         | 0.343                    |
|    time/elapsed         | 209                      |
|    time/fps             | 2012                     |
|    total_timesteps      | 425984                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.36s. FPS: 24045.85
Epoch 1/5. 
Losses: total 0.13167, value 0.31182, policy 0.00018, entropy -0.00057, approx_kl 0.00485 clip_fraction 0.00098. 
Epoch 2/5. 
Losses: total 0.12744, value 0.27907, policy 0.00011, entropy -0.00052, approx_kl 0.00597 clip_fraction 0.00107. 
Epoch 3/5. 
Losses: total 0.09359, value 0.25432, policy 0.00006, entropy -0.00049, approx_kl 0.00758 clip_fraction 0.00110. 
Epoch 4/5. 
Losses: total 0.08808, value 0.23380, policy 0.00003, entropy -0.00048, approx_kl 0.00904 clip_fraction 0.00111. 
Epoch 5/5. 
Losses: total 0.07137, value 0.21678, policy 0.00001, entropy -0.00046, approx_kl 0.00996 clip_fraction 0.00113. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.727, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.621                    |
|    ep_rew_mean          | 0.727                    |
|    explained_variance   | 0.424                    |
|    len                  | 5.621 +/- 7.38 (80388)   |
|    len_d_1_pos          | 5.375 +/- 7.63 (30169)   |
|    len_d_2_pos          | 5.418 +/- 7.64 (2935)    |
|    len_d_3_pos          | 5.208 +/- 7.51 (3086)    |
|    len_d_4_pos          | 5.356 +/- 7.67 (1871)    |
|    len_d_unknown_neg    | 5.852 +/- 7.14 (42327)   |
|    len_neg              | 5.852 +/- 7.14 (42327)   |
|    len_pos              | 5.364 +/- 7.62 (38061)   |
|    proven_d_1_pos       | 0.717 +/- 0.45 (30169)   |
|    proven_d_2_pos       | 0.716 +/- 0.45 (2935)    |
|    proven_d_3_pos       | 0.728 +/- 0.44 (3086)    |
|    proven_d_4_pos       | 0.730 +/- 0.44 (1871)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (42327)   |
|    proven_neg           | 0.006 +/- 0.08 (42327)   |
|    proven_pos           | 0.718 +/- 0.45 (38061)   |
|    reward               | 0.727 +/- 0.69 (80388)   |
|    reward_d_1_pos       | 0.433 +/- 0.90 (30169)   |
|    reward_d_2_pos       | 0.431 +/- 0.90 (2935)    |
|    reward_d_3_pos       | 0.456 +/- 0.89 (3086)    |
|    reward_d_4_pos       | 0.459 +/- 0.89 (1871)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (42327)   |
|    reward_neg           | 0.988 +/- 0.16 (42327)   |
|    reward_pos           | 0.436 +/- 0.90 (38061)   |
|    success_rate         | 0.343                    |
|    time/elapsed         | 224                      |
|    time/fps             | 2186                     |
|    total_timesteps      | 458752                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.37s. FPS: 23979.13
Epoch 1/5. 
Losses: total 0.15952, value 0.30054, policy 0.01607, entropy -0.00051, approx_kl 0.01500 clip_fraction 0.00089. 
Epoch 2/5. 
Losses: total 0.12436, value 0.27954, policy 0.00808, entropy -0.00048, approx_kl 0.01024 clip_fraction 0.00104. 
Epoch 3/5. 
Losses: total 0.12604, value 0.26237, policy 0.00543, entropy -0.00044, approx_kl 0.00912 clip_fraction 0.00106. 
Epoch 4/5. 
Losses: total 0.08378, value 0.24759, policy 0.00401, entropy -0.00042, approx_kl 0.00948 clip_fraction 0.00111. 
Epoch 5/5. 
Losses: total 0.09839, value 0.23466, policy 0.00314, entropy -0.00039, approx_kl 0.01132 clip_fraction 0.00117. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.728, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.605                    |
|    ep_rew_mean          | 0.728                    |
|    explained_variance   | 0.469                    |
|    len                  | 5.605 +/- 7.37 (86369)   |
|    len_d_1_pos          | 5.353 +/- 7.61 (32436)   |
|    len_d_2_pos          | 5.391 +/- 7.64 (3161)    |
|    len_d_3_pos          | 5.193 +/- 7.49 (3301)    |
|    len_d_4_pos          | 5.345 +/- 7.66 (2001)    |
|    len_d_unknown_neg    | 5.842 +/- 7.14 (45470)   |
|    len_neg              | 5.842 +/- 7.14 (45470)   |
|    len_pos              | 5.343 +/- 7.61 (40899)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (32436)   |
|    proven_d_2_pos       | 0.718 +/- 0.45 (3161)    |
|    proven_d_3_pos       | 0.728 +/- 0.44 (3301)    |
|    proven_d_4_pos       | 0.728 +/- 0.44 (2001)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (45470)   |
|    proven_neg           | 0.006 +/- 0.08 (45470)   |
|    proven_pos           | 0.719 +/- 0.45 (40899)   |
|    reward               | 0.728 +/- 0.69 (86369)   |
|    reward_d_1_pos       | 0.436 +/- 0.90 (32436)   |
|    reward_d_2_pos       | 0.437 +/- 0.90 (3161)    |
|    reward_d_3_pos       | 0.457 +/- 0.89 (3301)    |
|    reward_d_4_pos       | 0.456 +/- 0.89 (2001)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (45470)   |
|    reward_neg           | 0.988 +/- 0.16 (45470)   |
|    reward_pos           | 0.439 +/- 0.90 (40899)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 239                      |
|    time/fps             | 2184                     |
|    total_timesteps      | 491520                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt
[PPO] Rollout collected in 1.36s. FPS: 24056.27
Epoch 1/5. 
Losses: total 0.15317, value 0.32514, policy 0.00008, entropy -0.00046, approx_kl 0.00033 clip_fraction 0.00055. 
Epoch 2/5. 
Losses: total 0.15862, value 0.31659, policy 0.00004, entropy -0.00040, approx_kl 0.00130 clip_fraction 0.00061. 
Epoch 3/5. 
Losses: total 0.12962, value 0.30911, policy -0.00001, entropy -0.00040, approx_kl 0.00218 clip_fraction 0.00070. 
Epoch 4/5. 
Losses: total 0.14014, value 0.30233, policy -0.00004, entropy -0.00040, approx_kl 0.00252 clip_fraction 0.00076. 
Epoch 5/5. 
Losses: total 0.13012, value 0.29614, policy -0.00006, entropy -0.00039, approx_kl 0.00268 clip_fraction 0.00078. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.728, best=0.738 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.600                    |
|    ep_rew_mean          | 0.728                    |
|    explained_variance   | 0.444                    |
|    len                  | 5.600 +/- 7.37 (92220)   |
|    len_d_1_pos          | 5.357 +/- 7.62 (34606)   |
|    len_d_2_pos          | 5.364 +/- 7.61 (3381)    |
|    len_d_3_pos          | 5.188 +/- 7.49 (3534)    |
|    len_d_4_pos          | 5.259 +/- 7.61 (2142)    |
|    len_d_unknown_neg    | 5.835 +/- 7.14 (48557)   |
|    len_neg              | 5.835 +/- 7.14 (48557)   |
|    len_pos              | 5.339 +/- 7.61 (43663)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (34606)   |
|    proven_d_2_pos       | 0.720 +/- 0.45 (3381)    |
|    proven_d_3_pos       | 0.729 +/- 0.44 (3534)    |
|    proven_d_4_pos       | 0.732 +/- 0.44 (2142)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (48557)   |
|    proven_neg           | 0.006 +/- 0.08 (48557)   |
|    proven_pos           | 0.720 +/- 0.45 (43663)   |
|    reward               | 0.728 +/- 0.69 (92220)   |
|    reward_d_1_pos       | 0.436 +/- 0.90 (34606)   |
|    reward_d_2_pos       | 0.439 +/- 0.90 (3381)    |
|    reward_d_3_pos       | 0.457 +/- 0.89 (3534)    |
|    reward_d_4_pos       | 0.463 +/- 0.89 (2142)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (48557)   |
|    reward_neg           | 0.988 +/- 0.16 (48557)   |
|    reward_pos           | 0.439 +/- 0.90 (43663)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 254                      |
|    time/fps             | 2183                     |
|    total_timesteps      | 524288                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.940, best=0.947 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.970                    |
|    MRR                  | 0.940                    |
|    len_d_-1_pos         | 12.458                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 7.897                    |
|    len_pos              | 8.350                    |
|    mrr_mean             | 0.940                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.006                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.006                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_39_24.pt

[Checkpoint] Restoring best model at end of training...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_09_39_24.pt
Loaded best model info: {'metric': 'mrr_mean', 'best_value': 0.947002112865448, 'timesteps': 4, 'explained_variance': 0.7359532117843628}

[2.5/3] Training neural bridge on validation data...
[NeuralBridge] Training neural bridge on 100 queries...
[NeuralBridge] Training on 200 queries, 11 candidates each
  Epoch 10/100: loss=-0.8053, alpha=0.4316
  Epoch 20/100: loss=-0.8095, alpha=0.4133
  Epoch 30/100: loss=-0.8133, alpha=0.3954
  Epoch 40/100: loss=-0.8165, alpha=0.3779
  Epoch 50/100: loss=-0.8194, alpha=0.3608
  Epoch 60/100: loss=-0.8220, alpha=0.3442
  Epoch 70/100: loss=-0.8242, alpha=0.3282
  Epoch 80/100: loss=-0.8262, alpha=0.3128
  Epoch 90/100: loss=-0.8280, alpha=0.2982
  Epoch 100/100: loss=-0.8296, alpha=0.2843
[NeuralBridge] Trained alpha: 0.2843

[3/3] Running evaluation...

Results: MRR=0.8393, Hits@1=0.7900, Hits@3=0.8700, Hits@10=0.9290
Proven: pos=0.3740, neg=0.0124
Writing results to /home/castellanoontiv/Batched_Env/kge_experiments/runs/averaged_runs/experiments.csv

============================================================
All experiments completed!
============================================================


[6/10] Running: Neural Bridge (Per-Predicate)
==============================================
Grid search: 1 params, 1 experiments.

============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: wn18rr-250-128-torchrl
======================================================================
Training: wn18rr
Envs: 128, Steps: 256, Timesteps: 500000
Seed: 0
======================================================================

[1/3] Creating components...
[UnificationEngine] Capping max_fact_pairs from 34796 to 1000
[EnvOptimal] Compiled with mode=reduce-overhead, fullgraph=True

[2/3] Running training...
KGE Engine initialized with backend: pytorch (signature: torch_wn18rr_RotatE_1024_20260107_125531_s42)
Traceback (most recent call last):
  File "/home/castellanoontiv/Batched_Env/kge_experiments/runner_kge.py", line 380, in <module>
    run_wrapper(cfg)
    ~~~~~~~~~~~^^^^^
  File "/home/castellanoontiv/Batched_Env/kge_experiments/runner_kge.py", line 350, in run_wrapper
    results = run_experiment(config)
  File "/home/castellanoontiv/Batched_Env/kge_experiments/train.py", line 339, in run_experiment
    neural_bridge = create_neural_bridge(
        config=config,
        device=torch.device(config.device),
    )
  File "/home/castellanoontiv/Batched_Env/kge_experiments/kge_module/neural_bridge.py", line 532, in create_neural_bridge
    raise ValueError("n_predicates must be provided for per_predicate bridge")
ValueError: n_predicates must be provided for per_predicate bridge



==============================================
Starting KGE Integration Experiments
Dataset: wn18rr
Timesteps: 500000
Eval: 100 queries, 10 corruptions
Test: 500 queries, 100 corruptions
Started at: Thu Jan  8 09:55:26 AM CET 2026
==============================================

[6/10] Running: Neural Bridge (Per-Predicate)
==============================================
Grid search: 1 params, 1 experiments.

============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: wn18rr-250-128-torchrl
======================================================================
Training: wn18rr
Envs: 128, Steps: 256, Timesteps: 500000
Seed: 0
======================================================================

[1/3] Creating components...
[UnificationEngine] Capping max_fact_pairs from 34796 to 1000
[EnvOptimal] Compiled with mode=reduce-overhead, fullgraph=True

[2/3] Running training...
KGE Engine initialized with backend: pytorch (signature: torch_wn18rr_RotatE_1024_20260107_125531_s42)
[NeuralBridge] Created PerPredicateBridge with n_predicates=14, init_alpha=0.5
[PPO] Compiled ranking_step (double-buffered) with mode=default

[Checkpoint] Loading existing model at start of training (load_model=True)...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_09_39_24.pt

============================================================
Initial evaluation (untrained model)
============================================================
Building model and loading weights...
Weights loaded successfully.
[Eval] Took 8.11 seconds

[Ranking] MRR: current=0.942, best=0.942 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.980                    |
|    MRR                  | 0.942                    |
|    len_d_-1_pos         | 12.604                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.065                    |
|    len_pos              | 8.420                    |
|    mrr_mean             | 0.942                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.008                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.008                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

============================================================

[PPO] Rollout collected in 3.29s. FPS: 9953.28
Epoch 1/5. 
Losses: total 0.04326, value 0.10960, policy 0.00067, entropy -0.00052, approx_kl 0.01760 clip_fraction 0.00134. 
Epoch 2/5. 
Losses: total 0.02460, value 0.08928, policy 0.00057, entropy -0.00043, approx_kl 0.02329 clip_fraction 0.00143. 
Epoch 3/5. 
Losses: total 0.02716, value 0.07909, policy 0.00057, entropy -0.00039, approx_kl 0.03376 clip_fraction 0.00156. 
Epoch 4/5. 
Losses: total 0.02369, value 0.07303, policy 0.00056, entropy -0.00042, approx_kl 0.05041 clip_fraction 0.00181. 
Epoch 5/5. 
Losses: total 0.02236, value 0.06794, policy 0.00053, entropy -0.00040, approx_kl 0.05899 clip_fraction 0.00193. 
[PPO] Training completed in 14.23s
[Metrics] Reward (train): current=0.736, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.539                    |
|    ep_rew_mean          | 0.736                    |
|    explained_variance   | 0.771                    |
|    len                  | 5.539 +/- 7.31 (5701)    |
|    len_d_1_pos          | 5.084 +/- 7.41 (2177)    |
|    len_d_2_pos          | 5.267 +/- 7.42 (206)     |
|    len_d_3_pos          | 5.009 +/- 7.41 (232)     |
|    len_d_4_pos          | 5.402 +/- 7.58 (127)     |
|    len_d_unknown_neg    | 5.940 +/- 7.17 (2959)    |
|    len_neg              | 5.940 +/- 7.17 (2959)    |
|    len_pos              | 5.106 +/- 7.42 (2742)    |
|    proven_d_1_pos       | 0.735 +/- 0.44 (2177)    |
|    proven_d_2_pos       | 0.709 +/- 0.45 (206)     |
|    proven_d_3_pos       | 0.737 +/- 0.44 (232)     |
|    proven_d_4_pos       | 0.701 +/- 0.46 (127)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (2959)    |
|    proven_neg           | 0.006 +/- 0.08 (2959)    |
|    proven_pos           | 0.732 +/- 0.44 (2742)    |
|    reward               | 0.736 +/- 0.68 (5701)    |
|    reward_d_1_pos       | 0.470 +/- 0.88 (2177)    |
|    reward_d_2_pos       | 0.417 +/- 0.91 (206)     |
|    reward_d_3_pos       | 0.474 +/- 0.88 (232)     |
|    reward_d_4_pos       | 0.402 +/- 0.92 (127)     |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (2959)    |
|    reward_neg           | 0.989 +/- 0.15 (2959)    |
|    reward_pos           | 0.463 +/- 0.89 (2742)    |
|    success_rate         | 0.355                    |
|    time/elapsed         | 26                       |
|    time/fps             | 1244                     |
|    total_timesteps      | 32768                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.36s. FPS: 24148.11
Epoch 1/5. 
Losses: total 0.04302, value 0.11644, policy 0.00032, entropy -0.00040, approx_kl 0.01562 clip_fraction 0.00128. 
Epoch 2/5. 
Losses: total 0.03597, value 0.09287, policy 0.00024, entropy -0.00043, approx_kl 0.02179 clip_fraction 0.00169. 
Epoch 3/5. 
Losses: total 0.03899, value 0.08100, policy 0.00020, entropy -0.00044, approx_kl 0.04643 clip_fraction 0.00203. 
Epoch 4/5. 
Losses: total 0.02300, value 0.07369, policy 0.00016, entropy -0.00045, approx_kl 0.05881 clip_fraction 0.00227. 
Epoch 5/5. 
Losses: total 0.02198, value 0.06818, policy 0.00009, entropy -0.00042, approx_kl 0.06496 clip_fraction 0.00236. 
[PPO] Training completed in 13.33s
[Metrics] Reward (train): current=0.734, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.567                    |
|    ep_rew_mean          | 0.734                    |
|    explained_variance   | 0.753                    |
|    len                  | 5.567 +/- 7.33 (11480)   |
|    len_d_1_pos          | 5.213 +/- 7.51 (4351)    |
|    len_d_2_pos          | 4.926 +/- 7.30 (420)     |
|    len_d_3_pos          | 5.261 +/- 7.55 (444)     |
|    len_d_4_pos          | 5.004 +/- 7.26 (276)     |
|    len_d_unknown_neg    | 5.917 +/- 7.16 (5989)    |
|    len_neg              | 5.917 +/- 7.16 (5989)    |
|    len_pos              | 5.184 +/- 7.48 (5491)    |
|    proven_d_1_pos       | 0.729 +/- 0.44 (4351)    |
|    proven_d_2_pos       | 0.740 +/- 0.44 (420)     |
|    proven_d_3_pos       | 0.721 +/- 0.45 (444)     |
|    proven_d_4_pos       | 0.728 +/- 0.44 (276)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (5989)    |
|    proven_neg           | 0.007 +/- 0.08 (5989)    |
|    proven_pos           | 0.729 +/- 0.44 (5491)    |
|    reward               | 0.734 +/- 0.68 (11480)   |
|    reward_d_1_pos       | 0.459 +/- 0.89 (4351)    |
|    reward_d_2_pos       | 0.481 +/- 0.88 (420)     |
|    reward_d_3_pos       | 0.441 +/- 0.90 (444)     |
|    reward_d_4_pos       | 0.457 +/- 0.89 (276)     |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (5989)    |
|    reward_neg           | 0.986 +/- 0.17 (5989)    |
|    reward_pos           | 0.459 +/- 0.89 (5491)    |
|    success_rate         | 0.353                    |
|    time/elapsed         | 41                       |
|    time/fps             | 2218                     |
|    total_timesteps      | 65536                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.36s. FPS: 24073.27
Epoch 1/5. 
Losses: total 0.04264, value 0.12224, policy 0.00017, entropy -0.00047, approx_kl 0.00815 clip_fraction 0.00119. 
Epoch 2/5. 
Losses: total 0.04064, value 0.09731, policy 0.00044, entropy -0.00046, approx_kl 0.01998 clip_fraction 0.00165. 
Epoch 3/5. 
Losses: total 0.03180, value 0.08527, policy 0.00043, entropy -0.00045, approx_kl 0.03293 clip_fraction 0.00191. 
Epoch 4/5. 
Losses: total 0.02800, value 0.07711, policy 0.00032, entropy -0.00040, approx_kl 0.04017 clip_fraction 0.00194. 
Epoch 5/5. 
Losses: total 0.01995, value 0.07120, policy 0.00030, entropy -0.00038, approx_kl 0.04938 clip_fraction 0.00201. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.731, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.603                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.751                    |
|    len                  | 5.603 +/- 7.35 (17169)   |
|    len_d_1_pos          | 5.264 +/- 7.55 (6511)    |
|    len_d_2_pos          | 5.453 +/- 7.68 (611)     |
|    len_d_3_pos          | 5.117 +/- 7.49 (658)     |
|    len_d_4_pos          | 5.555 +/- 7.67 (393)     |
|    len_d_unknown_neg    | 5.895 +/- 7.15 (8996)    |
|    len_neg              | 5.895 +/- 7.15 (8996)    |
|    len_pos              | 5.280 +/- 7.56 (8173)    |
|    proven_d_1_pos       | 0.727 +/- 0.45 (6511)    |
|    proven_d_2_pos       | 0.718 +/- 0.45 (611)     |
|    proven_d_3_pos       | 0.734 +/- 0.44 (658)     |
|    proven_d_4_pos       | 0.702 +/- 0.46 (393)     |
|    proven_d_unknown_neg | 0.008 +/- 0.09 (8996)    |
|    proven_neg           | 0.008 +/- 0.09 (8996)    |
|    proven_pos           | 0.725 +/- 0.45 (8173)    |
|    reward               | 0.731 +/- 0.68 (17169)   |
|    reward_d_1_pos       | 0.453 +/- 0.89 (6511)    |
|    reward_d_2_pos       | 0.437 +/- 0.90 (611)     |
|    reward_d_3_pos       | 0.468 +/- 0.88 (658)     |
|    reward_d_4_pos       | 0.405 +/- 0.91 (393)     |
|    reward_d_unknown_neg | 0.985 +/- 0.17 (8996)    |
|    reward_neg           | 0.985 +/- 0.17 (8996)    |
|    reward_pos           | 0.451 +/- 0.89 (8173)    |
|    success_rate         | 0.349                    |
|    time/elapsed         | 55                       |
|    time/fps             | 2200                     |
|    total_timesteps      | 98304                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.36s. FPS: 24080.84
Epoch 1/5. 
Losses: total 0.04280, value 0.12773, policy 0.00047, entropy -0.00049, approx_kl 0.01510 clip_fraction 0.00165. 
Epoch 2/5. 
Losses: total 0.04350, value 0.10109, policy 0.00069, entropy -0.00045, approx_kl 0.02893 clip_fraction 0.00203. 
Epoch 3/5. 
Losses: total 0.03088, value 0.08779, policy 0.00063, entropy -0.00041, approx_kl 0.03641 clip_fraction 0.00212. 
Epoch 4/5. 
Losses: total 0.03525, value 0.07905, policy 0.00058, entropy -0.00038, approx_kl 0.04214 clip_fraction 0.00215. 
Epoch 5/5. 
Losses: total 0.02277, value 0.07295, policy 0.00053, entropy -0.00035, approx_kl 0.04733 clip_fraction 0.00217. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.732, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.604                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.735                    |
|    len                  | 5.604 +/- 7.35 (22926)   |
|    len_d_1_pos          | 5.247 +/- 7.54 (8703)    |
|    len_d_2_pos          | 5.449 +/- 7.68 (819)     |
|    len_d_3_pos          | 5.074 +/- 7.44 (879)     |
|    len_d_4_pos          | 5.648 +/- 7.74 (525)     |
|    len_d_unknown_neg    | 5.911 +/- 7.15 (12000)   |
|    len_neg              | 5.911 +/- 7.15 (12000)   |
|    len_pos              | 5.267 +/- 7.55 (10926)   |
|    proven_d_1_pos       | 0.728 +/- 0.44 (8703)    |
|    proven_d_2_pos       | 0.717 +/- 0.45 (819)     |
|    proven_d_3_pos       | 0.737 +/- 0.44 (879)     |
|    proven_d_4_pos       | 0.693 +/- 0.46 (525)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (12000)   |
|    proven_neg           | 0.007 +/- 0.08 (12000)   |
|    proven_pos           | 0.727 +/- 0.45 (10926)   |
|    reward               | 0.732 +/- 0.68 (22926)   |
|    reward_d_1_pos       | 0.457 +/- 0.89 (8703)    |
|    reward_d_2_pos       | 0.433 +/- 0.90 (819)     |
|    reward_d_3_pos       | 0.474 +/- 0.88 (879)     |
|    reward_d_4_pos       | 0.387 +/- 0.92 (525)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (12000)   |
|    reward_neg           | 0.987 +/- 0.16 (12000)   |
|    reward_pos           | 0.453 +/- 0.89 (10926)   |
|    success_rate         | 0.350                    |
|    time/elapsed         | 70                       |
|    time/fps             | 2199                     |
|    total_timesteps      | 131072                   |
----------------------------------------------------

[Eval] Took 1.32 seconds

[Ranking] MRR: current=0.955, best=0.955 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.925                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.985                    |
|    MRR                  | 0.955                    |
|    len_d_-1_pos         | 13.000                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.592                    |
|    len_pos              | 8.610                    |
|    mrr_mean             | 0.955                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.007                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.007                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] New best eval model saved to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_09_55_30.pt (mrr_mean=0.9545)
[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.36s. FPS: 24035.98
Epoch 1/5. 
Losses: total 0.08838, value 0.24033, policy 0.00028, entropy -0.00059, approx_kl 0.01480 clip_fraction 0.00168. 
Epoch 2/5. 
Losses: total 0.06153, value 0.18487, policy 0.00037, entropy -0.00057, approx_kl 0.04930 clip_fraction 0.00227. 
Epoch 3/5. 
Losses: total 0.04505, value 0.15480, policy 0.00034, entropy -0.00055, approx_kl 0.13666 clip_fraction 0.00319. 
Epoch 4/5. 
Losses: total 0.03627, value 0.13564, policy 0.00024, entropy -0.00056, approx_kl 0.15839 clip_fraction 0.00349. 
Epoch 5/5. 
Losses: total 0.03866, value 0.12210, policy 0.00019, entropy -0.00053, approx_kl 0.15419 clip_fraction 0.00345. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.644                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.478                    |
|    len                  | 5.644 +/- 7.38 (28518)   |
|    len_d_1_pos          | 5.300 +/- 7.57 (10802)   |
|    len_d_2_pos          | 5.402 +/- 7.66 (1035)    |
|    len_d_3_pos          | 5.210 +/- 7.53 (1093)    |
|    len_d_4_pos          | 5.460 +/- 7.65 (658)     |
|    len_d_unknown_neg    | 5.950 +/- 7.17 (14930)   |
|    len_neg              | 5.950 +/- 7.17 (14930)   |
|    len_pos              | 5.308 +/- 7.58 (13588)   |
|    proven_d_1_pos       | 0.726 +/- 0.45 (10802)   |
|    proven_d_2_pos       | 0.720 +/- 0.45 (1035)    |
|    proven_d_3_pos       | 0.729 +/- 0.44 (1093)    |
|    proven_d_4_pos       | 0.705 +/- 0.46 (658)     |
|    proven_d_unknown_neg | 0.007 +/- 0.09 (14930)   |
|    proven_neg           | 0.007 +/- 0.09 (14930)   |
|    proven_pos           | 0.725 +/- 0.45 (13588)   |
|    reward               | 0.730 +/- 0.68 (28518)   |
|    reward_d_1_pos       | 0.451 +/- 0.89 (10802)   |
|    reward_d_2_pos       | 0.440 +/- 0.90 (1035)    |
|    reward_d_3_pos       | 0.458 +/- 0.89 (1093)    |
|    reward_d_4_pos       | 0.410 +/- 0.91 (658)     |
|    reward_d_unknown_neg | 0.985 +/- 0.17 (14930)   |
|    reward_neg           | 0.985 +/- 0.17 (14930)   |
|    reward_pos           | 0.449 +/- 0.89 (13588)   |
|    success_rate         | 0.349                    |
|    time/elapsed         | 87                       |
|    time/fps             | 2015                     |
|    total_timesteps      | 163840                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.36s. FPS: 24072.40
Epoch 1/5. 
Losses: total 0.08291, value 0.24407, policy 0.00022, entropy -0.00041, approx_kl 0.00938 clip_fraction 0.00125. 
Epoch 2/5. 
Losses: total 0.06070, value 0.19084, policy 0.00024, entropy -0.00045, approx_kl 0.01842 clip_fraction 0.00143. 
Epoch 3/5. 
Losses: total 0.04221, value 0.16036, policy 0.00023, entropy -0.00042, approx_kl 0.02463 clip_fraction 0.00148. 
Epoch 4/5. 
Losses: total 0.04142, value 0.14062, policy 0.00018, entropy -0.00040, approx_kl 0.03475 clip_fraction 0.00160. 
Epoch 5/5. 
Losses: total 0.03740, value 0.12654, policy 0.00016, entropy -0.00039, approx_kl 0.04974 clip_fraction 0.00181. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.650                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.465                    |
|    len                  | 5.650 +/- 7.38 (34190)   |
|    len_d_1_pos          | 5.292 +/- 7.56 (12950)   |
|    len_d_2_pos          | 5.254 +/- 7.56 (1259)    |
|    len_d_3_pos          | 5.105 +/- 7.48 (1297)    |
|    len_d_4_pos          | 5.434 +/- 7.61 (785)     |
|    len_d_unknown_neg    | 5.987 +/- 7.19 (17899)   |
|    len_neg              | 5.987 +/- 7.19 (17899)   |
|    len_pos              | 5.281 +/- 7.56 (16291)   |
|    proven_d_1_pos       | 0.725 +/- 0.45 (12950)   |
|    proven_d_2_pos       | 0.726 +/- 0.45 (1259)    |
|    proven_d_3_pos       | 0.736 +/- 0.44 (1297)    |
|    proven_d_4_pos       | 0.706 +/- 0.46 (785)     |
|    proven_d_unknown_neg | 0.008 +/- 0.09 (17899)   |
|    proven_neg           | 0.008 +/- 0.09 (17899)   |
|    proven_pos           | 0.725 +/- 0.45 (16291)   |
|    reward               | 0.730 +/- 0.68 (34190)   |
|    reward_d_1_pos       | 0.450 +/- 0.89 (12950)   |
|    reward_d_2_pos       | 0.452 +/- 0.89 (1259)    |
|    reward_d_3_pos       | 0.471 +/- 0.88 (1297)    |
|    reward_d_4_pos       | 0.411 +/- 0.91 (785)     |
|    reward_d_unknown_neg | 0.985 +/- 0.17 (17899)   |
|    reward_neg           | 0.985 +/- 0.17 (17899)   |
|    reward_pos           | 0.450 +/- 0.89 (16291)   |
|    success_rate         | 0.349                    |
|    time/elapsed         | 102                      |
|    time/fps             | 2197                     |
|    total_timesteps      | 196608                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.36s. FPS: 24010.75
Epoch 1/5. 
Losses: total 0.09548, value 0.25507, policy 0.00024, entropy -0.00054, approx_kl 0.00633 clip_fraction 0.00113. 
Epoch 2/5. 
Losses: total 0.06595, value 0.19984, policy 0.00023, entropy -0.00052, approx_kl 0.01234 clip_fraction 0.00137. 
Epoch 3/5. 
Losses: total 0.05348, value 0.16691, policy 0.00019, entropy -0.00050, approx_kl 0.02197 clip_fraction 0.00162. 
Epoch 4/5. 
Losses: total 0.04375, value 0.14594, policy 0.00018, entropy -0.00050, approx_kl 0.03348 clip_fraction 0.00186. 
Epoch 5/5. 
Losses: total 0.03697, value 0.13116, policy 0.00016, entropy -0.00048, approx_kl 0.03948 clip_fraction 0.00194. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.655                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.453                    |
|    len                  | 5.655 +/- 7.38 (39898)   |
|    len_d_1_pos          | 5.322 +/- 7.59 (15088)   |
|    len_d_2_pos          | 5.304 +/- 7.60 (1463)    |
|    len_d_3_pos          | 5.145 +/- 7.51 (1510)    |
|    len_d_4_pos          | 5.336 +/- 7.59 (931)     |
|    len_d_unknown_neg    | 5.972 +/- 7.19 (20906)   |
|    len_neg              | 5.972 +/- 7.19 (20906)   |
|    len_pos              | 5.307 +/- 7.58 (18992)   |
|    proven_d_1_pos       | 0.724 +/- 0.45 (15088)   |
|    proven_d_2_pos       | 0.724 +/- 0.45 (1463)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (1510)    |
|    proven_d_4_pos       | 0.716 +/- 0.45 (931)     |
|    proven_d_unknown_neg | 0.007 +/- 0.09 (20906)   |
|    proven_neg           | 0.007 +/- 0.09 (20906)   |
|    proven_pos           | 0.724 +/- 0.45 (18992)   |
|    reward               | 0.730 +/- 0.68 (39898)   |
|    reward_d_1_pos       | 0.448 +/- 0.89 (15088)   |
|    reward_d_2_pos       | 0.448 +/- 0.89 (1463)    |
|    reward_d_3_pos       | 0.466 +/- 0.88 (1510)    |
|    reward_d_4_pos       | 0.433 +/- 0.90 (931)     |
|    reward_d_unknown_neg | 0.985 +/- 0.17 (20906)   |
|    reward_neg           | 0.985 +/- 0.17 (20906)   |
|    reward_pos           | 0.449 +/- 0.89 (18992)   |
|    success_rate         | 0.349                    |
|    time/elapsed         | 116                      |
|    time/fps             | 2195                     |
|    total_timesteps      | 229376                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.36s. FPS: 24012.69
Epoch 1/5. 
Losses: total 0.10165, value 0.25903, policy 0.00030, entropy -0.00055, approx_kl 0.00958 clip_fraction 0.00153. 
Epoch 2/5. 
Losses: total 0.06770, value 0.20632, policy 0.00017, entropy -0.00050, approx_kl 0.02790 clip_fraction 0.00175. 
Epoch 3/5. 
Losses: total 0.04853, value 0.17468, policy 0.00020, entropy -0.00047, approx_kl 0.04391 clip_fraction 0.00209. 
Epoch 4/5. 
Losses: total 0.05591, value 0.15394, policy 0.00018, entropy -0.00046, approx_kl 0.05338 clip_fraction 0.00220. 
Epoch 5/5. 
Losses: total 0.03586, value 0.13933, policy 0.00019, entropy -0.00043, approx_kl 0.05637 clip_fraction 0.00225. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.732, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.668                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.454                    |
|    len                  | 5.668 +/- 7.40 (45504)   |
|    len_d_1_pos          | 5.310 +/- 7.59 (17149)   |
|    len_d_2_pos          | 5.235 +/- 7.54 (1682)    |
|    len_d_3_pos          | 5.112 +/- 7.48 (1726)    |
|    len_d_4_pos          | 5.314 +/- 7.58 (1067)    |
|    len_d_unknown_neg    | 6.012 +/- 7.21 (23880)   |
|    len_neg              | 6.012 +/- 7.21 (23880)   |
|    len_pos              | 5.288 +/- 7.57 (21624)   |
|    proven_d_1_pos       | 0.725 +/- 0.45 (17149)   |
|    proven_d_2_pos       | 0.728 +/- 0.44 (1682)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (1726)    |
|    proven_d_4_pos       | 0.719 +/- 0.45 (1067)    |
|    proven_d_unknown_neg | 0.008 +/- 0.09 (23880)   |
|    proven_neg           | 0.008 +/- 0.09 (23880)   |
|    proven_pos           | 0.726 +/- 0.45 (21624)   |
|    reward               | 0.732 +/- 0.68 (45504)   |
|    reward_d_1_pos       | 0.450 +/- 0.89 (17149)   |
|    reward_d_2_pos       | 0.457 +/- 0.89 (1682)    |
|    reward_d_3_pos       | 0.469 +/- 0.88 (1726)    |
|    reward_d_4_pos       | 0.438 +/- 0.90 (1067)    |
|    reward_d_unknown_neg | 0.985 +/- 0.17 (23880)   |
|    reward_neg           | 0.985 +/- 0.17 (23880)   |
|    reward_pos           | 0.452 +/- 0.89 (21624)   |
|    success_rate         | 0.349                    |
|    time/elapsed         | 131                      |
|    time/fps             | 2194                     |
|    total_timesteps      | 262144                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.940, best=0.955 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.965                    |
|    MRR                  | 0.940                    |
|    len_d_-1_pos         | 13.250                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.576                    |
|    len_pos              | 8.730                    |
|    mrr_mean             | 0.940                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.007                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.007                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.36s. FPS: 24026.61
Epoch 1/5. 
Losses: total 0.10884, value 0.29722, policy 0.00037, entropy -0.00043, approx_kl 0.01404 clip_fraction 0.00128. 
Epoch 2/5. 
Losses: total 0.07555, value 0.24087, policy 0.00028, entropy -0.00037, approx_kl 0.02372 clip_fraction 0.00151. 
Epoch 3/5. 
Losses: total 0.06531, value 0.20483, policy 0.00022, entropy -0.00032, approx_kl 0.02829 clip_fraction 0.00165. 
Epoch 4/5. 
Losses: total 0.04821, value 0.17925, policy 0.00014, entropy -0.00030, approx_kl 0.03216 clip_fraction 0.00175. 
Epoch 5/5. 
Losses: total 0.05174, value 0.16081, policy 0.00011, entropy -0.00031, approx_kl 0.04058 clip_fraction 0.00191. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.729, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.690                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.393                    |
|    len                  | 5.690 +/- 7.41 (51015)   |
|    len_d_1_pos          | 5.374 +/- 7.63 (19188)   |
|    len_d_2_pos          | 5.290 +/- 7.59 (1881)    |
|    len_d_3_pos          | 5.127 +/- 7.49 (1958)    |
|    len_d_4_pos          | 5.357 +/- 7.61 (1183)    |
|    len_d_unknown_neg    | 6.000 +/- 7.21 (26805)   |
|    len_neg              | 6.000 +/- 7.21 (26805)   |
|    len_pos              | 5.346 +/- 7.61 (24210)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (19188)   |
|    proven_d_2_pos       | 0.726 +/- 0.45 (1881)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (1958)    |
|    proven_d_4_pos       | 0.718 +/- 0.45 (1183)    |
|    proven_d_unknown_neg | 0.007 +/- 0.09 (26805)   |
|    proven_neg           | 0.007 +/- 0.09 (26805)   |
|    proven_pos           | 0.723 +/- 0.45 (24210)   |
|    reward               | 0.729 +/- 0.68 (51015)   |
|    reward_d_1_pos       | 0.444 +/- 0.90 (19188)   |
|    reward_d_2_pos       | 0.451 +/- 0.89 (1881)    |
|    reward_d_3_pos       | 0.467 +/- 0.88 (1958)    |
|    reward_d_4_pos       | 0.435 +/- 0.90 (1183)    |
|    reward_d_unknown_neg | 0.985 +/- 0.17 (26805)   |
|    reward_neg           | 0.985 +/- 0.17 (26805)   |
|    reward_pos           | 0.446 +/- 0.89 (24210)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 148                      |
|    time/fps             | 2014                     |
|    total_timesteps      | 294912                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.36s. FPS: 24083.19
Epoch 1/5. 
Losses: total 0.11192, value 0.28057, policy 0.00023, entropy -0.00051, approx_kl 0.00260 clip_fraction 0.00119. 
Epoch 2/5. 
Losses: total 0.06620, value 0.22883, policy 0.00019, entropy -0.00050, approx_kl 0.01295 clip_fraction 0.00148. 
Epoch 3/5. 
Losses: total 0.06566, value 0.19589, policy 0.00014, entropy -0.00048, approx_kl 0.02050 clip_fraction 0.00166. 
Epoch 4/5. 
Losses: total 0.05435, value 0.17263, policy 0.00010, entropy -0.00049, approx_kl 0.02809 clip_fraction 0.00177. 
Epoch 5/5. 
Losses: total 0.04673, value 0.15576, policy 0.00008, entropy -0.00050, approx_kl 0.03259 clip_fraction 0.00186. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.729, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.723                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.403                    |
|    len                  | 5.723 +/- 7.44 (56384)   |
|    len_d_1_pos          | 5.401 +/- 7.65 (21152)   |
|    len_d_2_pos          | 5.316 +/- 7.62 (2090)    |
|    len_d_3_pos          | 5.197 +/- 7.54 (2178)    |
|    len_d_4_pos          | 5.316 +/- 7.60 (1315)    |
|    len_d_unknown_neg    | 6.037 +/- 7.24 (29649)   |
|    len_neg              | 6.037 +/- 7.24 (29649)   |
|    len_pos              | 5.374 +/- 7.63 (26735)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (21152)   |
|    proven_d_2_pos       | 0.725 +/- 0.45 (2090)    |
|    proven_d_3_pos       | 0.732 +/- 0.44 (2178)    |
|    proven_d_4_pos       | 0.722 +/- 0.45 (1315)    |
|    proven_d_unknown_neg | 0.007 +/- 0.09 (29649)   |
|    proven_neg           | 0.007 +/- 0.09 (29649)   |
|    proven_pos           | 0.722 +/- 0.45 (26735)   |
|    reward               | 0.729 +/- 0.68 (56384)   |
|    reward_d_1_pos       | 0.442 +/- 0.90 (21152)   |
|    reward_d_2_pos       | 0.451 +/- 0.89 (2090)    |
|    reward_d_3_pos       | 0.465 +/- 0.89 (2178)    |
|    reward_d_4_pos       | 0.445 +/- 0.90 (1315)    |
|    reward_d_unknown_neg | 0.985 +/- 0.17 (29649)   |
|    reward_neg           | 0.985 +/- 0.17 (29649)   |
|    reward_pos           | 0.444 +/- 0.90 (26735)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 163                      |
|    time/fps             | 2191                     |
|    total_timesteps      | 327680                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.37s. FPS: 23922.33
Epoch 1/5. 
Losses: total 0.11886, value 0.29385, policy 0.00028, entropy -0.00059, approx_kl 0.00629 clip_fraction 0.00119. 
Epoch 2/5. 
Losses: total 0.08551, value 0.24231, policy 0.00015, entropy -0.00063, approx_kl 0.01916 clip_fraction 0.00157. 
Epoch 3/5. 
Losses: total 0.07989, value 0.20878, policy 0.00011, entropy -0.00054, approx_kl 0.02023 clip_fraction 0.00161. 
Epoch 4/5. 
Losses: total 0.05277, value 0.18515, policy 0.00005, entropy -0.00052, approx_kl 0.02305 clip_fraction 0.00175. 
Epoch 5/5. 
Losses: total 0.04197, value 0.16769, policy 0.00003, entropy -0.00050, approx_kl 0.02848 clip_fraction 0.00195. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.725                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.395                    |
|    len                  | 5.725 +/- 7.44 (62040)   |
|    len_d_1_pos          | 5.392 +/- 7.64 (23278)   |
|    len_d_2_pos          | 5.308 +/- 7.61 (2288)    |
|    len_d_3_pos          | 5.216 +/- 7.55 (2393)    |
|    len_d_4_pos          | 5.396 +/- 7.65 (1441)    |
|    len_d_unknown_neg    | 6.043 +/- 7.24 (32640)   |
|    len_neg              | 6.043 +/- 7.24 (32640)   |
|    len_pos              | 5.372 +/- 7.63 (29400)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (23278)   |
|    proven_d_2_pos       | 0.726 +/- 0.45 (2288)    |
|    proven_d_3_pos       | 0.730 +/- 0.44 (2393)    |
|    proven_d_4_pos       | 0.716 +/- 0.45 (1441)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (32640)   |
|    proven_neg           | 0.007 +/- 0.08 (32640)   |
|    proven_pos           | 0.723 +/- 0.45 (29400)   |
|    reward               | 0.730 +/- 0.68 (62040)   |
|    reward_d_1_pos       | 0.444 +/- 0.90 (23278)   |
|    reward_d_2_pos       | 0.451 +/- 0.89 (2288)    |
|    reward_d_3_pos       | 0.461 +/- 0.89 (2393)    |
|    reward_d_4_pos       | 0.432 +/- 0.90 (1441)    |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (32640)   |
|    reward_neg           | 0.986 +/- 0.17 (32640)   |
|    reward_pos           | 0.445 +/- 0.90 (29400)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 178                      |
|    time/fps             | 2189                     |
|    total_timesteps      | 360448                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.37s. FPS: 23883.68
Epoch 1/5. 
Losses: total 0.12990, value 0.28978, policy 0.00047, entropy -0.00055, approx_kl 0.00336 clip_fraction 0.00089. 
Epoch 2/5. 
Losses: total 0.08164, value 0.24531, policy 0.00028, entropy -0.00057, approx_kl 0.00944 clip_fraction 0.00130. 
Epoch 3/5. 
Losses: total 0.07683, value 0.21460, policy 0.00020, entropy -0.00058, approx_kl 0.01501 clip_fraction 0.00155. 
Epoch 4/5. 
Losses: total 0.06493, value 0.19199, policy 0.00014, entropy -0.00054, approx_kl 0.01928 clip_fraction 0.00164. 
Epoch 5/5. 
Losses: total 0.05391, value 0.17481, policy 0.00008, entropy -0.00052, approx_kl 0.02215 clip_fraction 0.00172. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.731, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.730                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.404                    |
|    len                  | 5.730 +/- 7.44 (67599)   |
|    len_d_1_pos          | 5.381 +/- 7.64 (25343)   |
|    len_d_2_pos          | 5.365 +/- 7.64 (2474)    |
|    len_d_3_pos          | 5.225 +/- 7.55 (2613)    |
|    len_d_4_pos          | 5.322 +/- 7.60 (1579)    |
|    len_d_unknown_neg    | 6.060 +/- 7.25 (35590)   |
|    len_neg              | 6.060 +/- 7.25 (35590)   |
|    len_pos              | 5.364 +/- 7.63 (32009)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (25343)   |
|    proven_d_2_pos       | 0.722 +/- 0.45 (2474)    |
|    proven_d_3_pos       | 0.731 +/- 0.44 (2613)    |
|    proven_d_4_pos       | 0.722 +/- 0.45 (1579)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (35590)   |
|    proven_neg           | 0.007 +/- 0.08 (35590)   |
|    proven_pos           | 0.723 +/- 0.45 (32009)   |
|    reward               | 0.731 +/- 0.68 (67599)   |
|    reward_d_1_pos       | 0.446 +/- 0.90 (25343)   |
|    reward_d_2_pos       | 0.445 +/- 0.90 (2474)    |
|    reward_d_3_pos       | 0.463 +/- 0.89 (2613)    |
|    reward_d_4_pos       | 0.444 +/- 0.90 (1579)    |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (35590)   |
|    reward_neg           | 0.986 +/- 0.17 (35590)   |
|    reward_pos           | 0.447 +/- 0.89 (32009)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 193                      |
|    time/fps             | 2187                     |
|    total_timesteps      | 393216                   |
----------------------------------------------------

[Eval] Took 1.34 seconds

[Ranking] MRR: current=0.950, best=0.955 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.920                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.975                    |
|    MRR                  | 0.950                    |
|    len_d_-1_pos         | 12.896                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.298                    |
|    len_pos              | 8.560                    |
|    mrr_mean             | 0.950                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.010                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.010                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.37s. FPS: 23927.97
Epoch 1/5. 
Losses: total 0.14773, value 0.30090, policy 0.00002, entropy -0.00046, approx_kl 0.00179 clip_fraction 0.00082. 
Epoch 2/5. 
Losses: total 0.10038, value 0.26064, policy 0.00008, entropy -0.00043, approx_kl 0.00467 clip_fraction 0.00096. 
Epoch 3/5. 
Losses: total 0.08326, value 0.23150, policy 0.00004, entropy -0.00037, approx_kl 0.00869 clip_fraction 0.00105. 
Epoch 4/5. 
Losses: total 0.06865, value 0.20924, policy 0.00002, entropy -0.00033, approx_kl 0.01174 clip_fraction 0.00113. 
Epoch 5/5. 
Losses: total 0.05893, value 0.19176, policy -0.00002, entropy -0.00033, approx_kl 0.01394 clip_fraction 0.00120. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.730, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.737                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.423                    |
|    len                  | 5.737 +/- 7.45 (73168)   |
|    len_d_1_pos          | 5.402 +/- 7.65 (27385)   |
|    len_d_2_pos          | 5.344 +/- 7.61 (2689)    |
|    len_d_3_pos          | 5.159 +/- 7.51 (2867)    |
|    len_d_4_pos          | 5.396 +/- 7.65 (1689)    |
|    len_d_unknown_neg    | 6.060 +/- 7.26 (38538)   |
|    len_neg              | 6.060 +/- 7.26 (38538)   |
|    len_pos              | 5.377 +/- 7.64 (34630)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (27385)   |
|    proven_d_2_pos       | 0.723 +/- 0.45 (2689)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (2867)    |
|    proven_d_4_pos       | 0.718 +/- 0.45 (1689)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (38538)   |
|    proven_neg           | 0.007 +/- 0.08 (38538)   |
|    proven_pos           | 0.723 +/- 0.45 (34630)   |
|    reward               | 0.730 +/- 0.68 (73168)   |
|    reward_d_1_pos       | 0.443 +/- 0.90 (27385)   |
|    reward_d_2_pos       | 0.446 +/- 0.90 (2689)    |
|    reward_d_3_pos       | 0.470 +/- 0.88 (2867)    |
|    reward_d_4_pos       | 0.436 +/- 0.90 (1689)    |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (38538)   |
|    reward_neg           | 0.986 +/- 0.17 (38538)   |
|    reward_pos           | 0.445 +/- 0.90 (34630)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 209                      |
|    time/fps             | 2006                     |
|    total_timesteps      | 425984                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.36s. FPS: 24047.73
Epoch 1/5. 
Losses: total 0.13217, value 0.30241, policy 0.00030, entropy -0.00065, approx_kl 0.00235 clip_fraction 0.00095. 
Epoch 2/5. 
Losses: total 0.12438, value 0.27106, policy 0.00011, entropy -0.00053, approx_kl 0.00504 clip_fraction 0.00099. 
Epoch 3/5. 
Losses: total 0.09002, value 0.24674, policy -0.00001, entropy -0.00047, approx_kl 0.00649 clip_fraction 0.00104. 
Epoch 4/5. 
Losses: total 0.09066, value 0.22671, policy -0.00006, entropy -0.00043, approx_kl 0.00740 clip_fraction 0.00105. 
Epoch 5/5. 
Losses: total 0.07043, value 0.21030, policy -0.00010, entropy -0.00040, approx_kl 0.00882 clip_fraction 0.00111. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.729, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.743                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.448                    |
|    len                  | 5.743 +/- 7.46 (78712)   |
|    len_d_1_pos          | 5.420 +/- 7.67 (29478)   |
|    len_d_2_pos          | 5.356 +/- 7.62 (2884)    |
|    len_d_3_pos          | 5.184 +/- 7.53 (3070)    |
|    len_d_4_pos          | 5.420 +/- 7.68 (1816)    |
|    len_d_unknown_neg    | 6.055 +/- 7.26 (41464)   |
|    len_neg              | 6.055 +/- 7.26 (41464)   |
|    len_pos              | 5.395 +/- 7.65 (37248)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (29478)   |
|    proven_d_2_pos       | 0.722 +/- 0.45 (2884)    |
|    proven_d_3_pos       | 0.734 +/- 0.44 (3070)    |
|    proven_d_4_pos       | 0.719 +/- 0.45 (1816)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (41464)   |
|    proven_neg           | 0.007 +/- 0.08 (41464)   |
|    proven_pos           | 0.722 +/- 0.45 (37248)   |
|    reward               | 0.729 +/- 0.68 (78712)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (29478)   |
|    reward_d_2_pos       | 0.445 +/- 0.90 (2884)    |
|    reward_d_3_pos       | 0.468 +/- 0.88 (3070)    |
|    reward_d_4_pos       | 0.438 +/- 0.90 (1816)    |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (41464)   |
|    reward_neg           | 0.986 +/- 0.17 (41464)   |
|    reward_pos           | 0.444 +/- 0.90 (37248)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 224                      |
|    time/fps             | 2186                     |
|    total_timesteps      | 458752                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.36s. FPS: 24012.63
Epoch 1/5. 
Losses: total 0.15109, value 0.30339, policy 0.00000, entropy -0.00056, approx_kl 0.00035 clip_fraction 0.00052. 
Epoch 2/5. 
Losses: total 0.13830, value 0.28223, policy -0.00005, entropy -0.00051, approx_kl 0.00144 clip_fraction 0.00066. 
Epoch 3/5. 
Losses: total 0.11210, value 0.26464, policy -0.00009, entropy -0.00049, approx_kl 0.00192 clip_fraction 0.00071. 
Epoch 4/5. 
Losses: total 0.10024, value 0.24970, policy -0.00010, entropy -0.00048, approx_kl 0.00252 clip_fraction 0.00078. 
Epoch 5/5. 
Losses: total 0.09730, value 0.23707, policy -0.00012, entropy -0.00048, approx_kl 0.00324 clip_fraction 0.00085. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.730, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.733                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.464                    |
|    len                  | 5.733 +/- 7.45 (84504)   |
|    len_d_1_pos          | 5.402 +/- 7.66 (31670)   |
|    len_d_2_pos          | 5.354 +/- 7.63 (3097)    |
|    len_d_3_pos          | 5.184 +/- 7.52 (3288)    |
|    len_d_4_pos          | 5.405 +/- 7.67 (1955)    |
|    len_d_unknown_neg    | 6.050 +/- 7.26 (44494)   |
|    len_neg              | 6.050 +/- 7.26 (44494)   |
|    len_pos              | 5.381 +/- 7.64 (40010)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (31670)   |
|    proven_d_2_pos       | 0.723 +/- 0.45 (3097)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (3288)    |
|    proven_d_4_pos       | 0.719 +/- 0.45 (1955)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (44494)   |
|    proven_neg           | 0.007 +/- 0.08 (44494)   |
|    proven_pos           | 0.722 +/- 0.45 (40010)   |
|    reward               | 0.730 +/- 0.68 (84504)   |
|    reward_d_1_pos       | 0.443 +/- 0.90 (31670)   |
|    reward_d_2_pos       | 0.446 +/- 0.90 (3097)    |
|    reward_d_3_pos       | 0.466 +/- 0.88 (3288)    |
|    reward_d_4_pos       | 0.437 +/- 0.90 (1955)    |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (44494)   |
|    reward_neg           | 0.986 +/- 0.17 (44494)   |
|    reward_pos           | 0.445 +/- 0.90 (40010)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 239                      |
|    time/fps             | 2184                     |
|    total_timesteps      | 491520                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt
[PPO] Rollout collected in 1.38s. FPS: 23821.75
Epoch 1/5. 
Losses: total 0.15206, value 0.31494, policy 0.00004, entropy -0.00039, approx_kl 0.00010 clip_fraction 0.00037. 
Epoch 2/5. 
Losses: total 0.13588, value 0.30599, policy -0.00004, entropy -0.00035, approx_kl 0.00089 clip_fraction 0.00043. 
Epoch 3/5. 
Losses: total 0.13132, value 0.29807, policy -0.00008, entropy -0.00035, approx_kl 0.00162 clip_fraction 0.00050. 
Epoch 4/5. 
Losses: total 0.13032, value 0.29083, policy -0.00009, entropy -0.00034, approx_kl 0.00216 clip_fraction 0.00055. 
Epoch 5/5. 
Losses: total 0.11107, value 0.28415, policy -0.00011, entropy -0.00033, approx_kl 0.00259 clip_fraction 0.00060. 
[PPO] Training completed in 13.43s
[Metrics] Reward (train): current=0.731, best=0.736 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.725                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.453                    |
|    len                  | 5.725 +/- 7.45 (90269)   |
|    len_d_1_pos          | 5.399 +/- 7.66 (33843)   |
|    len_d_2_pos          | 5.304 +/- 7.60 (3317)    |
|    len_d_3_pos          | 5.174 +/- 7.52 (3516)    |
|    len_d_4_pos          | 5.319 +/- 7.62 (2087)    |
|    len_d_unknown_neg    | 6.046 +/- 7.26 (47506)   |
|    len_neg              | 6.046 +/- 7.26 (47506)   |
|    len_pos              | 5.369 +/- 7.64 (42763)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (33843)   |
|    proven_d_2_pos       | 0.725 +/- 0.45 (3317)    |
|    proven_d_3_pos       | 0.734 +/- 0.44 (3516)    |
|    proven_d_4_pos       | 0.723 +/- 0.45 (2087)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (47506)   |
|    proven_neg           | 0.007 +/- 0.08 (47506)   |
|    proven_pos           | 0.724 +/- 0.45 (42763)   |
|    reward               | 0.731 +/- 0.68 (90269)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (33843)   |
|    reward_d_2_pos       | 0.451 +/- 0.89 (3317)    |
|    reward_d_3_pos       | 0.469 +/- 0.88 (3516)    |
|    reward_d_4_pos       | 0.446 +/- 0.89 (2087)    |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (47506)   |
|    reward_neg           | 0.986 +/- 0.17 (47506)   |
|    reward_pos           | 0.447 +/- 0.89 (42763)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 254                      |
|    time/fps             | 2181                     |
|    total_timesteps      | 524288                   |
----------------------------------------------------

[Eval] Took 1.35 seconds

[Ranking] MRR: current=0.948, best=0.955 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.920                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.970                    |
|    MRR                  | 0.948                    |
|    len_d_-1_pos         | 13.188                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.326                    |
|    len_pos              | 8.700                    |
|    mrr_mean             | 0.948                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.010                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.010                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_09_55_30.pt

[Checkpoint] Restoring best model at end of training...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_09_55_30.pt
Loaded best model info: {'metric': 'mrr_mean', 'best_value': 0.9545021653175354, 'timesteps': 4, 'explained_variance': 0.7353330254554749}

[2.5/3] Training neural bridge on validation data...
[NeuralBridge] Training neural bridge on 100 queries...
[NeuralBridge] Training on 200 queries, 11 candidates each
  Epoch 10/100: loss=-0.6637
  Epoch 20/100: loss=-0.6833
  Epoch 30/100: loss=-0.7007
  Epoch 40/100: loss=-0.7157
  Epoch 50/100: loss=-0.7287
  Epoch 60/100: loss=-0.7399
  Epoch 70/100: loss=-0.7496
  Epoch 80/100: loss=-0.7580
  Epoch 90/100: loss=-0.7652
  Epoch 100/100: loss=-0.7716

[3/3] Running evaluation...

Results: MRR=0.8417, Hits@1=0.7920, Hits@3=0.8750, Hits@10=0.9330
Proven: pos=0.3710, neg=0.0124
Writing results to /home/castellanoontiv/Batched_Env/kge_experiments/runs/averaged_runs/experiments.csv

============================================================
All experiments completed!
============================================================


[7/10] Running: PBRS (beta=0.1)
==============================================
Grid search: 1 params, 1 experiments.

============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: wn18rr-250-128-torchrl
======================================================================
Training: wn18rr
Envs: 128, Steps: 256, Timesteps: 500000
Seed: 0
======================================================================

[1/3] Creating components...
[UnificationEngine] Capping max_fact_pairs from 34796 to 1000
[EnvOptimal] Compiled with mode=reduce-overhead, fullgraph=True

[2/3] Running training...
KGE Engine initialized with backend: pytorch (signature: torch_wn18rr_RotatE_1024_20260107_125531_s42)
[PBRS] Loaded 10637 precomputed potentials
[PBRS] Enabled with beta=0.1, gamma=0.99
[PPO] Compiled ranking_step (double-buffered) with mode=default

[Checkpoint] Loading existing model at start of training (load_model=True)...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_09_55_30.pt

============================================================
Initial evaluation (untrained model)
============================================================
Building model and loading weights...
Weights loaded successfully.
[Eval] Took 8.15 seconds

[Ranking] MRR: current=0.942, best=0.942 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.980                    |
|    MRR                  | 0.942                    |
|    len_d_-1_pos         | 13.000                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.455                    |
|    len_pos              | 8.610                    |
|    mrr_mean             | 0.942                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

============================================================

[PPO] Rollout collected in 4.78s. FPS: 6848.21
Epoch 1/5. 
Losses: total 0.04238, value 0.10553, policy 0.00083, entropy -0.00048, approx_kl 0.01472 clip_fraction 0.00150. 
Epoch 2/5. 
Losses: total 0.02535, value 0.08612, policy 0.00052, entropy -0.00049, approx_kl 0.06956 clip_fraction 0.00273. 
Epoch 3/5. 
Losses: total 0.03587, value 0.07526, policy 0.00039, entropy -0.00048, approx_kl 0.08722 clip_fraction 0.00295. 
Epoch 4/5. 
Losses: total 0.02383, value 0.06859, policy 0.00028, entropy -0.00043, approx_kl 0.09337 clip_fraction 0.00304. 
Epoch 5/5. 
Losses: total 0.01573, value 0.06394, policy 0.00019, entropy -0.00042, approx_kl 0.09756 clip_fraction 0.00308. 
[PPO] Training completed in 14.27s
[Metrics] Reward (train): current=0.735, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.547                    |
|    ep_rew_mean          | 0.735                    |
|    explained_variance   | 0.779                    |
|    len                  | 5.547 +/- 7.30 (5674)    |
|    len_d_1_pos          | 5.191 +/- 7.49 (2153)    |
|    len_d_2_pos          | 5.425 +/- 7.50 (200)     |
|    len_d_3_pos          | 5.542 +/- 7.72 (216)     |
|    len_d_4_pos          | 5.284 +/- 7.55 (134)     |
|    len_d_unknown_neg    | 5.825 +/- 7.10 (2971)    |
|    len_neg              | 5.825 +/- 7.10 (2971)    |
|    len_pos              | 5.241 +/- 7.51 (2703)    |
|    proven_d_1_pos       | 0.732 +/- 0.44 (2153)    |
|    proven_d_2_pos       | 0.710 +/- 0.45 (200)     |
|    proven_d_3_pos       | 0.708 +/- 0.45 (216)     |
|    proven_d_4_pos       | 0.724 +/- 0.45 (134)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (2971)    |
|    proven_neg           | 0.006 +/- 0.08 (2971)    |
|    proven_pos           | 0.728 +/- 0.44 (2703)    |
|    reward               | 0.735 +/- 0.68 (5674)    |
|    reward_d_1_pos       | 0.465 +/- 0.89 (2153)    |
|    reward_d_2_pos       | 0.420 +/- 0.91 (200)     |
|    reward_d_3_pos       | 0.417 +/- 0.91 (216)     |
|    reward_d_4_pos       | 0.448 +/- 0.89 (134)     |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (2971)    |
|    reward_neg           | 0.988 +/- 0.16 (2971)    |
|    reward_pos           | 0.457 +/- 0.89 (2703)    |
|    success_rate         | 0.350                    |
|    time/elapsed         | 27                       |
|    time/fps             | 1173                     |
|    total_timesteps      | 32768                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.83s. FPS: 11566.80
Epoch 1/5. 
Losses: total 0.03459, value 0.11378, policy 0.00079, entropy -0.00072, approx_kl 0.02435 clip_fraction 0.00214. 
Epoch 2/5. 
Losses: total 0.03705, value 0.09091, policy 0.00062, entropy -0.00064, approx_kl 0.05077 clip_fraction 0.00259. 
Epoch 3/5. 
Losses: total 0.02802, value 0.07888, policy 0.00051, entropy -0.00062, approx_kl 0.06891 clip_fraction 0.00292. 
Epoch 4/5. 
Losses: total 0.02204, value 0.07133, policy 0.00051, entropy -0.00059, approx_kl 0.09718 clip_fraction 0.00318. 
Epoch 5/5. 
Losses: total 0.01836, value 0.06566, policy 0.00053, entropy -0.00057, approx_kl 0.11805 clip_fraction 0.00339. 
[PPO] Training completed in 13.33s
[Metrics] Reward (train): current=0.735, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.591                    |
|    ep_rew_mean          | 0.735                    |
|    explained_variance   | 0.772                    |
|    len                  | 5.591 +/- 7.34 (11403)   |
|    len_d_1_pos          | 5.368 +/- 7.63 (4286)    |
|    len_d_2_pos          | 4.835 +/- 7.21 (417)     |
|    len_d_3_pos          | 5.253 +/- 7.55 (435)     |
|    len_d_4_pos          | 4.923 +/- 7.25 (284)     |
|    len_d_unknown_neg    | 5.860 +/- 7.12 (5981)    |
|    len_neg              | 5.860 +/- 7.12 (5981)    |
|    len_pos              | 5.295 +/- 7.57 (5422)    |
|    proven_d_1_pos       | 0.724 +/- 0.45 (4286)    |
|    proven_d_2_pos       | 0.746 +/- 0.44 (417)     |
|    proven_d_3_pos       | 0.733 +/- 0.44 (435)     |
|    proven_d_4_pos       | 0.746 +/- 0.44 (284)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (5981)    |
|    proven_neg           | 0.006 +/- 0.08 (5981)    |
|    proven_pos           | 0.728 +/- 0.45 (5422)    |
|    reward               | 0.735 +/- 0.68 (11403)   |
|    reward_d_1_pos       | 0.448 +/- 0.89 (4286)    |
|    reward_d_2_pos       | 0.492 +/- 0.87 (417)     |
|    reward_d_3_pos       | 0.467 +/- 0.88 (435)     |
|    reward_d_4_pos       | 0.493 +/- 0.87 (284)     |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (5981)    |
|    reward_neg           | 0.988 +/- 0.15 (5981)    |
|    reward_pos           | 0.456 +/- 0.89 (5422)    |
|    success_rate         | 0.349                    |
|    time/elapsed         | 44                       |
|    time/fps             | 2018                     |
|    total_timesteps      | 65536                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.89s. FPS: 11349.36
Epoch 1/5. 
Losses: total 0.05380, value 0.14651, policy 0.00070, entropy -0.00064, approx_kl 0.02292 clip_fraction 0.00214. 
Epoch 2/5. 
Losses: total 0.04099, value 0.11550, policy 0.00055, entropy -0.00053, approx_kl 0.04338 clip_fraction 0.00241. 
Epoch 3/5. 
Losses: total 0.03714, value 0.09914, policy 0.00048, entropy -0.00050, approx_kl 0.05931 clip_fraction 0.00255. 
Epoch 4/5. 
Losses: total 0.03620, value 0.08858, policy 0.00048, entropy -0.00051, approx_kl 0.06799 clip_fraction 0.00269. 
Epoch 5/5. 
Losses: total 0.02389, value 0.08130, policy 0.00043, entropy -0.00052, approx_kl 0.07612 clip_fraction 0.00284. 
[PPO] Training completed in 13.33s
[Metrics] Reward (train): current=0.730, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.646                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.722                    |
|    len                  | 5.646 +/- 7.37 (17026)   |
|    len_d_1_pos          | 5.401 +/- 7.65 (6443)    |
|    len_d_2_pos          | 5.284 +/- 7.56 (616)     |
|    len_d_3_pos          | 5.468 +/- 7.71 (639)     |
|    len_d_4_pos          | 5.498 +/- 7.65 (402)     |
|    len_d_unknown_neg    | 5.866 +/- 7.11 (8926)    |
|    len_neg              | 5.866 +/- 7.11 (8926)    |
|    len_pos              | 5.402 +/- 7.64 (8100)    |
|    proven_d_1_pos       | 0.722 +/- 0.45 (6443)    |
|    proven_d_2_pos       | 0.737 +/- 0.44 (616)     |
|    proven_d_3_pos       | 0.728 +/- 0.45 (639)     |
|    proven_d_4_pos       | 0.714 +/- 0.45 (402)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (8926)    |
|    proven_neg           | 0.007 +/- 0.08 (8926)    |
|    proven_pos           | 0.723 +/- 0.45 (8100)    |
|    reward               | 0.730 +/- 0.68 (17026)   |
|    reward_d_1_pos       | 0.444 +/- 0.90 (6443)    |
|    reward_d_2_pos       | 0.474 +/- 0.88 (616)     |
|    reward_d_3_pos       | 0.455 +/- 0.89 (639)     |
|    reward_d_4_pos       | 0.428 +/- 0.90 (402)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (8926)    |
|    reward_neg           | 0.987 +/- 0.16 (8926)    |
|    reward_pos           | 0.446 +/- 0.89 (8100)    |
|    success_rate         | 0.348                    |
|    time/elapsed         | 60                       |
|    time/fps             | 2007                     |
|    total_timesteps      | 98304                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.83s. FPS: 11571.16
Epoch 1/5. 
Losses: total 0.04597, value 0.14645, policy 0.00043, entropy -0.00073, approx_kl 0.02410 clip_fraction 0.00250. 
Epoch 2/5. 
Losses: total 0.04187, value 0.11589, policy 0.00056, entropy -0.00070, approx_kl 0.03872 clip_fraction 0.00270. 
Epoch 3/5. 
Losses: total 0.03103, value 0.09997, policy 0.00052, entropy -0.00069, approx_kl 0.06203 clip_fraction 0.00298. 
Epoch 4/5. 
Losses: total 0.02569, value 0.09031, policy 0.00051, entropy -0.00067, approx_kl 0.08709 clip_fraction 0.00331. 
Epoch 5/5. 
Losses: total 0.03296, value 0.08325, policy 0.00047, entropy -0.00062, approx_kl 0.09822 clip_fraction 0.00344. 
[PPO] Training completed in 13.33s
[Metrics] Reward (train): current=0.729, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.678                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.704                    |
|    len                  | 5.678 +/- 7.39 (22637)   |
|    len_d_1_pos          | 5.394 +/- 7.64 (8581)    |
|    len_d_2_pos          | 5.435 +/- 7.69 (796)     |
|    len_d_3_pos          | 5.473 +/- 7.72 (848)     |
|    len_d_4_pos          | 5.562 +/- 7.69 (541)     |
|    len_d_unknown_neg    | 5.919 +/- 7.14 (11871)   |
|    len_neg              | 5.919 +/- 7.14 (11871)   |
|    len_pos              | 5.412 +/- 7.65 (10766)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (8581)    |
|    proven_d_2_pos       | 0.730 +/- 0.44 (796)     |
|    proven_d_3_pos       | 0.730 +/- 0.44 (848)     |
|    proven_d_4_pos       | 0.706 +/- 0.46 (541)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (11871)   |
|    proven_neg           | 0.007 +/- 0.08 (11871)   |
|    proven_pos           | 0.723 +/- 0.45 (10766)   |
|    reward               | 0.729 +/- 0.68 (22637)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (8581)    |
|    reward_d_2_pos       | 0.460 +/- 0.89 (796)     |
|    reward_d_3_pos       | 0.460 +/- 0.89 (848)     |
|    reward_d_4_pos       | 0.412 +/- 0.91 (541)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (11871)   |
|    reward_neg           | 0.987 +/- 0.16 (11871)   |
|    reward_pos           | 0.445 +/- 0.90 (10766)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 76                       |
|    time/fps             | 2013                     |
|    total_timesteps      | 131072                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.952, best=0.952 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.920                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.985                    |
|    MRR                  | 0.952                    |
|    len_d_-1_pos         | 14.396                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.860                    |
|    len_pos              | 9.280                    |
|    mrr_mean             | 0.952                    |
|    proven_d_-1_pos      | 0.000                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.005                    |
|    proven_pos           | 0.410                    |
|    reward_d_-1_pos      | 0.000                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.005                    |
|    reward_label_pos     | 0.410                    |
----------------------------------------------------

[Checkpoint] New best eval model saved to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_10_00_48.pt (mrr_mean=0.9520)
[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.85s. FPS: 11500.80
Epoch 1/5. 
Losses: total 0.08297, value 0.24620, policy 0.00075, entropy -0.00065, approx_kl 0.01600 clip_fraction 0.00262. 
Epoch 2/5. 
Losses: total 0.06351, value 0.19125, policy 0.00071, entropy -0.00059, approx_kl 0.02560 clip_fraction 0.00266. 
Epoch 3/5. 
Losses: total 0.05244, value 0.16065, policy 0.00065, entropy -0.00062, approx_kl 0.03448 clip_fraction 0.00289. 
Epoch 4/5. 
Losses: total 0.03803, value 0.14071, policy 0.00054, entropy -0.00059, approx_kl 0.07602 clip_fraction 0.00346. 
Epoch 5/5. 
Losses: total 0.03829, value 0.12639, policy 0.00038, entropy -0.00061, approx_kl 0.09354 clip_fraction 0.00363. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.728, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.714                    |
|    ep_rew_mean          | 0.728                    |
|    explained_variance   | 0.462                    |
|    len                  | 5.714 +/- 7.41 (28180)   |
|    len_d_1_pos          | 5.444 +/- 7.67 (10646)   |
|    len_d_2_pos          | 5.174 +/- 7.52 (1029)    |
|    len_d_3_pos          | 5.435 +/- 7.68 (1058)    |
|    len_d_4_pos          | 5.595 +/- 7.75 (660)     |
|    len_d_unknown_neg    | 5.972 +/- 7.17 (14787)   |
|    len_neg              | 5.972 +/- 7.17 (14787)   |
|    len_pos              | 5.430 +/- 7.66 (13393)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (10646)   |
|    proven_d_2_pos       | 0.741 +/- 0.44 (1029)    |
|    proven_d_3_pos       | 0.727 +/- 0.45 (1058)    |
|    proven_d_4_pos       | 0.711 +/- 0.45 (660)     |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (14787)   |
|    proven_neg           | 0.007 +/- 0.08 (14787)   |
|    proven_pos           | 0.721 +/- 0.45 (13393)   |
|    reward               | 0.728 +/- 0.69 (28180)   |
|    reward_d_1_pos       | 0.439 +/- 0.90 (10646)   |
|    reward_d_2_pos       | 0.483 +/- 0.88 (1029)    |
|    reward_d_3_pos       | 0.454 +/- 0.89 (1058)    |
|    reward_d_4_pos       | 0.421 +/- 0.91 (660)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (14787)   |
|    reward_neg           | 0.987 +/- 0.16 (14787)   |
|    reward_pos           | 0.443 +/- 0.90 (13393)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 94                       |
|    time/fps             | 1846                     |
|    total_timesteps      | 163840                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.85s. FPS: 11515.27
Epoch 1/5. 
Losses: total 0.09404, value 0.24047, policy 0.00064, entropy -0.00090, approx_kl 0.01585 clip_fraction 0.00244. 
Epoch 2/5. 
Losses: total 0.05351, value 0.18859, policy 0.00055, entropy -0.00087, approx_kl 0.03507 clip_fraction 0.00282. 
Epoch 3/5. 
Losses: total 0.05084, value 0.15892, policy 0.00050, entropy -0.00079, approx_kl 0.04502 clip_fraction 0.00300. 
Epoch 4/5. 
Losses: total 0.04479, value 0.13998, policy 0.00050, entropy -0.00074, approx_kl 0.05280 clip_fraction 0.00306. 
Epoch 5/5. 
Losses: total 0.03592, value 0.12626, policy 0.00047, entropy -0.00072, approx_kl 0.06012 clip_fraction 0.00315. 
[PPO] Training completed in 13.33s
[Metrics] Reward (train): current=0.730, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.705                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.487                    |
|    len                  | 5.705 +/- 7.40 (33873)   |
|    len_d_1_pos          | 5.431 +/- 7.65 (12779)   |
|    len_d_2_pos          | 5.234 +/- 7.57 (1237)    |
|    len_d_3_pos          | 5.095 +/- 7.46 (1273)    |
|    len_d_4_pos          | 5.383 +/- 7.60 (800)     |
|    len_d_unknown_neg    | 5.992 +/- 7.17 (17784)   |
|    len_neg              | 5.992 +/- 7.17 (17784)   |
|    len_pos              | 5.387 +/- 7.63 (16089)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (12779)   |
|    proven_d_2_pos       | 0.740 +/- 0.44 (1237)    |
|    proven_d_3_pos       | 0.745 +/- 0.44 (1273)    |
|    proven_d_4_pos       | 0.724 +/- 0.45 (800)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (17784)   |
|    proven_neg           | 0.006 +/- 0.08 (17784)   |
|    proven_pos           | 0.723 +/- 0.45 (16089)   |
|    reward               | 0.730 +/- 0.68 (33873)   |
|    reward_d_1_pos       | 0.438 +/- 0.90 (12779)   |
|    reward_d_2_pos       | 0.479 +/- 0.88 (1237)    |
|    reward_d_3_pos       | 0.491 +/- 0.87 (1273)    |
|    reward_d_4_pos       | 0.448 +/- 0.89 (800)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (17784)   |
|    reward_neg           | 0.987 +/- 0.16 (17784)   |
|    reward_pos           | 0.446 +/- 0.90 (16089)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 110                      |
|    time/fps             | 2009                     |
|    total_timesteps      | 196608                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.85s. FPS: 11499.85
Epoch 1/5. 
Losses: total 0.10085, value 0.26140, policy 0.00106, entropy -0.00082, approx_kl 0.01675 clip_fraction 0.00232. 
Epoch 2/5. 
Losses: total 0.06931, value 0.20520, policy 0.00085, entropy -0.00074, approx_kl 0.02768 clip_fraction 0.00298. 
Epoch 3/5. 
Losses: total 0.05153, value 0.17198, policy 0.00073, entropy -0.00075, approx_kl 0.05411 clip_fraction 0.00359. 
Epoch 4/5. 
Losses: total 0.03972, value 0.15090, policy 0.00065, entropy -0.00065, approx_kl 0.06972 clip_fraction 0.00388. 
Epoch 5/5. 
Losses: total 0.04158, value 0.13600, policy 0.00059, entropy -0.00064, approx_kl 0.08049 clip_fraction 0.00406. 
[PPO] Training completed in 13.34s
[Metrics] Reward (train): current=0.731, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.688                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.454                    |
|    len                  | 5.688 +/- 7.39 (39661)   |
|    len_d_1_pos          | 5.441 +/- 7.66 (14940)   |
|    len_d_2_pos          | 5.298 +/- 7.62 (1449)    |
|    len_d_3_pos          | 5.116 +/- 7.49 (1492)    |
|    len_d_4_pos          | 5.203 +/- 7.52 (958)     |
|    len_d_unknown_neg    | 5.955 +/- 7.15 (20822)   |
|    len_neg              | 5.955 +/- 7.15 (20822)   |
|    len_pos              | 5.392 +/- 7.64 (18839)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (14940)   |
|    proven_d_2_pos       | 0.736 +/- 0.44 (1449)    |
|    proven_d_3_pos       | 0.746 +/- 0.44 (1492)    |
|    proven_d_4_pos       | 0.738 +/- 0.44 (958)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (20822)   |
|    proven_neg           | 0.006 +/- 0.08 (20822)   |
|    proven_pos           | 0.724 +/- 0.45 (18839)   |
|    reward               | 0.731 +/- 0.68 (39661)   |
|    reward_d_1_pos       | 0.439 +/- 0.90 (14940)   |
|    reward_d_2_pos       | 0.471 +/- 0.88 (1449)    |
|    reward_d_3_pos       | 0.492 +/- 0.87 (1492)    |
|    reward_d_4_pos       | 0.476 +/- 0.88 (958)     |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (20822)   |
|    reward_neg           | 0.988 +/- 0.16 (20822)   |
|    reward_pos           | 0.448 +/- 0.89 (18839)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 127                      |
|    time/fps             | 2007                     |
|    total_timesteps      | 229376                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.84s. FPS: 11547.18
Epoch 1/5. 
Losses: total 0.11661, value 0.26571, policy 0.00042, entropy -0.00109, approx_kl 0.01455 clip_fraction 0.00299. 
Epoch 2/5. 
Losses: total 0.07015, value 0.21667, policy 0.00036, entropy -0.00122, approx_kl 0.05446 clip_fraction 0.00404. 
Epoch 3/5. 
Losses: total 0.05723, value 0.18703, policy 0.00017, entropy -0.00122, approx_kl 0.07408 clip_fraction 0.00454. 
Epoch 4/5. 
Losses: total 0.05764, value 0.16702, policy 0.00005, entropy -0.00122, approx_kl 0.08916 clip_fraction 0.00487. 
Epoch 5/5. 
Losses: total 0.04001, value 0.15253, policy -0.00007, entropy -0.00126, approx_kl 0.09545 clip_fraction 0.00518. 
[PPO] Training completed in 13.33s
[Metrics] Reward (train): current=0.731, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.717                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.452                    |
|    len                  | 5.717 +/- 7.41 (45129)   |
|    len_d_1_pos          | 5.422 +/- 7.65 (16993)   |
|    len_d_2_pos          | 5.404 +/- 7.69 (1645)    |
|    len_d_3_pos          | 5.160 +/- 7.51 (1692)    |
|    len_d_4_pos          | 5.274 +/- 7.57 (1090)    |
|    len_d_unknown_neg    | 6.011 +/- 7.18 (23709)   |
|    len_neg              | 6.011 +/- 7.18 (23709)   |
|    len_pos              | 5.392 +/- 7.64 (21420)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (16993)   |
|    proven_d_2_pos       | 0.731 +/- 0.44 (1645)    |
|    proven_d_3_pos       | 0.741 +/- 0.44 (1692)    |
|    proven_d_4_pos       | 0.733 +/- 0.44 (1090)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (23709)   |
|    proven_neg           | 0.007 +/- 0.08 (23709)   |
|    proven_pos           | 0.724 +/- 0.45 (21420)   |
|    reward               | 0.731 +/- 0.68 (45129)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (16993)   |
|    reward_d_2_pos       | 0.461 +/- 0.89 (1645)    |
|    reward_d_3_pos       | 0.481 +/- 0.88 (1692)    |
|    reward_d_4_pos       | 0.466 +/- 0.88 (1090)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (23709)   |
|    reward_neg           | 0.987 +/- 0.16 (23709)   |
|    reward_pos           | 0.447 +/- 0.89 (21420)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 143                      |
|    time/fps             | 2009                     |
|    total_timesteps      | 262144                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.940, best=0.952 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.965                    |
|    MRR                  | 0.940                    |
|    len_d_-1_pos         | 14.542                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.826                    |
|    len_pos              | 9.350                    |
|    mrr_mean             | 0.940                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.007                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.007                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.84s. FPS: 11540.00
Epoch 1/5. 
Losses: total 0.10711, value 0.29646, policy 0.00073, entropy -0.00146, approx_kl 0.01064 clip_fraction 0.00333. 
Epoch 2/5. 
Losses: total 0.07353, value 0.24115, policy 0.00040, entropy -0.00120, approx_kl 0.02040 clip_fraction 0.00323. 
Epoch 3/5. 
Losses: total 0.06880, value 0.20637, policy 0.00026, entropy -0.00103, approx_kl 0.02890 clip_fraction 0.00343. 
Epoch 4/5. 
Losses: total 0.05633, value 0.18173, policy 0.00013, entropy -0.00095, approx_kl 0.03326 clip_fraction 0.00352. 
Epoch 5/5. 
Losses: total 0.03960, value 0.16347, policy 0.00004, entropy -0.00090, approx_kl 0.03809 clip_fraction 0.00369. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.729, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.746                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.370                    |
|    len                  | 5.746 +/- 7.43 (50509)   |
|    len_d_1_pos          | 5.458 +/- 7.67 (18984)   |
|    len_d_2_pos          | 5.397 +/- 7.69 (1834)    |
|    len_d_3_pos          | 5.179 +/- 7.53 (1910)    |
|    len_d_4_pos          | 5.262 +/- 7.56 (1205)    |
|    len_d_unknown_neg    | 6.039 +/- 7.20 (26576)   |
|    len_neg              | 6.039 +/- 7.20 (26576)   |
|    len_pos              | 5.421 +/- 7.66 (23933)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (18984)   |
|    proven_d_2_pos       | 0.731 +/- 0.44 (1834)    |
|    proven_d_3_pos       | 0.739 +/- 0.44 (1910)    |
|    proven_d_4_pos       | 0.734 +/- 0.44 (1205)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (26576)   |
|    proven_neg           | 0.007 +/- 0.08 (26576)   |
|    proven_pos           | 0.722 +/- 0.45 (23933)   |
|    reward               | 0.729 +/- 0.68 (50509)   |
|    reward_d_1_pos       | 0.437 +/- 0.90 (18984)   |
|    reward_d_2_pos       | 0.461 +/- 0.89 (1834)    |
|    reward_d_3_pos       | 0.479 +/- 0.88 (1910)    |
|    reward_d_4_pos       | 0.467 +/- 0.88 (1205)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (26576)   |
|    reward_neg           | 0.987 +/- 0.16 (26576)   |
|    reward_pos           | 0.444 +/- 0.90 (23933)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 161                      |
|    time/fps             | 1850                     |
|    total_timesteps      | 294912                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.85s. FPS: 11507.93
Epoch 1/5. 
Losses: total 0.11651, value 0.29196, policy 0.00034, entropy -0.00115, approx_kl 0.00266 clip_fraction 0.00201. 
Epoch 2/5. 
Losses: total 0.08452, value 0.24277, policy 0.00017, entropy -0.00098, approx_kl 0.01412 clip_fraction 0.00237. 
Epoch 3/5. 
Losses: total 0.07640, value 0.20982, policy 0.00011, entropy -0.00090, approx_kl 0.02170 clip_fraction 0.00262. 
Epoch 4/5. 
Losses: total 0.05698, value 0.18682, policy 0.00010, entropy -0.00088, approx_kl 0.03441 clip_fraction 0.00293. 
Epoch 5/5. 
Losses: total 0.04296, value 0.16994, policy 0.00009, entropy -0.00082, approx_kl 0.04365 clip_fraction 0.00309. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.729, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.748                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.425                    |
|    len                  | 5.748 +/- 7.42 (56155)   |
|    len_d_1_pos          | 5.452 +/- 7.66 (21084)   |
|    len_d_2_pos          | 5.512 +/- 7.76 (2049)    |
|    len_d_3_pos          | 5.199 +/- 7.55 (2129)    |
|    len_d_4_pos          | 5.122 +/- 7.46 (1358)    |
|    len_d_unknown_neg    | 6.044 +/- 7.20 (29535)   |
|    len_neg              | 6.044 +/- 7.20 (29535)   |
|    len_pos              | 5.419 +/- 7.65 (26620)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (21084)   |
|    proven_d_2_pos       | 0.725 +/- 0.45 (2049)    |
|    proven_d_3_pos       | 0.739 +/- 0.44 (2129)    |
|    proven_d_4_pos       | 0.739 +/- 0.44 (1358)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (29535)   |
|    proven_neg           | 0.007 +/- 0.08 (29535)   |
|    proven_pos           | 0.721 +/- 0.45 (26620)   |
|    reward               | 0.729 +/- 0.69 (56155)   |
|    reward_d_1_pos       | 0.436 +/- 0.90 (21084)   |
|    reward_d_2_pos       | 0.450 +/- 0.89 (2049)    |
|    reward_d_3_pos       | 0.478 +/- 0.88 (2129)    |
|    reward_d_4_pos       | 0.477 +/- 0.88 (1358)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (29535)   |
|    reward_neg           | 0.987 +/- 0.16 (29535)   |
|    reward_pos           | 0.442 +/- 0.90 (26620)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 177                      |
|    time/fps             | 1995                     |
|    total_timesteps      | 327680                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.85s. FPS: 11494.01
Epoch 1/5. 
Losses: total 0.13555, value 0.30156, policy 0.00084, entropy -0.00117, approx_kl 0.00429 clip_fraction 0.00192. 
Epoch 2/5. 
Losses: total 0.10147, value 0.25420, policy 0.00040, entropy -0.00103, approx_kl 0.02218 clip_fraction 0.00256. 
Epoch 3/5. 
Losses: total 0.08678, value 0.22075, policy 0.00021, entropy -0.00098, approx_kl 0.03118 clip_fraction 0.00288. 
Epoch 4/5. 
Losses: total 0.06490, value 0.19642, policy 0.00009, entropy -0.00091, approx_kl 0.03786 clip_fraction 0.00311. 
Epoch 5/5. 
Losses: total 0.04708, value 0.17818, policy -0.00001, entropy -0.00084, approx_kl 0.04226 clip_fraction 0.00328. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.729, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.755                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.386                    |
|    len                  | 5.755 +/- 7.43 (61713)   |
|    len_d_1_pos          | 5.423 +/- 7.64 (23183)   |
|    len_d_2_pos          | 5.485 +/- 7.75 (2256)    |
|    len_d_3_pos          | 5.274 +/- 7.57 (2346)    |
|    len_d_4_pos          | 5.234 +/- 7.54 (1469)    |
|    len_d_unknown_neg    | 6.069 +/- 7.21 (32459)   |
|    len_neg              | 6.069 +/- 7.21 (32459)   |
|    len_pos              | 5.407 +/- 7.64 (29254)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (23183)   |
|    proven_d_2_pos       | 0.726 +/- 0.45 (2256)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (2346)    |
|    proven_d_4_pos       | 0.734 +/- 0.44 (1469)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (32459)   |
|    proven_neg           | 0.007 +/- 0.08 (32459)   |
|    proven_pos           | 0.722 +/- 0.45 (29254)   |
|    reward               | 0.729 +/- 0.68 (61713)   |
|    reward_d_1_pos       | 0.439 +/- 0.90 (23183)   |
|    reward_d_2_pos       | 0.452 +/- 0.89 (2256)    |
|    reward_d_3_pos       | 0.466 +/- 0.88 (2346)    |
|    reward_d_4_pos       | 0.468 +/- 0.88 (1469)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (32459)   |
|    reward_neg           | 0.987 +/- 0.16 (32459)   |
|    reward_pos           | 0.443 +/- 0.90 (29254)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 193                      |
|    time/fps             | 1994                     |
|    total_timesteps      | 360448                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.85s. FPS: 11505.15
Epoch 1/5. 
Losses: total 0.13411, value 0.30400, policy 0.00045, entropy -0.00118, approx_kl 0.00416 clip_fraction 0.00177. 
Epoch 2/5. 
Losses: total 0.09816, value 0.26264, policy 0.00026, entropy -0.00105, approx_kl 0.01189 clip_fraction 0.00227. 
Epoch 3/5. 
Losses: total 0.08046, value 0.23296, policy 0.00013, entropy -0.00096, approx_kl 0.01717 clip_fraction 0.00252. 
Epoch 4/5. 
Losses: total 0.06206, value 0.21035, policy 0.00004, entropy -0.00089, approx_kl 0.02164 clip_fraction 0.00269. 
Epoch 5/5. 
Losses: total 0.04725, value 0.19270, policy -0.00002, entropy -0.00089, approx_kl 0.02710 clip_fraction 0.00295. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.730, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.763                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.394                    |
|    len                  | 5.763 +/- 7.43 (67249)   |
|    len_d_1_pos          | 5.412 +/- 7.64 (25267)   |
|    len_d_2_pos          | 5.517 +/- 7.77 (2441)    |
|    len_d_3_pos          | 5.241 +/- 7.54 (2576)    |
|    len_d_4_pos          | 5.208 +/- 7.51 (1594)    |
|    len_d_unknown_neg    | 6.093 +/- 7.22 (35371)   |
|    len_neg              | 6.093 +/- 7.22 (35371)   |
|    len_pos              | 5.396 +/- 7.63 (31878)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (25267)   |
|    proven_d_2_pos       | 0.724 +/- 0.45 (2441)    |
|    proven_d_3_pos       | 0.734 +/- 0.44 (2576)    |
|    proven_d_4_pos       | 0.735 +/- 0.44 (1594)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (35371)   |
|    proven_neg           | 0.007 +/- 0.08 (35371)   |
|    proven_pos           | 0.722 +/- 0.45 (31878)   |
|    reward               | 0.730 +/- 0.68 (67249)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (25267)   |
|    reward_d_2_pos       | 0.448 +/- 0.89 (2441)    |
|    reward_d_3_pos       | 0.467 +/- 0.88 (2576)    |
|    reward_d_4_pos       | 0.471 +/- 0.88 (1594)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (35371)   |
|    reward_neg           | 0.987 +/- 0.16 (35371)   |
|    reward_pos           | 0.445 +/- 0.90 (31878)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 210                      |
|    time/fps             | 1993                     |
|    total_timesteps      | 393216                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.950, best=0.952 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.920                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.975                    |
|    MRR                  | 0.950                    |
|    len_d_-1_pos         | 14.188                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.760                    |
|    len_pos              | 9.180                    |
|    mrr_mean             | 0.950                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.010                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.010                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.88s. FPS: 11387.52
Epoch 1/5. 
Losses: total 0.14528, value 0.31318, policy 0.00011, entropy -0.00114, approx_kl 0.00144 clip_fraction 0.00140. 
Epoch 2/5. 
Losses: total 0.11616, value 0.27478, policy 0.00001, entropy -0.00112, approx_kl 0.00477 clip_fraction 0.00169. 
Epoch 3/5. 
Losses: total 0.08350, value 0.24602, policy -0.00008, entropy -0.00105, approx_kl 0.00963 clip_fraction 0.00192. 
Epoch 4/5. 
Losses: total 0.07701, value 0.22341, policy -0.00016, entropy -0.00104, approx_kl 0.01289 clip_fraction 0.00216. 
Epoch 5/5. 
Losses: total 0.06817, value 0.20524, policy -0.00021, entropy -0.00102, approx_kl 0.01386 clip_fraction 0.00236. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.729, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.780                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.393                    |
|    len                  | 5.780 +/- 7.43 (72646)   |
|    len_d_1_pos          | 5.429 +/- 7.64 (27253)   |
|    len_d_2_pos          | 5.525 +/- 7.75 (2635)    |
|    len_d_3_pos          | 5.232 +/- 7.53 (2804)    |
|    len_d_4_pos          | 5.179 +/- 7.49 (1714)    |
|    len_d_unknown_neg    | 6.114 +/- 7.23 (38240)   |
|    len_neg              | 6.114 +/- 7.23 (38240)   |
|    len_pos              | 5.408 +/- 7.63 (34406)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (27253)   |
|    proven_d_2_pos       | 0.721 +/- 0.45 (2635)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (2804)    |
|    proven_d_4_pos       | 0.738 +/- 0.44 (1714)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (38240)   |
|    proven_neg           | 0.007 +/- 0.08 (38240)   |
|    proven_pos           | 0.722 +/- 0.45 (34406)   |
|    reward               | 0.729 +/- 0.68 (72646)   |
|    reward_d_1_pos       | 0.438 +/- 0.90 (27253)   |
|    reward_d_2_pos       | 0.443 +/- 0.90 (2635)    |
|    reward_d_3_pos       | 0.471 +/- 0.88 (2804)    |
|    reward_d_4_pos       | 0.476 +/- 0.88 (1714)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (38240)   |
|    reward_neg           | 0.987 +/- 0.16 (38240)   |
|    reward_pos           | 0.443 +/- 0.90 (34406)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 228                      |
|    time/fps             | 1842                     |
|    total_timesteps      | 425984                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.85s. FPS: 11478.47
Epoch 1/5. 
Losses: total 0.12660, value 0.31083, policy 0.00035, entropy -0.00119, approx_kl 0.00065 clip_fraction 0.00134. 
Epoch 2/5. 
Losses: total 0.13923, value 0.28210, policy 0.00015, entropy -0.00100, approx_kl 0.00308 clip_fraction 0.00166. 
Epoch 3/5. 
Losses: total 0.09651, value 0.25999, policy 0.00001, entropy -0.00090, approx_kl 0.00453 clip_fraction 0.00175. 
Epoch 4/5. 
Losses: total 0.10104, value 0.24156, policy -0.00009, entropy -0.00084, approx_kl 0.00607 clip_fraction 0.00185. 
Epoch 5/5. 
Losses: total 0.08037, value 0.22586, policy -0.00016, entropy -0.00081, approx_kl 0.00736 clip_fraction 0.00191. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.729, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.784                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.409                    |
|    len                  | 5.784 +/- 7.44 (78220)   |
|    len_d_1_pos          | 5.420 +/- 7.63 (29375)   |
|    len_d_2_pos          | 5.549 +/- 7.76 (2823)    |
|    len_d_3_pos          | 5.274 +/- 7.56 (3002)    |
|    len_d_4_pos          | 5.217 +/- 7.53 (1829)    |
|    len_d_unknown_neg    | 6.122 +/- 7.24 (41191)   |
|    len_neg              | 6.122 +/- 7.24 (41191)   |
|    len_pos              | 5.408 +/- 7.63 (37029)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (29375)   |
|    proven_d_2_pos       | 0.721 +/- 0.45 (2823)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (3002)    |
|    proven_d_4_pos       | 0.738 +/- 0.44 (1829)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (41191)   |
|    proven_neg           | 0.007 +/- 0.08 (41191)   |
|    proven_pos           | 0.721 +/- 0.45 (37029)   |
|    reward               | 0.729 +/- 0.68 (78220)   |
|    reward_d_1_pos       | 0.438 +/- 0.90 (29375)   |
|    reward_d_2_pos       | 0.442 +/- 0.90 (2823)    |
|    reward_d_3_pos       | 0.465 +/- 0.89 (3002)    |
|    reward_d_4_pos       | 0.476 +/- 0.88 (1829)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (41191)   |
|    reward_neg           | 0.987 +/- 0.16 (41191)   |
|    reward_pos           | 0.443 +/- 0.90 (37029)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 244                      |
|    time/fps             | 1990                     |
|    total_timesteps      | 458752                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.84s. FPS: 11530.16
Epoch 1/5. 
Losses: total 0.15029, value 0.30037, policy 0.00028, entropy -0.00117, approx_kl 0.00081 clip_fraction 0.00140. 
Epoch 2/5. 
Losses: total 0.14805, value 0.28140, policy 0.00009, entropy -0.00112, approx_kl 0.00386 clip_fraction 0.00174. 
Epoch 3/5. 
Losses: total 0.13120, value 0.26550, policy -0.00002, entropy -0.00106, approx_kl 0.00444 clip_fraction 0.00192. 
Epoch 4/5. 
Losses: total 0.09632, value 0.25184, policy -0.00009, entropy -0.00105, approx_kl 0.00529 clip_fraction 0.00211. 
Epoch 5/5. 
Losses: total 0.09535, value 0.23987, policy -0.00015, entropy -0.00105, approx_kl 0.00642 clip_fraction 0.00222. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.730, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.775                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.458                    |
|    len                  | 5.775 +/- 7.43 (83929)   |
|    len_d_1_pos          | 5.396 +/- 7.62 (31535)   |
|    len_d_2_pos          | 5.499 +/- 7.74 (3039)    |
|    len_d_3_pos          | 5.243 +/- 7.54 (3224)    |
|    len_d_4_pos          | 5.258 +/- 7.56 (1943)    |
|    len_d_unknown_neg    | 6.126 +/- 7.24 (44188)   |
|    len_neg              | 6.126 +/- 7.24 (44188)   |
|    len_pos              | 5.384 +/- 7.62 (39741)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (31535)   |
|    proven_d_2_pos       | 0.725 +/- 0.45 (3039)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (3224)    |
|    proven_d_4_pos       | 0.736 +/- 0.44 (1943)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (44188)   |
|    proven_neg           | 0.007 +/- 0.08 (44188)   |
|    proven_pos           | 0.723 +/- 0.45 (39741)   |
|    reward               | 0.730 +/- 0.68 (83929)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (31535)   |
|    reward_d_2_pos       | 0.450 +/- 0.89 (3039)    |
|    reward_d_3_pos       | 0.465 +/- 0.89 (3224)    |
|    reward_d_4_pos       | 0.473 +/- 0.88 (1943)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (44188)   |
|    reward_neg           | 0.987 +/- 0.16 (44188)   |
|    reward_pos           | 0.445 +/- 0.90 (39741)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 261                      |
|    time/fps             | 1991                     |
|    total_timesteps      | 491520                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt
[PPO] Rollout collected in 2.86s. FPS: 11452.40
Epoch 1/5. 
Losses: total 0.15612, value 0.31441, policy 0.00009, entropy -0.00130, approx_kl 0.00025 clip_fraction 0.00098. 
Epoch 2/5. 
Losses: total 0.14835, value 0.30678, policy -0.00002, entropy -0.00114, approx_kl 0.00084 clip_fraction 0.00110. 
Epoch 3/5. 
Losses: total 0.13427, value 0.29998, policy -0.00008, entropy -0.00110, approx_kl 0.00122 clip_fraction 0.00130. 
Epoch 4/5. 
Losses: total 0.14341, value 0.29380, policy -0.00013, entropy -0.00107, approx_kl 0.00150 clip_fraction 0.00141. 
Epoch 5/5. 
Losses: total 0.12335, value 0.28810, policy -0.00016, entropy -0.00106, approx_kl 0.00169 clip_fraction 0.00150. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.731, best=0.735 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.777                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.449                    |
|    len                  | 5.777 +/- 7.43 (89486)   |
|    len_d_1_pos          | 5.396 +/- 7.62 (33622)   |
|    len_d_2_pos          | 5.505 +/- 7.75 (3233)    |
|    len_d_3_pos          | 5.227 +/- 7.53 (3443)    |
|    len_d_4_pos          | 5.256 +/- 7.56 (2066)    |
|    len_d_unknown_neg    | 6.130 +/- 7.24 (47122)   |
|    len_neg              | 6.130 +/- 7.24 (47122)   |
|    len_pos              | 5.383 +/- 7.62 (42364)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (33622)   |
|    proven_d_2_pos       | 0.725 +/- 0.45 (3233)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (3443)    |
|    proven_d_4_pos       | 0.736 +/- 0.44 (2066)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (47122)   |
|    proven_neg           | 0.007 +/- 0.08 (47122)   |
|    proven_pos           | 0.723 +/- 0.45 (42364)   |
|    reward               | 0.731 +/- 0.68 (89486)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (33622)   |
|    reward_d_2_pos       | 0.450 +/- 0.89 (3233)    |
|    reward_d_3_pos       | 0.469 +/- 0.88 (3443)    |
|    reward_d_4_pos       | 0.472 +/- 0.88 (2066)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (47122)   |
|    reward_neg           | 0.987 +/- 0.16 (47122)   |
|    reward_pos           | 0.445 +/- 0.90 (42364)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 277                      |
|    time/fps             | 1987                     |
|    total_timesteps      | 524288                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.948, best=0.952 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.920                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.970                    |
|    MRR                  | 0.948                    |
|    len_d_-1_pos         | 13.979                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.768                    |
|    len_pos              | 9.080                    |
|    mrr_mean             | 0.948                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_00_48.pt

[Checkpoint] Restoring best model at end of training...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_10_00_48.pt
Loaded best model info: {'metric': 'mrr_mean', 'best_value': 0.9520021677017212, 'timesteps': 4, 'explained_variance': 0.7037780284881592}

[3/3] Running evaluation...

Results: MRR=0.8360, Hits@1=0.7780, Hits@3=0.8740, Hits@10=0.9310
Proven: pos=0.3740, neg=0.0127
Writing results to /home/castellanoontiv/Batched_Env/kge_experiments/runs/averaged_runs/experiments.csv

============================================================
All experiments completed!
============================================================


[8/10] Running: PBRS + Gated Bridge
==============================================
Grid search: 1 params, 1 experiments.

============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: wn18rr-250-128-torchrl
======================================================================
Training: wn18rr
Envs: 128, Steps: 256, Timesteps: 500000
Seed: 0
======================================================================

[1/3] Creating components...
[UnificationEngine] Capping max_fact_pairs from 34796 to 1000
[EnvOptimal] Compiled with mode=reduce-overhead, fullgraph=True

[2/3] Running training...
KGE Engine initialized with backend: pytorch (signature: torch_wn18rr_RotatE_1024_20260107_125531_s42)
[PBRS] Loaded 10637 precomputed potentials
[PBRS] Enabled with beta=0.1, gamma=0.99
[NeuralBridge] Created GatedBridge with init_alpha_success=0.7, init_alpha_fail=0.2
[PPO] Compiled ranking_step (double-buffered) with mode=default

[Checkpoint] Loading existing model at start of training (load_model=True)...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_10_00_48.pt

============================================================
Initial evaluation (untrained model)
============================================================
Building model and loading weights...
Weights loaded successfully.
[Eval] Took 8.30 seconds

[Ranking] MRR: current=0.938, best=0.938 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.900                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.975                    |
|    MRR                  | 0.938                    |
|    len_d_-1_pos         | 14.396                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.911                    |
|    len_pos              | 9.280                    |
|    mrr_mean             | 0.938                    |
|    proven_d_-1_pos      | 0.000                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.010                    |
|    proven_pos           | 0.410                    |
|    reward_d_-1_pos      | 0.000                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.010                    |
|    reward_label_pos     | 0.410                    |
----------------------------------------------------

============================================================

[PPO] Rollout collected in 4.83s. FPS: 6777.28
Epoch 1/5. 
Losses: total 0.05026, value 0.12239, policy 0.00087, entropy -0.00056, approx_kl 0.03118 clip_fraction 0.00290. 
Epoch 2/5. 
Losses: total 0.02850, value 0.09792, policy 0.00086, entropy -0.00057, approx_kl 0.04643 clip_fraction 0.00320. 
Epoch 3/5. 
Losses: total 0.02594, value 0.08512, policy 0.00083, entropy -0.00054, approx_kl 0.05998 clip_fraction 0.00340. 
Epoch 4/5. 
Losses: total 0.02802, value 0.07705, policy 0.00074, entropy -0.00053, approx_kl 0.07746 clip_fraction 0.00381. 
Epoch 5/5. 
Losses: total 0.02817, value 0.07138, policy 0.00073, entropy -0.00050, approx_kl 0.08948 clip_fraction 0.00399. 
[PPO] Training completed in 14.30s
[Metrics] Reward (train): current=0.744, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.610                    |
|    ep_rew_mean          | 0.744                    |
|    explained_variance   | 0.735                    |
|    len                  | 5.610 +/- 7.35 (5623)    |
|    len_d_1_pos          | 5.113 +/- 7.43 (2160)    |
|    len_d_2_pos          | 5.168 +/- 7.35 (208)     |
|    len_d_3_pos          | 5.512 +/- 7.69 (205)     |
|    len_d_4_pos          | 4.844 +/- 7.07 (135)     |
|    len_d_unknown_neg    | 6.052 +/- 7.25 (2915)    |
|    len_neg              | 6.052 +/- 7.25 (2915)    |
|    len_pos              | 5.134 +/- 7.42 (2708)    |
|    proven_d_1_pos       | 0.742 +/- 0.44 (2160)    |
|    proven_d_2_pos       | 0.745 +/- 0.44 (208)     |
|    proven_d_3_pos       | 0.717 +/- 0.45 (205)     |
|    proven_d_4_pos       | 0.726 +/- 0.45 (135)     |
|    proven_d_unknown_neg | 0.005 +/- 0.07 (2915)    |
|    proven_neg           | 0.005 +/- 0.07 (2915)    |
|    proven_pos           | 0.740 +/- 0.44 (2708)    |
|    reward               | 0.744 +/- 0.67 (5623)    |
|    reward_d_1_pos       | 0.484 +/- 0.87 (2160)    |
|    reward_d_2_pos       | 0.490 +/- 0.87 (208)     |
|    reward_d_3_pos       | 0.434 +/- 0.90 (205)     |
|    reward_d_4_pos       | 0.452 +/- 0.89 (135)     |
|    reward_d_unknown_neg | 0.990 +/- 0.14 (2915)    |
|    reward_neg           | 0.990 +/- 0.14 (2915)    |
|    reward_pos           | 0.479 +/- 0.88 (2708)    |
|    success_rate         | 0.359                    |
|    time/elapsed         | 28                       |
|    time/fps             | 1164                     |
|    total_timesteps      | 32768                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.86s. FPS: 11438.35
Epoch 1/5. 
Losses: total 0.04911, value 0.13063, policy 0.00047, entropy -0.00055, approx_kl 0.00802 clip_fraction 0.00128. 
Epoch 2/5. 
Losses: total 0.04997, value 0.10542, policy 0.00042, entropy -0.00058, approx_kl 0.02437 clip_fraction 0.00182. 
Epoch 3/5. 
Losses: total 0.02641, value 0.09229, policy 0.00040, entropy -0.00050, approx_kl 0.04046 clip_fraction 0.00210. 
Epoch 4/5. 
Losses: total 0.02250, value 0.08367, policy 0.00034, entropy -0.00049, approx_kl 0.04553 clip_fraction 0.00227. 
Epoch 5/5. 
Losses: total 0.02433, value 0.07733, policy 0.00034, entropy -0.00050, approx_kl 0.04994 clip_fraction 0.00245. 
[PPO] Training completed in 13.33s
[Metrics] Reward (train): current=0.735, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.683                    |
|    ep_rew_mean          | 0.735                    |
|    explained_variance   | 0.734                    |
|    len                  | 5.683 +/- 7.38 (11254)   |
|    len_d_1_pos          | 5.330 +/- 7.58 (4255)    |
|    len_d_2_pos          | 4.825 +/- 7.13 (435)     |
|    len_d_3_pos          | 5.650 +/- 7.78 (412)     |
|    len_d_4_pos          | 4.770 +/- 7.00 (291)     |
|    len_d_unknown_neg    | 6.051 +/- 7.23 (5861)    |
|    len_neg              | 6.051 +/- 7.23 (5861)    |
|    len_pos              | 5.283 +/- 7.53 (5393)    |
|    proven_d_1_pos       | 0.727 +/- 0.45 (4255)    |
|    proven_d_2_pos       | 0.759 +/- 0.43 (435)     |
|    proven_d_3_pos       | 0.718 +/- 0.45 (412)     |
|    proven_d_4_pos       | 0.735 +/- 0.44 (291)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (5861)    |
|    proven_neg           | 0.006 +/- 0.08 (5861)    |
|    proven_pos           | 0.730 +/- 0.44 (5393)    |
|    reward               | 0.735 +/- 0.68 (11254)   |
|    reward_d_1_pos       | 0.455 +/- 0.89 (4255)    |
|    reward_d_2_pos       | 0.517 +/- 0.86 (435)     |
|    reward_d_3_pos       | 0.437 +/- 0.90 (412)     |
|    reward_d_4_pos       | 0.471 +/- 0.88 (291)     |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (5861)    |
|    reward_neg           | 0.988 +/- 0.15 (5861)    |
|    reward_pos           | 0.459 +/- 0.89 (5393)    |
|    success_rate         | 0.353                    |
|    time/elapsed         | 44                       |
|    time/fps             | 2015                     |
|    total_timesteps      | 65536                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.87s. FPS: 11419.44
Epoch 1/5. 
Losses: total 0.05935, value 0.13833, policy 0.00125, entropy -0.00082, approx_kl 0.02148 clip_fraction 0.00284. 
Epoch 2/5. 
Losses: total 0.03624, value 0.11097, policy 0.00090, entropy -0.00067, approx_kl 0.04663 clip_fraction 0.00320. 
Epoch 3/5. 
Losses: total 0.03323, value 0.09614, policy 0.00086, entropy -0.00064, approx_kl 0.07009 clip_fraction 0.00369. 
Epoch 4/5. 
Losses: total 0.02732, value 0.08704, policy 0.00105, entropy -0.00064, approx_kl 0.08851 clip_fraction 0.00388. 
Epoch 5/5. 
Losses: total 0.02741, value 0.08033, policy 0.00099, entropy -0.00061, approx_kl 0.10645 clip_fraction 0.00403. 
[PPO] Training completed in 13.33s
[Metrics] Reward (train): current=0.732, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.648                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.734                    |
|    len                  | 5.648 +/- 7.36 (17034)   |
|    len_d_1_pos          | 5.377 +/- 7.61 (6427)    |
|    len_d_2_pos          | 5.064 +/- 7.38 (652)     |
|    len_d_3_pos          | 5.490 +/- 7.68 (639)     |
|    len_d_4_pos          | 5.086 +/- 7.29 (418)     |
|    len_d_unknown_neg    | 5.923 +/- 7.13 (8898)    |
|    len_neg              | 5.923 +/- 7.13 (8898)    |
|    len_pos              | 5.346 +/- 7.58 (8136)    |
|    proven_d_1_pos       | 0.723 +/- 0.45 (6427)    |
|    proven_d_2_pos       | 0.753 +/- 0.43 (652)     |
|    proven_d_3_pos       | 0.720 +/- 0.45 (639)     |
|    proven_d_4_pos       | 0.727 +/- 0.45 (418)     |
|    proven_d_unknown_neg | 0.006 +/- 0.07 (8898)    |
|    proven_neg           | 0.006 +/- 0.07 (8898)    |
|    proven_pos           | 0.726 +/- 0.45 (8136)    |
|    reward               | 0.732 +/- 0.68 (17034)   |
|    reward_d_1_pos       | 0.447 +/- 0.89 (6427)    |
|    reward_d_2_pos       | 0.506 +/- 0.86 (652)     |
|    reward_d_3_pos       | 0.440 +/- 0.90 (639)     |
|    reward_d_4_pos       | 0.455 +/- 0.89 (418)     |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (8898)    |
|    reward_neg           | 0.989 +/- 0.15 (8898)    |
|    reward_pos           | 0.451 +/- 0.89 (8136)    |
|    success_rate         | 0.349                    |
|    time/elapsed         | 60                       |
|    time/fps             | 2010                     |
|    total_timesteps      | 98304                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.89s. FPS: 11339.65
Epoch 1/5. 
Losses: total 0.06340, value 0.14113, policy 0.00058, entropy -0.00064, approx_kl 0.05272 clip_fraction 0.00250. 
Epoch 2/5. 
Losses: total 0.05318, value 0.11247, policy 0.00051, entropy -0.00069, approx_kl 0.06651 clip_fraction 0.00319. 
Epoch 3/5. 
Losses: total 0.03306, value 0.09741, policy 0.00034, entropy -0.00068, approx_kl 0.07503 clip_fraction 0.00327. 
Epoch 4/5. 
Losses: total 0.02648, value 0.08786, policy 0.00025, entropy -0.00065, approx_kl 0.08407 clip_fraction 0.00343. 
Epoch 5/5. 
Losses: total 0.02060, value 0.08058, policy 0.00018, entropy -0.00064, approx_kl 0.09866 clip_fraction 0.00360. 
[PPO] Training completed in 13.33s
[Metrics] Reward (train): current=0.733, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.659                    |
|    ep_rew_mean          | 0.733                    |
|    explained_variance   | 0.717                    |
|    len                  | 5.659 +/- 7.37 (22732)   |
|    len_d_1_pos          | 5.345 +/- 7.60 (8590)    |
|    len_d_2_pos          | 5.200 +/- 7.48 (852)     |
|    len_d_3_pos          | 5.502 +/- 7.72 (857)     |
|    len_d_4_pos          | 5.141 +/- 7.37 (545)     |
|    len_d_unknown_neg    | 5.954 +/- 7.15 (11888)   |
|    len_neg              | 5.954 +/- 7.15 (11888)   |
|    len_pos              | 5.336 +/- 7.59 (10844)   |
|    proven_d_1_pos       | 0.725 +/- 0.45 (8590)    |
|    proven_d_2_pos       | 0.743 +/- 0.44 (852)     |
|    proven_d_3_pos       | 0.723 +/- 0.45 (857)     |
|    proven_d_4_pos       | 0.725 +/- 0.45 (545)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (11888)   |
|    proven_neg           | 0.006 +/- 0.08 (11888)   |
|    proven_pos           | 0.727 +/- 0.45 (10844)   |
|    reward               | 0.733 +/- 0.68 (22732)   |
|    reward_d_1_pos       | 0.451 +/- 0.89 (8590)    |
|    reward_d_2_pos       | 0.486 +/- 0.87 (852)     |
|    reward_d_3_pos       | 0.447 +/- 0.89 (857)     |
|    reward_d_4_pos       | 0.450 +/- 0.89 (545)     |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (11888)   |
|    reward_neg           | 0.989 +/- 0.15 (11888)   |
|    reward_pos           | 0.453 +/- 0.89 (10844)   |
|    success_rate         | 0.350                    |
|    time/elapsed         | 77                       |
|    time/fps             | 2005                     |
|    total_timesteps      | 131072                   |
----------------------------------------------------

[Eval] Took 1.32 seconds

[Ranking] MRR: current=0.948, best=0.948 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.915                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.985                    |
|    MRR                  | 0.948                    |
|    len_d_-1_pos         | 13.688                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.550                    |
|    len_pos              | 8.940                    |
|    mrr_mean             | 0.948                    |
|    proven_d_-1_pos      | 0.000                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.005                    |
|    proven_pos           | 0.410                    |
|    reward_d_-1_pos      | 0.000                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.005                    |
|    reward_label_pos     | 0.410                    |
----------------------------------------------------

[Checkpoint] New best eval model saved to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_10_06_28.pt (mrr_mean=0.9478)
[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.88s. FPS: 11363.66
Epoch 1/5. 
Losses: total 0.10397, value 0.25339, policy 0.00068, entropy -0.00080, approx_kl 0.03317 clip_fraction 0.00195. 
Epoch 2/5. 
Losses: total 0.05620, value 0.19724, policy 0.00056, entropy -0.00075, approx_kl 0.06387 clip_fraction 0.00264. 
Epoch 3/5. 
Losses: total 0.04431, value 0.16484, policy 0.00052, entropy -0.00078, approx_kl 0.10242 clip_fraction 0.00341. 
Epoch 4/5. 
Losses: total 0.04024, value 0.14400, policy 0.00047, entropy -0.00078, approx_kl 0.12054 clip_fraction 0.00368. 
Epoch 5/5. 
Losses: total 0.03386, value 0.12889, policy 0.00041, entropy -0.00077, approx_kl 0.13163 clip_fraction 0.00375. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.732, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.693                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.461                    |
|    len                  | 5.693 +/- 7.39 (28307)   |
|    len_d_1_pos          | 5.386 +/- 7.62 (10685)   |
|    len_d_2_pos          | 5.173 +/- 7.49 (1063)    |
|    len_d_3_pos          | 5.378 +/- 7.62 (1075)    |
|    len_d_4_pos          | 5.129 +/- 7.41 (666)     |
|    len_d_unknown_neg    | 6.000 +/- 7.17 (14818)   |
|    len_neg              | 6.000 +/- 7.17 (14818)   |
|    len_pos              | 5.356 +/- 7.60 (13489)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (10685)   |
|    proven_d_2_pos       | 0.744 +/- 0.44 (1063)    |
|    proven_d_3_pos       | 0.723 +/- 0.45 (1075)    |
|    proven_d_4_pos       | 0.733 +/- 0.44 (666)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (14818)   |
|    proven_neg           | 0.006 +/- 0.08 (14818)   |
|    proven_pos           | 0.725 +/- 0.45 (13489)   |
|    reward               | 0.732 +/- 0.68 (28307)   |
|    reward_d_1_pos       | 0.446 +/- 0.90 (10685)   |
|    reward_d_2_pos       | 0.488 +/- 0.87 (1063)    |
|    reward_d_3_pos       | 0.446 +/- 0.90 (1075)    |
|    reward_d_4_pos       | 0.465 +/- 0.89 (666)     |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (14818)   |
|    reward_neg           | 0.988 +/- 0.16 (14818)   |
|    reward_pos           | 0.450 +/- 0.89 (13489)   |
|    success_rate         | 0.349                    |
|    time/elapsed         | 94                       |
|    time/fps             | 1842                     |
|    total_timesteps      | 163840                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.91s. FPS: 11277.84
Epoch 1/5. 
Losses: total 0.08560, value 0.24661, policy 0.00028, entropy -0.00056, approx_kl 0.01057 clip_fraction 0.00162. 
Epoch 2/5. 
Losses: total 0.05902, value 0.19188, policy 0.00042, entropy -0.00056, approx_kl 0.03946 clip_fraction 0.00218. 
Epoch 3/5. 
Losses: total 0.05209, value 0.16091, policy 0.00062, entropy -0.00053, approx_kl 0.06014 clip_fraction 0.00255. 
Epoch 4/5. 
Losses: total 0.04221, value 0.14085, policy 0.00060, entropy -0.00051, approx_kl 0.06680 clip_fraction 0.00272. 
Epoch 5/5. 
Losses: total 0.03925, value 0.12635, policy 0.00060, entropy -0.00048, approx_kl 0.07144 clip_fraction 0.00283. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.734, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.687                    |
|    ep_rew_mean          | 0.734                    |
|    explained_variance   | 0.460                    |
|    len                  | 5.687 +/- 7.38 (34013)   |
|    len_d_1_pos          | 5.358 +/- 7.60 (12834)   |
|    len_d_2_pos          | 5.042 +/- 7.39 (1289)    |
|    len_d_3_pos          | 5.182 +/- 7.49 (1284)    |
|    len_d_4_pos          | 5.005 +/- 7.28 (802)     |
|    len_d_unknown_neg    | 6.038 +/- 7.19 (17804)   |
|    len_neg              | 6.038 +/- 7.19 (17804)   |
|    len_pos              | 5.301 +/- 7.56 (16209)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (12834)   |
|    proven_d_2_pos       | 0.749 +/- 0.43 (1289)    |
|    proven_d_3_pos       | 0.734 +/- 0.44 (1284)    |
|    proven_d_4_pos       | 0.739 +/- 0.44 (802)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (17804)   |
|    proven_neg           | 0.006 +/- 0.08 (17804)   |
|    proven_pos           | 0.727 +/- 0.45 (16209)   |
|    reward               | 0.734 +/- 0.68 (34013)   |
|    reward_d_1_pos       | 0.447 +/- 0.89 (12834)   |
|    reward_d_2_pos       | 0.499 +/- 0.87 (1289)    |
|    reward_d_3_pos       | 0.469 +/- 0.88 (1284)    |
|    reward_d_4_pos       | 0.479 +/- 0.88 (802)     |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (17804)   |
|    reward_neg           | 0.988 +/- 0.16 (17804)   |
|    reward_pos           | 0.454 +/- 0.89 (16209)   |
|    success_rate         | 0.350                    |
|    time/elapsed         | 111                      |
|    time/fps             | 1992                     |
|    total_timesteps      | 196608                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.88s. FPS: 11394.35
Epoch 1/5. 
Losses: total 0.09798, value 0.26052, policy 0.00049, entropy -0.00100, approx_kl 0.00790 clip_fraction 0.00229. 
Epoch 2/5. 
Losses: total 0.06051, value 0.20747, policy 0.00057, entropy -0.00109, approx_kl 0.01731 clip_fraction 0.00272. 
Epoch 3/5. 
Losses: total 0.06036, value 0.17466, policy 0.00041, entropy -0.00088, approx_kl 0.04019 clip_fraction 0.00303. 
Epoch 4/5. 
Losses: total 0.04559, value 0.15276, policy 0.00034, entropy -0.00079, approx_kl 0.05934 clip_fraction 0.00335. 
Epoch 5/5. 
Losses: total 0.03375, value 0.13702, policy 0.00031, entropy -0.00074, approx_kl 0.07580 clip_fraction 0.00359. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.733, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.697                    |
|    ep_rew_mean          | 0.733                    |
|    explained_variance   | 0.448                    |
|    len                  | 5.697 +/- 7.39 (39629)   |
|    len_d_1_pos          | 5.390 +/- 7.63 (14937)   |
|    len_d_2_pos          | 5.085 +/- 7.44 (1479)    |
|    len_d_3_pos          | 5.156 +/- 7.47 (1504)    |
|    len_d_4_pos          | 4.820 +/- 7.16 (950)     |
|    len_d_unknown_neg    | 6.040 +/- 7.20 (20759)   |
|    len_neg              | 6.040 +/- 7.20 (20759)   |
|    len_pos              | 5.319 +/- 7.58 (18870)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (14937)   |
|    proven_d_2_pos       | 0.747 +/- 0.43 (1479)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (1504)    |
|    proven_d_4_pos       | 0.748 +/- 0.43 (950)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (20759)   |
|    proven_neg           | 0.006 +/- 0.08 (20759)   |
|    proven_pos           | 0.726 +/- 0.45 (18870)   |
|    reward               | 0.733 +/- 0.68 (39629)   |
|    reward_d_1_pos       | 0.444 +/- 0.90 (14937)   |
|    reward_d_2_pos       | 0.494 +/- 0.87 (1479)    |
|    reward_d_3_pos       | 0.469 +/- 0.88 (1504)    |
|    reward_d_4_pos       | 0.497 +/- 0.87 (950)     |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (20759)   |
|    reward_neg           | 0.987 +/- 0.16 (20759)   |
|    reward_pos           | 0.453 +/- 0.89 (18870)   |
|    success_rate         | 0.349                    |
|    time/elapsed         | 127                      |
|    time/fps             | 1997                     |
|    total_timesteps      | 229376                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.88s. FPS: 11363.49
Epoch 1/5. 
Losses: total 0.10789, value 0.27017, policy 0.00017, entropy -0.00080, approx_kl 0.00501 clip_fraction 0.00119. 
Epoch 2/5. 
Losses: total 0.06096, value 0.21650, policy 0.00010, entropy -0.00079, approx_kl 0.01708 clip_fraction 0.00182. 
Epoch 3/5. 
Losses: total 0.05025, value 0.18411, policy 0.00008, entropy -0.00074, approx_kl 0.02633 clip_fraction 0.00205. 
Epoch 4/5. 
Losses: total 0.05014, value 0.16205, policy 0.00004, entropy -0.00072, approx_kl 0.03808 clip_fraction 0.00224. 
Epoch 5/5. 
Losses: total 0.03981, value 0.14619, policy -0.00002, entropy -0.00070, approx_kl 0.04847 clip_fraction 0.00241. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.732, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.719                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.427                    |
|    len                  | 5.719 +/- 7.41 (45146)   |
|    len_d_1_pos          | 5.374 +/- 7.62 (17005)   |
|    len_d_2_pos          | 5.096 +/- 7.45 (1682)    |
|    len_d_3_pos          | 5.199 +/- 7.49 (1713)    |
|    len_d_4_pos          | 4.990 +/- 7.28 (1069)    |
|    len_d_unknown_neg    | 6.081 +/- 7.23 (23677)   |
|    len_neg              | 6.081 +/- 7.23 (23677)   |
|    len_pos              | 5.319 +/- 7.58 (21469)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (17005)   |
|    proven_d_2_pos       | 0.746 +/- 0.44 (1682)    |
|    proven_d_3_pos       | 0.731 +/- 0.44 (1713)    |
|    proven_d_4_pos       | 0.737 +/- 0.44 (1069)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (23677)   |
|    proven_neg           | 0.007 +/- 0.08 (23677)   |
|    proven_pos           | 0.726 +/- 0.45 (21469)   |
|    reward               | 0.732 +/- 0.68 (45146)   |
|    reward_d_1_pos       | 0.446 +/- 0.90 (17005)   |
|    reward_d_2_pos       | 0.492 +/- 0.87 (1682)    |
|    reward_d_3_pos       | 0.463 +/- 0.89 (1713)    |
|    reward_d_4_pos       | 0.474 +/- 0.88 (1069)    |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (23677)   |
|    reward_neg           | 0.986 +/- 0.17 (23677)   |
|    reward_pos           | 0.452 +/- 0.89 (21469)   |
|    success_rate         | 0.349                    |
|    time/elapsed         | 144                      |
|    time/fps             | 1993                     |
|    total_timesteps      | 262144                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.937, best=0.948 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.900                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.965                    |
|    MRR                  | 0.937                    |
|    len_d_-1_pos         | 13.708                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.680                    |
|    len_pos              | 8.950                    |
|    mrr_mean             | 0.937                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.005                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.005                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.91s. FPS: 11269.85
Epoch 1/5. 
Losses: total 0.11777, value 0.28699, policy 0.00029, entropy -0.00063, approx_kl 0.00667 clip_fraction 0.00113. 
Epoch 2/5. 
Losses: total 0.07528, value 0.23335, policy 0.00021, entropy -0.00059, approx_kl 0.01218 clip_fraction 0.00143. 
Epoch 3/5. 
Losses: total 0.06276, value 0.19783, policy 0.00012, entropy -0.00054, approx_kl 0.01643 clip_fraction 0.00153. 
Epoch 4/5. 
Losses: total 0.04234, value 0.17297, policy 0.00009, entropy -0.00054, approx_kl 0.01900 clip_fraction 0.00163. 
Epoch 5/5. 
Losses: total 0.04269, value 0.15490, policy 0.00005, entropy -0.00052, approx_kl 0.02260 clip_fraction 0.00170. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.731, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.722                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.401                    |
|    len                  | 5.722 +/- 7.41 (50779)   |
|    len_d_1_pos          | 5.401 +/- 7.64 (19111)   |
|    len_d_2_pos          | 5.088 +/- 7.45 (1897)    |
|    len_d_3_pos          | 5.196 +/- 7.49 (1938)    |
|    len_d_4_pos          | 5.017 +/- 7.31 (1184)    |
|    len_d_unknown_neg    | 6.067 +/- 7.22 (26649)   |
|    len_neg              | 6.067 +/- 7.22 (26649)   |
|    len_pos              | 5.341 +/- 7.60 (24130)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (19111)   |
|    proven_d_2_pos       | 0.747 +/- 0.43 (1897)    |
|    proven_d_3_pos       | 0.732 +/- 0.44 (1938)    |
|    proven_d_4_pos       | 0.735 +/- 0.44 (1184)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (26649)   |
|    proven_neg           | 0.007 +/- 0.08 (26649)   |
|    proven_pos           | 0.724 +/- 0.45 (24130)   |
|    reward               | 0.731 +/- 0.68 (50779)   |
|    reward_d_1_pos       | 0.442 +/- 0.90 (19111)   |
|    reward_d_2_pos       | 0.494 +/- 0.87 (1897)    |
|    reward_d_3_pos       | 0.464 +/- 0.89 (1938)    |
|    reward_d_4_pos       | 0.470 +/- 0.88 (1184)    |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (26649)   |
|    reward_neg           | 0.986 +/- 0.17 (26649)   |
|    reward_pos           | 0.449 +/- 0.89 (24130)   |
|    success_rate         | 0.348                    |
|    time/elapsed         | 161                      |
|    time/fps             | 1842                     |
|    total_timesteps      | 294912                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.88s. FPS: 11390.11
Epoch 1/5. 
Losses: total 0.12705, value 0.28025, policy 0.00031, entropy -0.00063, approx_kl 0.01192 clip_fraction 0.00125. 
Epoch 2/5. 
Losses: total 0.08692, value 0.22884, policy 0.00022, entropy -0.00058, approx_kl 0.01984 clip_fraction 0.00137. 
Epoch 3/5. 
Losses: total 0.05608, value 0.19540, policy 0.00019, entropy -0.00052, approx_kl 0.02456 clip_fraction 0.00155. 
Epoch 4/5. 
Losses: total 0.04834, value 0.17187, policy 0.00018, entropy -0.00051, approx_kl 0.03926 clip_fraction 0.00175. 
Epoch 5/5. 
Losses: total 0.04660, value 0.15489, policy 0.00014, entropy -0.00049, approx_kl 0.05472 clip_fraction 0.00197. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.730, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.742                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.431                    |
|    len                  | 5.742 +/- 7.42 (56243)   |
|    len_d_1_pos          | 5.437 +/- 7.66 (21129)   |
|    len_d_2_pos          | 5.195 +/- 7.52 (2092)    |
|    len_d_3_pos          | 5.202 +/- 7.51 (2154)    |
|    len_d_4_pos          | 5.013 +/- 7.33 (1338)    |
|    len_d_unknown_neg    | 6.072 +/- 7.22 (29530)   |
|    len_neg              | 6.072 +/- 7.22 (29530)   |
|    len_pos              | 5.378 +/- 7.62 (26713)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (21129)   |
|    proven_d_2_pos       | 0.741 +/- 0.44 (2092)    |
|    proven_d_3_pos       | 0.734 +/- 0.44 (2154)    |
|    proven_d_4_pos       | 0.737 +/- 0.44 (1338)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (29530)   |
|    proven_neg           | 0.007 +/- 0.08 (29530)   |
|    proven_pos           | 0.723 +/- 0.45 (26713)   |
|    reward               | 0.730 +/- 0.68 (56243)   |
|    reward_d_1_pos       | 0.439 +/- 0.90 (21129)   |
|    reward_d_2_pos       | 0.482 +/- 0.88 (2092)    |
|    reward_d_3_pos       | 0.469 +/- 0.88 (2154)    |
|    reward_d_4_pos       | 0.474 +/- 0.88 (1338)    |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (29530)   |
|    reward_neg           | 0.986 +/- 0.17 (29530)   |
|    reward_pos           | 0.446 +/- 0.89 (26713)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 178                      |
|    time/fps             | 1992                     |
|    total_timesteps      | 327680                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.90s. FPS: 11311.62
Epoch 1/5. 
Losses: total 0.11708, value 0.29351, policy 0.00022, entropy -0.00069, approx_kl 0.00284 clip_fraction 0.00104. 
Epoch 2/5. 
Losses: total 0.09017, value 0.24694, policy 0.00015, entropy -0.00065, approx_kl 0.01572 clip_fraction 0.00148. 
Epoch 3/5. 
Losses: total 0.08089, value 0.21429, policy 0.00009, entropy -0.00060, approx_kl 0.02172 clip_fraction 0.00166. 
Epoch 4/5. 
Losses: total 0.06554, value 0.19050, policy 0.00003, entropy -0.00056, approx_kl 0.02670 clip_fraction 0.00174. 
Epoch 5/5. 
Losses: total 0.04160, value 0.17244, policy -0.00000, entropy -0.00058, approx_kl 0.03174 clip_fraction 0.00186. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.731, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.741                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.409                    |
|    len                  | 5.741 +/- 7.43 (61907)   |
|    len_d_1_pos          | 5.420 +/- 7.66 (23255)   |
|    len_d_2_pos          | 5.201 +/- 7.52 (2313)    |
|    len_d_3_pos          | 5.236 +/- 7.53 (2367)    |
|    len_d_4_pos          | 5.128 +/- 7.42 (1453)    |
|    len_d_unknown_neg    | 6.073 +/- 7.23 (32519)   |
|    len_neg              | 6.073 +/- 7.23 (32519)   |
|    len_pos              | 5.374 +/- 7.62 (29388)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (23255)   |
|    proven_d_2_pos       | 0.738 +/- 0.44 (2313)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (2367)    |
|    proven_d_4_pos       | 0.732 +/- 0.44 (1453)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (32519)   |
|    proven_neg           | 0.007 +/- 0.08 (32519)   |
|    proven_pos           | 0.724 +/- 0.45 (29388)   |
|    reward               | 0.731 +/- 0.68 (61907)   |
|    reward_d_1_pos       | 0.442 +/- 0.90 (23255)   |
|    reward_d_2_pos       | 0.477 +/- 0.88 (2313)    |
|    reward_d_3_pos       | 0.465 +/- 0.89 (2367)    |
|    reward_d_4_pos       | 0.465 +/- 0.89 (1453)    |
|    reward_d_unknown_neg | 0.986 +/- 0.17 (32519)   |
|    reward_neg           | 0.986 +/- 0.17 (32519)   |
|    reward_pos           | 0.448 +/- 0.89 (29388)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 194                      |
|    time/fps             | 1988                     |
|    total_timesteps      | 360448                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.88s. FPS: 11375.14
Epoch 1/5. 
Losses: total 0.10853, value 0.28830, policy 0.00009, entropy -0.00059, approx_kl 0.00176 clip_fraction 0.00076. 
Epoch 2/5. 
Losses: total 0.08356, value 0.24260, policy 0.00008, entropy -0.00053, approx_kl 0.00392 clip_fraction 0.00087. 
Epoch 3/5. 
Losses: total 0.06750, value 0.21170, policy 0.00002, entropy -0.00052, approx_kl 0.00520 clip_fraction 0.00100. 
Epoch 4/5. 
Losses: total 0.05361, value 0.18880, policy 0.00000, entropy -0.00051, approx_kl 0.00729 clip_fraction 0.00114. 
Epoch 5/5. 
Losses: total 0.04461, value 0.17161, policy -0.00002, entropy -0.00049, approx_kl 0.00949 clip_fraction 0.00123. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.732                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.427                    |
|    len                  | 5.732 +/- 7.42 (67640)   |
|    len_d_1_pos          | 5.420 +/- 7.66 (25419)   |
|    len_d_2_pos          | 5.273 +/- 7.56 (2501)    |
|    len_d_3_pos          | 5.226 +/- 7.52 (2603)    |
|    len_d_4_pos          | 5.051 +/- 7.37 (1595)    |
|    len_d_unknown_neg    | 6.055 +/- 7.22 (35522)   |
|    len_neg              | 6.055 +/- 7.22 (35522)   |
|    len_pos              | 5.375 +/- 7.62 (32118)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (25419)   |
|    proven_d_2_pos       | 0.734 +/- 0.44 (2501)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (2603)    |
|    proven_d_4_pos       | 0.738 +/- 0.44 (1595)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (35522)   |
|    proven_neg           | 0.007 +/- 0.08 (35522)   |
|    proven_pos           | 0.724 +/- 0.45 (32118)   |
|    reward               | 0.731 +/- 0.68 (67640)   |
|    reward_d_1_pos       | 0.443 +/- 0.90 (25419)   |
|    reward_d_2_pos       | 0.467 +/- 0.88 (2501)    |
|    reward_d_3_pos       | 0.470 +/- 0.88 (2603)    |
|    reward_d_4_pos       | 0.476 +/- 0.88 (1595)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (35522)   |
|    reward_neg           | 0.987 +/- 0.16 (35522)   |
|    reward_pos           | 0.449 +/- 0.89 (32118)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 211                      |
|    time/fps             | 1989                     |
|    total_timesteps      | 393216                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.941, best=0.948 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.970                    |
|    MRR                  | 0.941                    |
|    len_d_-1_pos         | 13.042                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.306                    |
|    len_pos              | 8.630                    |
|    mrr_mean             | 0.941                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.88s. FPS: 11363.18
Epoch 1/5. 
Losses: total 0.14032, value 0.30090, policy 0.00592, entropy -0.00081, approx_kl 0.00618 clip_fraction 0.00122. 
Epoch 2/5. 
Losses: total 0.10434, value 0.26033, policy 0.00590, entropy -0.00072, approx_kl 0.01516 clip_fraction 0.00140. 
Epoch 3/5. 
Losses: total 0.08195, value 0.23146, policy 0.00568, entropy -0.00072, approx_kl 0.01875 clip_fraction 0.00155. 
Epoch 4/5. 
Losses: total 0.41702, value 0.20976, policy 0.00555, entropy -0.00068, approx_kl 0.02165 clip_fraction 0.00164. 
Epoch 5/5. 
Losses: total 0.05925, value 0.19260, policy 0.00546, entropy -0.00068, approx_kl 0.02450 clip_fraction 0.00172. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.730, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.747                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.426                    |
|    len                  | 5.747 +/- 7.43 (73104)   |
|    len_d_1_pos          | 5.430 +/- 7.66 (27462)   |
|    len_d_2_pos          | 5.291 +/- 7.56 (2711)    |
|    len_d_3_pos          | 5.208 +/- 7.52 (2831)    |
|    len_d_4_pos          | 5.102 +/- 7.41 (1714)    |
|    len_d_unknown_neg    | 6.073 +/- 7.23 (38386)   |
|    len_neg              | 6.073 +/- 7.23 (38386)   |
|    len_pos              | 5.385 +/- 7.63 (34718)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (27462)   |
|    proven_d_2_pos       | 0.731 +/- 0.44 (2711)    |
|    proven_d_3_pos       | 0.737 +/- 0.44 (2831)    |
|    proven_d_4_pos       | 0.737 +/- 0.44 (1714)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (38386)   |
|    proven_neg           | 0.007 +/- 0.08 (38386)   |
|    proven_pos           | 0.723 +/- 0.45 (34718)   |
|    reward               | 0.730 +/- 0.68 (73104)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (27462)   |
|    reward_d_2_pos       | 0.461 +/- 0.89 (2711)    |
|    reward_d_3_pos       | 0.474 +/- 0.88 (2831)    |
|    reward_d_4_pos       | 0.474 +/- 0.88 (1714)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (38386)   |
|    reward_neg           | 0.987 +/- 0.16 (38386)   |
|    reward_pos           | 0.447 +/- 0.89 (34718)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 229                      |
|    time/fps             | 1841                     |
|    total_timesteps      | 425984                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.88s. FPS: 11363.32
Epoch 1/5. 
Losses: total 0.13482, value 0.31338, policy 0.00012, entropy -0.00092, approx_kl 0.00084 clip_fraction 0.00092. 
Epoch 2/5. 
Losses: total 0.12674, value 0.28241, policy -0.00007, entropy -0.00077, approx_kl 0.00354 clip_fraction 0.00104. 
Epoch 3/5. 
Losses: total 0.10029, value 0.25774, policy -0.00013, entropy -0.00074, approx_kl 0.00512 clip_fraction 0.00124. 
Epoch 4/5. 
Losses: total 0.08626, value 0.23751, policy -0.00018, entropy -0.00070, approx_kl 0.00625 clip_fraction 0.00131. 
Epoch 5/5. 
Losses: total 0.07241, value 0.22064, policy -0.00021, entropy -0.00067, approx_kl 0.00745 clip_fraction 0.00140. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.749                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.414                    |
|    len                  | 5.749 +/- 7.43 (78750)   |
|    len_d_1_pos          | 5.419 +/- 7.65 (29587)   |
|    len_d_2_pos          | 5.295 +/- 7.55 (2909)    |
|    len_d_3_pos          | 5.159 +/- 7.49 (3044)    |
|    len_d_4_pos          | 5.113 +/- 7.43 (1838)    |
|    len_d_unknown_neg    | 6.087 +/- 7.24 (41372)   |
|    len_neg              | 6.087 +/- 7.24 (41372)   |
|    len_pos              | 5.373 +/- 7.62 (37378)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (29587)   |
|    proven_d_2_pos       | 0.729 +/- 0.44 (2909)    |
|    proven_d_3_pos       | 0.739 +/- 0.44 (3044)    |
|    proven_d_4_pos       | 0.738 +/- 0.44 (1838)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (41372)   |
|    proven_neg           | 0.007 +/- 0.08 (41372)   |
|    proven_pos           | 0.723 +/- 0.45 (37378)   |
|    reward               | 0.730 +/- 0.68 (78750)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (29587)   |
|    reward_d_2_pos       | 0.459 +/- 0.89 (2909)    |
|    reward_d_3_pos       | 0.477 +/- 0.88 (3044)    |
|    reward_d_4_pos       | 0.476 +/- 0.88 (1838)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (41372)   |
|    reward_neg           | 0.987 +/- 0.16 (41372)   |
|    reward_pos           | 0.447 +/- 0.89 (37378)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 245                      |
|    time/fps             | 1987                     |
|    total_timesteps      | 458752                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.89s. FPS: 11355.68
Epoch 1/5. 
Losses: total 0.14539, value 0.29675, policy 0.00008, entropy -0.00058, approx_kl 0.00021 clip_fraction 0.00049. 
Epoch 2/5. 
Losses: total 0.13630, value 0.27608, policy 0.00001, entropy -0.00054, approx_kl 0.00198 clip_fraction 0.00070. 
Epoch 3/5. 
Losses: total 0.12479, value 0.25917, policy -0.00004, entropy -0.00051, approx_kl 0.00347 clip_fraction 0.00081. 
Epoch 4/5. 
Losses: total 0.08951, value 0.24469, policy -0.00007, entropy -0.00050, approx_kl 0.00423 clip_fraction 0.00091. 
Epoch 5/5. 
Losses: total 0.10181, value 0.23202, policy -0.00011, entropy -0.00050, approx_kl 0.00489 clip_fraction 0.00098. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.731, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.742                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.473                    |
|    len                  | 5.742 +/- 7.43 (84461)   |
|    len_d_1_pos          | 5.414 +/- 7.65 (31775)   |
|    len_d_2_pos          | 5.320 +/- 7.58 (3111)    |
|    len_d_3_pos          | 5.184 +/- 7.51 (3246)    |
|    len_d_4_pos          | 5.084 +/- 7.41 (1962)    |
|    len_d_unknown_neg    | 6.076 +/- 7.23 (44367)   |
|    len_neg              | 6.076 +/- 7.23 (44367)   |
|    len_pos              | 5.372 +/- 7.62 (40094)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (31775)   |
|    proven_d_2_pos       | 0.729 +/- 0.44 (3111)    |
|    proven_d_3_pos       | 0.738 +/- 0.44 (3246)    |
|    proven_d_4_pos       | 0.739 +/- 0.44 (1962)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (44367)   |
|    proven_neg           | 0.007 +/- 0.08 (44367)   |
|    proven_pos           | 0.724 +/- 0.45 (40094)   |
|    reward               | 0.731 +/- 0.68 (84461)   |
|    reward_d_1_pos       | 0.442 +/- 0.90 (31775)   |
|    reward_d_2_pos       | 0.459 +/- 0.89 (3111)    |
|    reward_d_3_pos       | 0.475 +/- 0.88 (3246)    |
|    reward_d_4_pos       | 0.478 +/- 0.88 (1962)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (44367)   |
|    reward_neg           | 0.987 +/- 0.16 (44367)   |
|    reward_pos           | 0.447 +/- 0.89 (40094)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 262                      |
|    time/fps             | 1985                     |
|    total_timesteps      | 491520                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt
[PPO] Rollout collected in 2.89s. FPS: 11356.54
Epoch 1/5. 
Losses: total 0.13735, value 0.31369, policy 0.00010, entropy -0.00064, approx_kl 0.00008 clip_fraction 0.00040. 
Epoch 2/5. 
Losses: total 0.14102, value 0.30534, policy 0.00001, entropy -0.00058, approx_kl 0.00053 clip_fraction 0.00044. 
Epoch 3/5. 
Losses: total 0.13124, value 0.29796, policy -0.00004, entropy -0.00053, approx_kl 0.00077 clip_fraction 0.00046. 
Epoch 4/5. 
Losses: total 0.12805, value 0.29139, policy -0.00006, entropy -0.00054, approx_kl 0.00086 clip_fraction 0.00050. 
Epoch 5/5. 
Losses: total 0.11650, value 0.28533, policy -0.00007, entropy -0.00053, approx_kl 0.00101 clip_fraction 0.00051. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.744 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.736                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.458                    |
|    len                  | 5.736 +/- 7.42 (90170)   |
|    len_d_1_pos          | 5.412 +/- 7.65 (33888)   |
|    len_d_2_pos          | 5.280 +/- 7.54 (3329)    |
|    len_d_3_pos          | 5.178 +/- 7.51 (3462)    |
|    len_d_4_pos          | 5.064 +/- 7.41 (2098)    |
|    len_d_unknown_neg    | 6.071 +/- 7.23 (47393)   |
|    len_neg              | 6.071 +/- 7.23 (47393)   |
|    len_pos              | 5.366 +/- 7.62 (42777)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (33888)   |
|    proven_d_2_pos       | 0.730 +/- 0.44 (3329)    |
|    proven_d_3_pos       | 0.739 +/- 0.44 (3462)    |
|    proven_d_4_pos       | 0.741 +/- 0.44 (2098)    |
|    proven_d_unknown_neg | 0.007 +/- 0.08 (47393)   |
|    proven_neg           | 0.007 +/- 0.08 (47393)   |
|    proven_pos           | 0.724 +/- 0.45 (42777)   |
|    reward               | 0.731 +/- 0.68 (90170)   |
|    reward_d_1_pos       | 0.442 +/- 0.90 (33888)   |
|    reward_d_2_pos       | 0.460 +/- 0.89 (3329)    |
|    reward_d_3_pos       | 0.477 +/- 0.88 (3462)    |
|    reward_d_4_pos       | 0.481 +/- 0.88 (2098)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (47393)   |
|    reward_neg           | 0.987 +/- 0.16 (47393)   |
|    reward_pos           | 0.448 +/- 0.89 (42777)   |
|    success_rate         | 0.347                    |
|    time/elapsed         | 278                      |
|    time/fps             | 1983                     |
|    total_timesteps      | 524288                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.940, best=0.948 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.970                    |
|    MRR                  | 0.940                    |
|    len_d_-1_pos         | 13.021                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.232                    |
|    len_pos              | 8.620                    |
|    mrr_mean             | 0.940                    |
|    proven_d_-1_pos      | 0.000                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.410                    |
|    reward_d_-1_pos      | 0.000                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.410                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_06_28.pt

[Checkpoint] Restoring best model at end of training...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_10_06_28.pt
Loaded best model info: {'metric': 'mrr_mean', 'best_value': 0.9478354454040527, 'timesteps': 4, 'explained_variance': 0.7171045541763306}

[2.5/3] Training neural bridge on validation data...
[NeuralBridge] Training neural bridge on 100 queries...
[NeuralBridge] Training on 200 queries, 11 candidates each
  Epoch 10/100: loss=-0.8040, alpha=0.4316
  Epoch 20/100: loss=-0.8083, alpha=0.4133
  Epoch 30/100: loss=-0.8120, alpha=0.3954
  Epoch 40/100: loss=-0.8153, alpha=0.3778
  Epoch 50/100: loss=-0.8182, alpha=0.3606
  Epoch 60/100: loss=-0.8208, alpha=0.3438
  Epoch 70/100: loss=-0.8231, alpha=0.3276
  Epoch 80/100: loss=-0.8251, alpha=0.3119
  Epoch 90/100: loss=-0.8270, alpha=0.2968
  Epoch 100/100: loss=-0.8286, alpha=0.2824
[NeuralBridge] Trained alpha: 0.2824

[3/3] Running evaluation...

Results: MRR=0.8382, Hits@1=0.7880, Hits@3=0.8700, Hits@10=0.9290
Proven: pos=0.3730, neg=0.0128
Writing results to /home/castellanoontiv/Batched_Env/kge_experiments/runs/averaged_runs/experiments.csv

============================================================
All experiments completed!
============================================================


[9/10] Running: KGE Filter Top-K (k=100)
==============================================
Grid search: 1 params, 1 experiments.

============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: wn18rr-250-128-torchrl
======================================================================
Training: wn18rr
Envs: 128, Steps: 256, Timesteps: 500000
Seed: 0
======================================================================

[1/3] Creating components...
[UnificationEngine] Capping max_fact_pairs from 34796 to 1000
[EnvOptimal] Compiled with mode=reduce-overhead, fullgraph=True

[2/3] Running training...
KGE Engine initialized with backend: pytorch (signature: torch_wn18rr_RotatE_1024_20260107_125531_s42)
[PPO] Compiled ranking_step (double-buffered) with mode=default

[Checkpoint] Loading existing model at start of training (load_model=True)...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_10_06_28.pt

============================================================
Initial evaluation (untrained model)
============================================================
Building model and loading weights...
Weights loaded successfully.
[Eval] Took 8.13 seconds

[Ranking] MRR: current=0.942, best=0.942 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.980                    |
|    MRR                  | 0.942                    |
|    len_d_-1_pos         | 13.688                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.518                    |
|    len_pos              | 8.940                    |
|    mrr_mean             | 0.942                    |
|    proven_d_-1_pos      | 0.000                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.007                    |
|    proven_pos           | 0.410                    |
|    reward_d_-1_pos      | 0.000                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.007                    |
|    reward_label_pos     | 0.410                    |
----------------------------------------------------

============================================================

[PPO] Rollout collected in 3.30s. FPS: 9932.56
Epoch 1/5. 
Losses: total 0.04399, value 0.10427, policy 0.00055, entropy -0.00056, approx_kl 0.07218 clip_fraction 0.00284. 
Epoch 2/5. 
Losses: total 0.02820, value 0.08424, policy 0.00053, entropy -0.00054, approx_kl 0.12109 clip_fraction 0.00371. 
Epoch 3/5. 
Losses: total 0.03044, value 0.07380, policy 0.00040, entropy -0.00048, approx_kl 0.13558 clip_fraction 0.00355. 
Epoch 4/5. 
Losses: total 0.02388, value 0.06720, policy 0.00029, entropy -0.00045, approx_kl 0.14385 clip_fraction 0.00365. 
Epoch 5/5. 
Losses: total 0.02027, value 0.06259, policy 0.00024, entropy -0.00044, approx_kl 0.16235 clip_fraction 0.00385. 
[PPO] Training completed in 14.30s
[Metrics] Reward (train): current=0.741, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.574                    |
|    ep_rew_mean          | 0.741                    |
|    explained_variance   | 0.771                    |
|    len                  | 5.574 +/- 7.31 (5655)    |
|    len_d_1_pos          | 5.089 +/- 7.39 (2174)    |
|    len_d_2_pos          | 5.000 +/- 7.20 (208)     |
|    len_d_3_pos          | 5.571 +/- 7.69 (210)     |
|    len_d_4_pos          | 5.344 +/- 7.47 (131)     |
|    len_d_unknown_neg    | 5.984 +/- 7.19 (2932)    |
|    len_neg              | 5.984 +/- 7.19 (2932)    |
|    len_pos              | 5.132 +/- 7.41 (2723)    |
|    proven_d_1_pos       | 0.740 +/- 0.44 (2174)    |
|    proven_d_2_pos       | 0.731 +/- 0.44 (208)     |
|    proven_d_3_pos       | 0.719 +/- 0.45 (210)     |
|    proven_d_4_pos       | 0.695 +/- 0.46 (131)     |
|    proven_d_unknown_neg | 0.004 +/- 0.06 (2932)    |
|    proven_neg           | 0.004 +/- 0.06 (2932)    |
|    proven_pos           | 0.736 +/- 0.44 (2723)    |
|    reward               | 0.741 +/- 0.67 (5655)    |
|    reward_d_1_pos       | 0.480 +/- 0.88 (2174)    |
|    reward_d_2_pos       | 0.462 +/- 0.89 (208)     |
|    reward_d_3_pos       | 0.438 +/- 0.90 (210)     |
|    reward_d_4_pos       | 0.389 +/- 0.92 (131)     |
|    reward_d_unknown_neg | 0.992 +/- 0.13 (2932)    |
|    reward_neg           | 0.992 +/- 0.13 (2932)    |
|    reward_pos           | 0.471 +/- 0.88 (2723)    |
|    success_rate         | 0.356                    |
|    time/elapsed         | 26                       |
|    time/fps             | 1238                     |
|    total_timesteps      | 32768                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.35s. FPS: 24229.50
Epoch 1/5. 
Losses: total 0.05012, value 0.12791, policy 0.00119, entropy -0.00103, approx_kl 0.06661 clip_fraction 0.00339. 
Epoch 2/5. 
Losses: total 0.04503, value 0.10174, policy 0.00090, entropy -0.00088, approx_kl 0.10830 clip_fraction 0.00420. 
Epoch 3/5. 
Losses: total 0.02204, value 0.08741, policy 0.00076, entropy -0.00079, approx_kl 0.14004 clip_fraction 0.00463. 
Epoch 4/5. 
Losses: total 0.02737, value 0.07849, policy 0.00064, entropy -0.00075, approx_kl 0.16104 clip_fraction 0.00474. 
Epoch 5/5. 
Losses: total 0.01989, value 0.07189, policy 0.00057, entropy -0.00073, approx_kl 0.18739 clip_fraction 0.00490. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.654                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.742                    |
|    len                  | 5.654 +/- 7.37 (11294)   |
|    len_d_1_pos          | 5.446 +/- 7.65 (4260)    |
|    len_d_2_pos          | 4.557 +/- 6.94 (431)     |
|    len_d_3_pos          | 5.671 +/- 7.85 (431)     |
|    len_d_4_pos          | 5.258 +/- 7.41 (275)     |
|    len_d_unknown_neg    | 5.901 +/- 7.13 (5897)    |
|    len_neg              | 5.901 +/- 7.13 (5897)    |
|    len_pos              | 5.383 +/- 7.61 (5397)    |
|    proven_d_1_pos       | 0.720 +/- 0.45 (4260)    |
|    proven_d_2_pos       | 0.759 +/- 0.43 (431)     |
|    proven_d_3_pos       | 0.722 +/- 0.45 (431)     |
|    proven_d_4_pos       | 0.709 +/- 0.45 (275)     |
|    proven_d_unknown_neg | 0.005 +/- 0.07 (5897)    |
|    proven_neg           | 0.005 +/- 0.07 (5897)    |
|    proven_pos           | 0.723 +/- 0.45 (5397)    |
|    reward               | 0.729 +/- 0.68 (11294)   |
|    reward_d_1_pos       | 0.440 +/- 0.90 (4260)    |
|    reward_d_2_pos       | 0.517 +/- 0.86 (431)     |
|    reward_d_3_pos       | 0.443 +/- 0.90 (431)     |
|    reward_d_4_pos       | 0.418 +/- 0.91 (275)     |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (5897)    |
|    reward_neg           | 0.989 +/- 0.15 (5897)    |
|    reward_pos           | 0.445 +/- 0.90 (5397)    |
|    success_rate         | 0.348                    |
|    time/elapsed         | 41                       |
|    time/fps             | 2208                     |
|    total_timesteps      | 65536                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.36s. FPS: 24134.10
Epoch 1/5. 
Losses: total 0.04427, value 0.12507, policy 0.00086, entropy -0.00062, approx_kl 0.03190 clip_fraction 0.00201. 
Epoch 2/5. 
Losses: total 0.03788, value 0.10082, policy 0.00108, entropy -0.00058, approx_kl 0.09804 clip_fraction 0.00304. 
Epoch 3/5. 
Losses: total 0.02486, value 0.08756, policy 0.00116, entropy -0.00052, approx_kl 0.13763 clip_fraction 0.00351. 
Epoch 4/5. 
Losses: total 0.03246, value 0.07912, policy 0.00099, entropy -0.00051, approx_kl 0.12277 clip_fraction 0.00336. 
Epoch 5/5. 
Losses: total 0.02664, value 0.07296, policy 0.00086, entropy -0.00047, approx_kl 0.11847 clip_fraction 0.00322. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.727, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.669                    |
|    ep_rew_mean          | 0.727                    |
|    explained_variance   | 0.761                    |
|    len                  | 5.669 +/- 7.38 (16949)   |
|    len_d_1_pos          | 5.443 +/- 7.65 (6404)    |
|    len_d_2_pos          | 5.131 +/- 7.46 (628)     |
|    len_d_3_pos          | 5.576 +/- 7.79 (641)     |
|    len_d_4_pos          | 5.684 +/- 7.73 (396)     |
|    len_d_unknown_neg    | 5.876 +/- 7.11 (8880)    |
|    len_neg              | 5.876 +/- 7.11 (8880)    |
|    len_pos              | 5.441 +/- 7.65 (8069)    |
|    proven_d_1_pos       | 0.719 +/- 0.45 (6404)    |
|    proven_d_2_pos       | 0.736 +/- 0.44 (628)     |
|    proven_d_3_pos       | 0.722 +/- 0.45 (641)     |
|    proven_d_4_pos       | 0.694 +/- 0.46 (396)     |
|    proven_d_unknown_neg | 0.006 +/- 0.07 (8880)    |
|    proven_neg           | 0.006 +/- 0.07 (8880)    |
|    proven_pos           | 0.719 +/- 0.45 (8069)    |
|    reward               | 0.727 +/- 0.69 (16949)   |
|    reward_d_1_pos       | 0.438 +/- 0.90 (6404)    |
|    reward_d_2_pos       | 0.471 +/- 0.88 (628)     |
|    reward_d_3_pos       | 0.445 +/- 0.90 (641)     |
|    reward_d_4_pos       | 0.389 +/- 0.92 (396)     |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (8880)    |
|    reward_neg           | 0.989 +/- 0.15 (8880)    |
|    reward_pos           | 0.439 +/- 0.90 (8069)    |
|    success_rate         | 0.345                    |
|    time/elapsed         | 56                       |
|    time/fps             | 2202                     |
|    total_timesteps      | 98304                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.37s. FPS: 23885.42
Epoch 1/5. 
Losses: total 0.04343, value 0.12786, policy 0.00041, entropy -0.00065, approx_kl 0.01930 clip_fraction 0.00159. 
Epoch 2/5. 
Losses: total 0.04078, value 0.10154, policy 0.00071, entropy -0.00063, approx_kl 0.04165 clip_fraction 0.00230. 
Epoch 3/5. 
Losses: total 0.03281, value 0.08865, policy 0.00067, entropy -0.00064, approx_kl 0.05889 clip_fraction 0.00270. 
Epoch 4/5. 
Losses: total 0.02005, value 0.08054, policy 0.00068, entropy -0.00060, approx_kl 0.07955 clip_fraction 0.00296. 
Epoch 5/5. 
Losses: total 0.02997, value 0.07461, policy 0.00060, entropy -0.00059, approx_kl 0.10810 clip_fraction 0.00320. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.662                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.740                    |
|    len                  | 5.662 +/- 7.37 (22684)   |
|    len_d_1_pos          | 5.370 +/- 7.60 (8551)    |
|    len_d_2_pos          | 5.227 +/- 7.53 (827)     |
|    len_d_3_pos          | 5.458 +/- 7.71 (862)     |
|    len_d_4_pos          | 5.614 +/- 7.72 (534)     |
|    len_d_unknown_neg    | 5.918 +/- 7.14 (11910)   |
|    len_neg              | 5.918 +/- 7.14 (11910)   |
|    len_pos              | 5.378 +/- 7.61 (10774)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (8551)    |
|    proven_d_2_pos       | 0.734 +/- 0.44 (827)     |
|    proven_d_3_pos       | 0.730 +/- 0.44 (862)     |
|    proven_d_4_pos       | 0.699 +/- 0.46 (534)     |
|    proven_d_unknown_neg | 0.005 +/- 0.07 (11910)   |
|    proven_neg           | 0.005 +/- 0.07 (11910)   |
|    proven_pos           | 0.723 +/- 0.45 (10774)   |
|    reward               | 0.731 +/- 0.68 (22684)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (8551)    |
|    reward_d_2_pos       | 0.468 +/- 0.88 (827)     |
|    reward_d_3_pos       | 0.459 +/- 0.89 (862)     |
|    reward_d_4_pos       | 0.397 +/- 0.92 (534)     |
|    reward_d_unknown_neg | 0.990 +/- 0.14 (11910)   |
|    reward_neg           | 0.990 +/- 0.14 (11910)   |
|    reward_pos           | 0.446 +/- 0.90 (10774)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 71                       |
|    time/fps             | 2198                     |
|    total_timesteps      | 131072                   |
----------------------------------------------------

[Eval] Took 1.32 seconds

[Ranking] MRR: current=0.951, best=0.951 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.920                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.985                    |
|    MRR                  | 0.951                    |
|    len_d_-1_pos         | 13.792                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.552                    |
|    len_pos              | 8.990                    |
|    mrr_mean             | 0.951                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] New best eval model saved to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_10_12_10.pt (mrr_mean=0.9512)
[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.35s. FPS: 24184.87
Epoch 1/5. 
Losses: total 0.10117, value 0.25288, policy 0.00075, entropy -0.00098, approx_kl 0.03630 clip_fraction 0.00259. 
Epoch 2/5. 
Losses: total 0.06462, value 0.19758, policy 0.00071, entropy -0.00080, approx_kl 0.05790 clip_fraction 0.00305. 
Epoch 3/5. 
Losses: total 0.05304, value 0.16673, policy 0.00070, entropy -0.00081, approx_kl 0.09118 clip_fraction 0.00379. 
Epoch 4/5. 
Losses: total 0.04249, value 0.14608, policy 0.00062, entropy -0.00079, approx_kl 0.09788 clip_fraction 0.00389. 
Epoch 5/5. 
Losses: total 0.04154, value 0.13121, policy 0.00056, entropy -0.00080, approx_kl 0.11767 clip_fraction 0.00424. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.714                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.454                    |
|    len                  | 5.714 +/- 7.40 (28172)   |
|    len_d_1_pos          | 5.435 +/- 7.65 (10601)   |
|    len_d_2_pos          | 5.117 +/- 7.46 (1041)    |
|    len_d_3_pos          | 5.543 +/- 7.75 (1070)    |
|    len_d_4_pos          | 5.462 +/- 7.61 (658)     |
|    len_d_unknown_neg    | 5.979 +/- 7.18 (14802)   |
|    len_neg              | 5.979 +/- 7.18 (14802)   |
|    len_pos              | 5.420 +/- 7.64 (13370)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (10601)   |
|    proven_d_2_pos       | 0.740 +/- 0.44 (1041)    |
|    proven_d_3_pos       | 0.721 +/- 0.45 (1070)    |
|    proven_d_4_pos       | 0.710 +/- 0.45 (658)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (14802)   |
|    proven_neg           | 0.006 +/- 0.08 (14802)   |
|    proven_pos           | 0.721 +/- 0.45 (13370)   |
|    reward               | 0.729 +/- 0.68 (28172)   |
|    reward_d_1_pos       | 0.440 +/- 0.90 (10601)   |
|    reward_d_2_pos       | 0.479 +/- 0.88 (1041)    |
|    reward_d_3_pos       | 0.443 +/- 0.90 (1070)    |
|    reward_d_4_pos       | 0.419 +/- 0.91 (658)     |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (14802)   |
|    reward_neg           | 0.989 +/- 0.15 (14802)   |
|    reward_pos           | 0.442 +/- 0.90 (13370)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 87                       |
|    time/fps             | 2016                     |
|    total_timesteps      | 163840                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.36s. FPS: 24107.35
Epoch 1/5. 
Losses: total 0.08808, value 0.24984, policy 0.00032, entropy -0.00087, approx_kl 0.03303 clip_fraction 0.00226. 
Epoch 2/5. 
Losses: total 0.06102, value 0.19380, policy 0.00042, entropy -0.00085, approx_kl 0.08355 clip_fraction 0.00333. 
Epoch 3/5. 
Losses: total 0.05837, value 0.16234, policy 0.00031, entropy -0.00083, approx_kl 0.07907 clip_fraction 0.00331. 
Epoch 4/5. 
Losses: total 0.04163, value 0.14183, policy 0.00029, entropy -0.00079, approx_kl 0.08110 clip_fraction 0.00336. 
Epoch 5/5. 
Losses: total 0.03373, value 0.12720, policy 0.00027, entropy -0.00074, approx_kl 0.08668 clip_fraction 0.00342. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.714                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.458                    |
|    len                  | 5.714 +/- 7.40 (33798)   |
|    len_d_1_pos          | 5.433 +/- 7.65 (12687)   |
|    len_d_2_pos          | 5.134 +/- 7.49 (1250)    |
|    len_d_3_pos          | 5.337 +/- 7.61 (1286)    |
|    len_d_4_pos          | 5.263 +/- 7.46 (797)     |
|    len_d_unknown_neg    | 6.004 +/- 7.19 (17778)   |
|    len_neg              | 6.004 +/- 7.19 (17778)   |
|    len_pos              | 5.393 +/- 7.62 (16020)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (12687)   |
|    proven_d_2_pos       | 0.740 +/- 0.44 (1250)    |
|    proven_d_3_pos       | 0.731 +/- 0.44 (1286)    |
|    proven_d_4_pos       | 0.720 +/- 0.45 (797)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (17778)   |
|    proven_neg           | 0.006 +/- 0.08 (17778)   |
|    proven_pos           | 0.722 +/- 0.45 (16020)   |
|    reward               | 0.730 +/- 0.68 (33798)   |
|    reward_d_1_pos       | 0.439 +/- 0.90 (12687)   |
|    reward_d_2_pos       | 0.480 +/- 0.88 (1250)    |
|    reward_d_3_pos       | 0.462 +/- 0.89 (1286)    |
|    reward_d_4_pos       | 0.440 +/- 0.90 (797)     |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (17778)   |
|    reward_neg           | 0.988 +/- 0.15 (17778)   |
|    reward_pos           | 0.444 +/- 0.90 (16020)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 102                      |
|    time/fps             | 2198                     |
|    total_timesteps      | 196608                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.36s. FPS: 24029.88
Epoch 1/5. 
Losses: total 0.09935, value 0.25913, policy 0.00031, entropy -0.00073, approx_kl 0.00709 clip_fraction 0.00171. 
Epoch 2/5. 
Losses: total 0.06272, value 0.20571, policy 0.00031, entropy -0.00063, approx_kl 0.01729 clip_fraction 0.00195. 
Epoch 3/5. 
Losses: total 0.05473, value 0.17335, policy 0.00028, entropy -0.00057, approx_kl 0.02279 clip_fraction 0.00214. 
Epoch 4/5. 
Losses: total 0.04318, value 0.15159, policy 0.00024, entropy -0.00053, approx_kl 0.02477 clip_fraction 0.00214. 
Epoch 5/5. 
Losses: total 0.03452, value 0.13604, policy 0.00022, entropy -0.00053, approx_kl 0.02742 clip_fraction 0.00220. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.713                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.462                    |
|    len                  | 5.713 +/- 7.41 (39477)   |
|    len_d_1_pos          | 5.445 +/- 7.66 (14828)   |
|    len_d_2_pos          | 5.281 +/- 7.60 (1440)    |
|    len_d_3_pos          | 5.282 +/- 7.59 (1511)    |
|    len_d_4_pos          | 5.161 +/- 7.43 (950)     |
|    len_d_unknown_neg    | 5.991 +/- 7.18 (20748)   |
|    len_neg              | 5.991 +/- 7.18 (20748)   |
|    len_pos              | 5.405 +/- 7.64 (18729)   |
|    proven_d_1_pos       | 0.719 +/- 0.45 (14828)   |
|    proven_d_2_pos       | 0.732 +/- 0.44 (1440)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (1511)    |
|    proven_d_4_pos       | 0.729 +/- 0.44 (950)     |
|    proven_d_unknown_neg | 0.005 +/- 0.07 (20748)   |
|    proven_neg           | 0.005 +/- 0.07 (20748)   |
|    proven_pos           | 0.722 +/- 0.45 (18729)   |
|    reward               | 0.730 +/- 0.68 (39477)   |
|    reward_d_1_pos       | 0.438 +/- 0.90 (14828)   |
|    reward_d_2_pos       | 0.464 +/- 0.89 (1440)    |
|    reward_d_3_pos       | 0.467 +/- 0.88 (1511)    |
|    reward_d_4_pos       | 0.459 +/- 0.89 (950)     |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (20748)   |
|    reward_neg           | 0.989 +/- 0.15 (20748)   |
|    reward_pos           | 0.443 +/- 0.90 (18729)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 117                      |
|    time/fps             | 2196                     |
|    total_timesteps      | 229376                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.36s. FPS: 24124.29
Epoch 1/5. 
Losses: total 0.10958, value 0.26433, policy 0.00048, entropy -0.00079, approx_kl 0.00948 clip_fraction 0.00162. 
Epoch 2/5. 
Losses: total 0.06191, value 0.21254, policy 0.00048, entropy -0.00071, approx_kl 0.02580 clip_fraction 0.00215. 
Epoch 3/5. 
Losses: total 0.04451, value 0.18027, policy 0.00039, entropy -0.00066, approx_kl 0.03264 clip_fraction 0.00234. 
Epoch 4/5. 
Losses: total 0.04775, value 0.15877, policy 0.00037, entropy -0.00066, approx_kl 0.03616 clip_fraction 0.00246. 
Epoch 5/5. 
Losses: total 0.03651, value 0.14344, policy 0.00031, entropy -0.00062, approx_kl 0.04621 clip_fraction 0.00269. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.721                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.448                    |
|    len                  | 5.721 +/- 7.41 (45097)   |
|    len_d_1_pos          | 5.419 +/- 7.64 (16913)   |
|    len_d_2_pos          | 5.239 +/- 7.56 (1655)    |
|    len_d_3_pos          | 5.257 +/- 7.57 (1733)    |
|    len_d_4_pos          | 5.237 +/- 7.48 (1082)    |
|    len_d_unknown_neg    | 6.026 +/- 7.20 (23714)   |
|    len_neg              | 6.026 +/- 7.20 (23714)   |
|    len_pos              | 5.383 +/- 7.62 (21383)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (16913)   |
|    proven_d_2_pos       | 0.733 +/- 0.44 (1655)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (1733)    |
|    proven_d_4_pos       | 0.725 +/- 0.45 (1082)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (23714)   |
|    proven_neg           | 0.006 +/- 0.08 (23714)   |
|    proven_pos           | 0.722 +/- 0.45 (21383)   |
|    reward               | 0.730 +/- 0.68 (45097)   |
|    reward_d_1_pos       | 0.439 +/- 0.90 (16913)   |
|    reward_d_2_pos       | 0.466 +/- 0.88 (1655)    |
|    reward_d_3_pos       | 0.467 +/- 0.88 (1733)    |
|    reward_d_4_pos       | 0.449 +/- 0.89 (1082)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (23714)   |
|    reward_neg           | 0.988 +/- 0.15 (23714)   |
|    reward_pos           | 0.444 +/- 0.90 (21383)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 132                      |
|    time/fps             | 2193                     |
|    total_timesteps      | 262144                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.940, best=0.951 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.965                    |
|    MRR                  | 0.940                    |
|    len_d_-1_pos         | 13.042                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.272                    |
|    len_pos              | 8.630                    |
|    mrr_mean             | 0.940                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.008                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.008                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.36s. FPS: 24107.81
Epoch 1/5. 
Losses: total 0.10592, value 0.29045, policy 0.00032, entropy -0.00054, approx_kl 0.00692 clip_fraction 0.00125. 
Epoch 2/5. 
Losses: total 0.07368, value 0.23213, policy 0.00020, entropy -0.00047, approx_kl 0.01296 clip_fraction 0.00148. 
Epoch 3/5. 
Losses: total 0.04518, value 0.19621, policy 0.00011, entropy -0.00049, approx_kl 0.01808 clip_fraction 0.00174. 
Epoch 4/5. 
Losses: total 0.04999, value 0.17196, policy 0.00007, entropy -0.00051, approx_kl 0.02309 clip_fraction 0.00192. 
Epoch 5/5. 
Losses: total 0.04476, value 0.15471, policy 0.00006, entropy -0.00048, approx_kl 0.02635 clip_fraction 0.00200. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.729, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.731                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.385                    |
|    len                  | 5.731 +/- 7.42 (50673)   |
|    len_d_1_pos          | 5.453 +/- 7.66 (18977)   |
|    len_d_2_pos          | 5.194 +/- 7.53 (1872)    |
|    len_d_3_pos          | 5.210 +/- 7.55 (1948)    |
|    len_d_4_pos          | 5.186 +/- 7.43 (1224)    |
|    len_d_unknown_neg    | 6.029 +/- 7.20 (26652)   |
|    len_neg              | 6.029 +/- 7.20 (26652)   |
|    len_pos              | 5.400 +/- 7.63 (24021)   |
|    proven_d_1_pos       | 0.717 +/- 0.45 (18977)   |
|    proven_d_2_pos       | 0.735 +/- 0.44 (1872)    |
|    proven_d_3_pos       | 0.734 +/- 0.44 (1948)    |
|    proven_d_4_pos       | 0.728 +/- 0.45 (1224)    |
|    proven_d_unknown_neg | 0.006 +/- 0.07 (26652)   |
|    proven_neg           | 0.006 +/- 0.07 (26652)   |
|    proven_pos           | 0.721 +/- 0.45 (24021)   |
|    reward               | 0.729 +/- 0.68 (50673)   |
|    reward_d_1_pos       | 0.435 +/- 0.90 (18977)   |
|    reward_d_2_pos       | 0.469 +/- 0.88 (1872)    |
|    reward_d_3_pos       | 0.468 +/- 0.88 (1948)    |
|    reward_d_4_pos       | 0.456 +/- 0.89 (1224)    |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (26652)   |
|    reward_neg           | 0.989 +/- 0.15 (26652)   |
|    reward_pos           | 0.441 +/- 0.90 (24021)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 148                      |
|    time/fps             | 2018                     |
|    total_timesteps      | 294912                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.37s. FPS: 24001.95
Epoch 1/5. 
Losses: total 0.11507, value 0.28179, policy 0.00032, entropy -0.00072, approx_kl 0.00749 clip_fraction 0.00143. 
Epoch 2/5. 
Losses: total 0.06668, value 0.22833, policy 0.00019, entropy -0.00070, approx_kl 0.01674 clip_fraction 0.00162. 
Epoch 3/5. 
Losses: total 0.05775, value 0.19357, policy 0.00012, entropy -0.00068, approx_kl 0.02355 clip_fraction 0.00172. 
Epoch 4/5. 
Losses: total 0.04566, value 0.16970, policy 0.00009, entropy -0.00064, approx_kl 0.02913 clip_fraction 0.00189. 
Epoch 5/5. 
Losses: total 0.03705, value 0.15229, policy 0.00003, entropy -0.00062, approx_kl 0.03401 clip_fraction 0.00203. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.729, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.744                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.418                    |
|    len                  | 5.744 +/- 7.42 (56188)   |
|    len_d_1_pos          | 5.458 +/- 7.66 (21024)   |
|    len_d_2_pos          | 5.281 +/- 7.57 (2067)    |
|    len_d_3_pos          | 5.249 +/- 7.56 (2176)    |
|    len_d_4_pos          | 5.125 +/- 7.41 (1365)    |
|    len_d_unknown_neg    | 6.045 +/- 7.21 (29556)   |
|    len_neg              | 6.045 +/- 7.21 (29556)   |
|    len_pos              | 5.410 +/- 7.64 (26632)   |
|    proven_d_1_pos       | 0.717 +/- 0.45 (21024)   |
|    proven_d_2_pos       | 0.729 +/- 0.44 (2067)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (2176)    |
|    proven_d_4_pos       | 0.733 +/- 0.44 (1365)    |
|    proven_d_unknown_neg | 0.005 +/- 0.07 (29556)   |
|    proven_neg           | 0.005 +/- 0.07 (29556)   |
|    proven_pos           | 0.720 +/- 0.45 (26632)   |
|    reward               | 0.729 +/- 0.68 (56188)   |
|    reward_d_1_pos       | 0.433 +/- 0.90 (21024)   |
|    reward_d_2_pos       | 0.458 +/- 0.89 (2067)    |
|    reward_d_3_pos       | 0.466 +/- 0.88 (2176)    |
|    reward_d_4_pos       | 0.467 +/- 0.88 (1365)    |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (29556)   |
|    reward_neg           | 0.989 +/- 0.15 (29556)   |
|    reward_pos           | 0.440 +/- 0.90 (26632)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 163                      |
|    time/fps             | 2193                     |
|    total_timesteps      | 327680                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.36s. FPS: 24110.29
Epoch 1/5. 
Losses: total 0.10575, value 0.27791, policy 0.00003, entropy -0.00077, approx_kl 0.02749 clip_fraction 0.00201. 
Epoch 2/5. 
Losses: total 0.07757, value 0.22951, policy 0.00001, entropy -0.00070, approx_kl 0.02694 clip_fraction 0.00221. 
Epoch 3/5. 
Losses: total 0.07023, value 0.19716, policy -0.00001, entropy -0.00063, approx_kl 0.02874 clip_fraction 0.00231. 
Epoch 4/5. 
Losses: total 0.04874, value 0.17470, policy -0.00002, entropy -0.00061, approx_kl 0.04050 clip_fraction 0.00259. 
Epoch 5/5. 
Losses: total 0.04437, value 0.15841, policy -0.00004, entropy -0.00058, approx_kl 0.05690 clip_fraction 0.00285. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.744                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.432                    |
|    len                  | 5.744 +/- 7.42 (61843)   |
|    len_d_1_pos          | 5.434 +/- 7.65 (23150)   |
|    len_d_2_pos          | 5.250 +/- 7.55 (2297)    |
|    len_d_3_pos          | 5.329 +/- 7.61 (2385)    |
|    len_d_4_pos          | 5.203 +/- 7.48 (1485)    |
|    len_d_unknown_neg    | 6.054 +/- 7.22 (32526)   |
|    len_neg              | 6.054 +/- 7.22 (32526)   |
|    len_pos              | 5.400 +/- 7.63 (29317)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (23150)   |
|    proven_d_2_pos       | 0.730 +/- 0.44 (2297)    |
|    proven_d_3_pos       | 0.727 +/- 0.45 (2385)    |
|    proven_d_4_pos       | 0.730 +/- 0.44 (1485)    |
|    proven_d_unknown_neg | 0.005 +/- 0.07 (32526)   |
|    proven_neg           | 0.005 +/- 0.07 (32526)   |
|    proven_pos           | 0.721 +/- 0.45 (29317)   |
|    reward               | 0.729 +/- 0.68 (61843)   |
|    reward_d_1_pos       | 0.437 +/- 0.90 (23150)   |
|    reward_d_2_pos       | 0.459 +/- 0.89 (2297)    |
|    reward_d_3_pos       | 0.453 +/- 0.89 (2385)    |
|    reward_d_4_pos       | 0.460 +/- 0.89 (1485)    |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (32526)   |
|    reward_neg           | 0.989 +/- 0.15 (32526)   |
|    reward_pos           | 0.441 +/- 0.90 (29317)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 178                      |
|    time/fps             | 2192                     |
|    total_timesteps      | 360448                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.36s. FPS: 24128.41
Epoch 1/5. 
Losses: total 0.11542, value 0.30230, policy 0.00032, entropy -0.00084, approx_kl 0.00512 clip_fraction 0.00134. 
Epoch 2/5. 
Losses: total 0.09542, value 0.25739, policy 0.00017, entropy -0.00077, approx_kl 0.00910 clip_fraction 0.00159. 
Epoch 3/5. 
Losses: total 0.07479, value 0.22518, policy 0.00007, entropy -0.00071, approx_kl 0.01005 clip_fraction 0.00165. 
Epoch 4/5. 
Losses: total 0.07356, value 0.20136, policy -0.00001, entropy -0.00065, approx_kl 0.01242 clip_fraction 0.00171. 
Epoch 5/5. 
Losses: total 0.04692, value 0.18339, policy -0.00007, entropy -0.00063, approx_kl 0.01729 clip_fraction 0.00182. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.736                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.399                    |
|    len                  | 5.736 +/- 7.42 (67564)   |
|    len_d_1_pos          | 5.426 +/- 7.65 (25333)   |
|    len_d_2_pos          | 5.319 +/- 7.59 (2478)    |
|    len_d_3_pos          | 5.302 +/- 7.58 (2628)    |
|    len_d_4_pos          | 5.142 +/- 7.43 (1613)    |
|    len_d_unknown_neg    | 6.045 +/- 7.21 (35512)   |
|    len_neg              | 6.045 +/- 7.21 (35512)   |
|    len_pos              | 5.393 +/- 7.63 (32052)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (25333)   |
|    proven_d_2_pos       | 0.726 +/- 0.45 (2478)    |
|    proven_d_3_pos       | 0.729 +/- 0.44 (2628)    |
|    proven_d_4_pos       | 0.734 +/- 0.44 (1613)    |
|    proven_d_unknown_neg | 0.006 +/- 0.07 (35512)   |
|    proven_neg           | 0.006 +/- 0.07 (35512)   |
|    proven_pos           | 0.722 +/- 0.45 (32052)   |
|    reward               | 0.730 +/- 0.68 (67564)   |
|    reward_d_1_pos       | 0.439 +/- 0.90 (25333)   |
|    reward_d_2_pos       | 0.451 +/- 0.89 (2478)    |
|    reward_d_3_pos       | 0.458 +/- 0.89 (2628)    |
|    reward_d_4_pos       | 0.468 +/- 0.88 (1613)    |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (35512)   |
|    reward_neg           | 0.989 +/- 0.15 (35512)   |
|    reward_pos           | 0.443 +/- 0.90 (32052)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 193                      |
|    time/fps             | 2192                     |
|    total_timesteps      | 393216                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.950, best=0.951 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.920                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.975                    |
|    MRR                  | 0.950                    |
|    len_d_-1_pos         | 13.042                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.152                    |
|    len_pos              | 8.630                    |
|    mrr_mean             | 0.950                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.010                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.010                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.36s. FPS: 24135.59
Epoch 1/5. 
Losses: total 0.15408, value 0.30563, policy 0.00088, entropy -0.00095, approx_kl 0.00180 clip_fraction 0.00125. 
Epoch 2/5. 
Losses: total 0.10409, value 0.26568, policy 0.00050, entropy -0.00081, approx_kl 0.00631 clip_fraction 0.00145. 
Epoch 3/5. 
Losses: total 0.08365, value 0.23661, policy 0.00028, entropy -0.00077, approx_kl 0.00924 clip_fraction 0.00162. 
Epoch 4/5. 
Losses: total 0.07204, value 0.21428, policy 0.00014, entropy -0.00072, approx_kl 0.01084 clip_fraction 0.00169. 
Epoch 5/5. 
Losses: total 0.06860, value 0.19663, policy 0.00004, entropy -0.00070, approx_kl 0.01279 clip_fraction 0.00179. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.730, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.730                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.410                    |
|    len                  | 5.730 +/- 7.41 (73276)   |
|    len_d_1_pos          | 5.417 +/- 7.64 (27476)   |
|    len_d_2_pos          | 5.351 +/- 7.59 (2677)    |
|    len_d_3_pos          | 5.212 +/- 7.52 (2874)    |
|    len_d_4_pos          | 5.220 +/- 7.49 (1741)    |
|    len_d_unknown_neg    | 6.042 +/- 7.20 (38508)   |
|    len_neg              | 6.042 +/- 7.20 (38508)   |
|    len_pos              | 5.385 +/- 7.62 (34768)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (27476)   |
|    proven_d_2_pos       | 0.722 +/- 0.45 (2677)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (2874)    |
|    proven_d_4_pos       | 0.730 +/- 0.44 (1741)    |
|    proven_d_unknown_neg | 0.006 +/- 0.07 (38508)   |
|    proven_neg           | 0.006 +/- 0.07 (38508)   |
|    proven_pos           | 0.722 +/- 0.45 (34768)   |
|    reward               | 0.730 +/- 0.68 (73276)   |
|    reward_d_1_pos       | 0.440 +/- 0.90 (27476)   |
|    reward_d_2_pos       | 0.444 +/- 0.90 (2677)    |
|    reward_d_3_pos       | 0.469 +/- 0.88 (2874)    |
|    reward_d_4_pos       | 0.460 +/- 0.89 (1741)    |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (38508)   |
|    reward_neg           | 0.989 +/- 0.15 (38508)   |
|    reward_pos           | 0.444 +/- 0.90 (34768)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 209                      |
|    time/fps             | 2014                     |
|    total_timesteps      | 425984                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.36s. FPS: 24111.10
Epoch 1/5. 
Losses: total 0.13566, value 0.30866, policy 0.00014, entropy -0.00067, approx_kl 0.00104 clip_fraction 0.00061. 
Epoch 2/5. 
Losses: total 0.10651, value 0.27799, policy 0.00009, entropy -0.00059, approx_kl 0.00314 clip_fraction 0.00073. 
Epoch 3/5. 
Losses: total 0.10993, value 0.25411, policy 0.00003, entropy -0.00056, approx_kl 0.00408 clip_fraction 0.00083. 
Epoch 4/5. 
Losses: total 0.09244, value 0.23455, policy -0.00003, entropy -0.00052, approx_kl 0.00548 clip_fraction 0.00093. 
Epoch 5/5. 
Losses: total 0.06676, value 0.21822, policy -0.00007, entropy -0.00051, approx_kl 0.00661 clip_fraction 0.00101. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.730                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.414                    |
|    len                  | 5.730 +/- 7.41 (78945)   |
|    len_d_1_pos          | 5.391 +/- 7.62 (29638)   |
|    len_d_2_pos          | 5.439 +/- 7.65 (2857)    |
|    len_d_3_pos          | 5.182 +/- 7.50 (3088)    |
|    len_d_4_pos          | 5.229 +/- 7.51 (1859)    |
|    len_d_unknown_neg    | 6.056 +/- 7.21 (41503)   |
|    len_neg              | 6.056 +/- 7.21 (41503)   |
|    len_pos              | 5.369 +/- 7.61 (37442)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (29638)   |
|    proven_d_2_pos       | 0.718 +/- 0.45 (2857)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (3088)    |
|    proven_d_4_pos       | 0.731 +/- 0.44 (1859)    |
|    proven_d_unknown_neg | 0.006 +/- 0.07 (41503)   |
|    proven_neg           | 0.006 +/- 0.07 (41503)   |
|    proven_pos           | 0.722 +/- 0.45 (37442)   |
|    reward               | 0.731 +/- 0.68 (78945)   |
|    reward_d_1_pos       | 0.442 +/- 0.90 (29638)   |
|    reward_d_2_pos       | 0.436 +/- 0.90 (2857)    |
|    reward_d_3_pos       | 0.470 +/- 0.88 (3088)    |
|    reward_d_4_pos       | 0.461 +/- 0.89 (1859)    |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (41503)   |
|    reward_neg           | 0.989 +/- 0.15 (41503)   |
|    reward_pos           | 0.445 +/- 0.90 (37442)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 224                      |
|    time/fps             | 2188                     |
|    total_timesteps      | 458752                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.36s. FPS: 24046.59
Epoch 1/5. 
Losses: total 0.16012, value 0.29882, policy 0.00024, entropy -0.00071, approx_kl 0.00110 clip_fraction 0.00082. 
Epoch 2/5. 
Losses: total 0.12497, value 0.27900, policy 0.00013, entropy -0.00067, approx_kl 0.00294 clip_fraction 0.00107. 
Epoch 3/5. 
Losses: total 0.12596, value 0.26216, policy 0.00007, entropy -0.00064, approx_kl 0.00378 clip_fraction 0.00116. 
Epoch 4/5. 
Losses: total 0.09052, value 0.24783, policy 0.00002, entropy -0.00060, approx_kl 0.00439 clip_fraction 0.00122. 
Epoch 5/5. 
Losses: total 0.09657, value 0.23544, policy -0.00002, entropy -0.00058, approx_kl 0.00481 clip_fraction 0.00128. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.726                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.468                    |
|    len                  | 5.726 +/- 7.41 (84638)   |
|    len_d_1_pos          | 5.388 +/- 7.62 (31773)   |
|    len_d_2_pos          | 5.366 +/- 7.62 (3090)    |
|    len_d_3_pos          | 5.179 +/- 7.50 (3295)    |
|    len_d_4_pos          | 5.230 +/- 7.52 (1980)    |
|    len_d_unknown_neg    | 6.054 +/- 7.21 (44500)   |
|    len_neg              | 6.054 +/- 7.21 (44500)   |
|    len_pos              | 5.361 +/- 7.61 (40138)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (31773)   |
|    proven_d_2_pos       | 0.724 +/- 0.45 (3090)    |
|    proven_d_3_pos       | 0.735 +/- 0.44 (3295)    |
|    proven_d_4_pos       | 0.730 +/- 0.44 (1980)    |
|    proven_d_unknown_neg | 0.006 +/- 0.07 (44500)   |
|    proven_neg           | 0.006 +/- 0.07 (44500)   |
|    proven_pos           | 0.723 +/- 0.45 (40138)   |
|    reward               | 0.731 +/- 0.68 (84638)   |
|    reward_d_1_pos       | 0.442 +/- 0.90 (31773)   |
|    reward_d_2_pos       | 0.447 +/- 0.89 (3090)    |
|    reward_d_3_pos       | 0.470 +/- 0.88 (3295)    |
|    reward_d_4_pos       | 0.461 +/- 0.89 (1980)    |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (44500)   |
|    reward_neg           | 0.989 +/- 0.15 (44500)   |
|    reward_pos           | 0.446 +/- 0.90 (40138)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 239                      |
|    time/fps             | 2186                     |
|    total_timesteps      | 491520                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt
[PPO] Rollout collected in 1.36s. FPS: 24132.89
Epoch 1/5. 
Losses: total 0.14076, value 0.31551, policy -0.00000, entropy -0.00056, approx_kl 0.00008 clip_fraction 0.00031. 
Epoch 2/5. 
Losses: total 0.16018, value 0.30707, policy -0.00004, entropy -0.00051, approx_kl 0.00043 clip_fraction 0.00044. 
Epoch 3/5. 
Losses: total 0.14839, value 0.29973, policy -0.00003, entropy -0.00053, approx_kl 0.00061 clip_fraction 0.00048. 
Epoch 4/5. 
Losses: total 0.14257, value 0.29313, policy -0.00007, entropy -0.00051, approx_kl 0.00089 clip_fraction 0.00056. 
Epoch 5/5. 
Losses: total 0.13131, value 0.28704, policy -0.00009, entropy -0.00051, approx_kl 0.00109 clip_fraction 0.00061. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.741 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.731                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.456                    |
|    len                  | 5.731 +/- 7.42 (90211)   |
|    len_d_1_pos          | 5.401 +/- 7.63 (33852)   |
|    len_d_2_pos          | 5.369 +/- 7.62 (3293)    |
|    len_d_3_pos          | 5.174 +/- 7.50 (3505)    |
|    len_d_4_pos          | 5.186 +/- 7.49 (2114)    |
|    len_d_unknown_neg    | 6.056 +/- 7.22 (47447)   |
|    len_neg              | 6.056 +/- 7.22 (47447)   |
|    len_pos              | 5.369 +/- 7.61 (42764)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (33852)   |
|    proven_d_2_pos       | 0.722 +/- 0.45 (3293)    |
|    proven_d_3_pos       | 0.736 +/- 0.44 (3505)    |
|    proven_d_4_pos       | 0.733 +/- 0.44 (2114)    |
|    proven_d_unknown_neg | 0.006 +/- 0.07 (47447)   |
|    proven_neg           | 0.006 +/- 0.07 (47447)   |
|    proven_pos           | 0.723 +/- 0.45 (42764)   |
|    reward               | 0.731 +/- 0.68 (90211)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (33852)   |
|    reward_d_2_pos       | 0.445 +/- 0.90 (3293)    |
|    reward_d_3_pos       | 0.472 +/- 0.88 (3505)    |
|    reward_d_4_pos       | 0.465 +/- 0.89 (2114)    |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (47447)   |
|    reward_neg           | 0.989 +/- 0.15 (47447)   |
|    reward_pos           | 0.445 +/- 0.90 (42764)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 254                      |
|    time/fps             | 2186                     |
|    total_timesteps      | 524288                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.945, best=0.951 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.915                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.965                    |
|    MRR                  | 0.945                    |
|    len_d_-1_pos         | 13.042                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.146                    |
|    len_pos              | 8.630                    |
|    mrr_mean             | 0.945                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.010                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.010                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_12_10.pt

[Checkpoint] Restoring best model at end of training...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_10_12_10.pt
Loaded best model info: {'metric': 'mrr_mean', 'best_value': 0.9511688053607941, 'timesteps': 4, 'explained_variance': 0.739921510219574}

[3/3] Running evaluation...

Results: MRR=0.8360, Hits@1=0.7790, Hits@3=0.8730, Hits@10=0.9310
Proven: pos=0.3720, neg=0.0121
Writing results to /home/castellanoontiv/Batched_Env/kge_experiments/runs/averaged_runs/experiments.csv

============================================================
All experiments completed!
============================================================


[10/10] Running: KGE Filter + Gated Bridge
==============================================
Grid search: 1 params, 1 experiments.

============================================================
Experiment 1/1
============================================================


============================================================
Seed 0
============================================================
Run signature: wn18rr-250-128-torchrl
======================================================================
Training: wn18rr
Envs: 128, Steps: 256, Timesteps: 500000
Seed: 0
======================================================================

[1/3] Creating components...
[UnificationEngine] Capping max_fact_pairs from 34796 to 1000
[EnvOptimal] Compiled with mode=reduce-overhead, fullgraph=True

[2/3] Running training...
KGE Engine initialized with backend: pytorch (signature: torch_wn18rr_RotatE_1024_20260107_125531_s42)
[NeuralBridge] Created GatedBridge with init_alpha_success=0.7, init_alpha_fail=0.2
[PPO] Compiled ranking_step (double-buffered) with mode=default

[Checkpoint] Loading existing model at start of training (load_model=True)...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_10_12_10.pt

============================================================
Initial evaluation (untrained model)
============================================================
Building model and loading weights...
Weights loaded successfully.
[Eval] Took 8.14 seconds

[Ranking] MRR: current=0.938, best=0.938 (iter 0)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.900                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.975                    |
|    MRR                  | 0.938                    |
|    len_d_-1_pos         | 13.792                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.467                    |
|    len_pos              | 8.990                    |
|    mrr_mean             | 0.938                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

============================================================

[PPO] Rollout collected in 3.30s. FPS: 9931.63
Epoch 1/5. 
Losses: total 0.03657, value 0.10218, policy 0.00040, entropy -0.00053, approx_kl 0.03356 clip_fraction 0.00204. 
Epoch 2/5. 
Losses: total 0.02453, value 0.08148, policy 0.00029, entropy -0.00045, approx_kl 0.05269 clip_fraction 0.00233. 
Epoch 3/5. 
Losses: total 0.02759, value 0.07104, policy 0.00024, entropy -0.00044, approx_kl 0.10802 clip_fraction 0.00309. 
Epoch 4/5. 
Losses: total 0.02143, value 0.06415, policy 0.00020, entropy -0.00041, approx_kl 0.13251 clip_fraction 0.00332. 
Epoch 5/5. 
Losses: total 0.02077, value 0.05965, policy 0.00018, entropy -0.00040, approx_kl 0.13454 clip_fraction 0.00333. 
[PPO] Training completed in 14.27s
[Metrics] Reward (train): current=0.739, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.648                    |
|    ep_rew_mean          | 0.739                    |
|    explained_variance   | 0.770                    |
|    len                  | 5.648 +/- 7.36 (5584)    |
|    len_d_1_pos          | 5.249 +/- 7.52 (2134)    |
|    len_d_2_pos          | 5.224 +/- 7.34 (205)     |
|    len_d_3_pos          | 5.479 +/- 7.63 (217)     |
|    len_d_4_pos          | 5.098 +/- 7.35 (133)     |
|    len_d_unknown_neg    | 6.010 +/- 7.21 (2895)    |
|    len_neg              | 6.010 +/- 7.21 (2895)    |
|    len_pos              | 5.258 +/- 7.51 (2689)    |
|    proven_d_1_pos       | 0.735 +/- 0.44 (2134)    |
|    proven_d_2_pos       | 0.737 +/- 0.44 (205)     |
|    proven_d_3_pos       | 0.719 +/- 0.45 (217)     |
|    proven_d_4_pos       | 0.737 +/- 0.44 (133)     |
|    proven_d_unknown_neg | 0.005 +/- 0.07 (2895)    |
|    proven_neg           | 0.005 +/- 0.07 (2895)    |
|    proven_pos           | 0.734 +/- 0.44 (2689)    |
|    reward               | 0.739 +/- 0.67 (5584)    |
|    reward_d_1_pos       | 0.470 +/- 0.88 (2134)    |
|    reward_d_2_pos       | 0.473 +/- 0.88 (205)     |
|    reward_d_3_pos       | 0.438 +/- 0.90 (217)     |
|    reward_d_4_pos       | 0.474 +/- 0.88 (133)     |
|    reward_d_unknown_neg | 0.990 +/- 0.14 (2895)    |
|    reward_neg           | 0.990 +/- 0.14 (2895)    |
|    reward_pos           | 0.468 +/- 0.88 (2689)    |
|    success_rate         | 0.356                    |
|    time/elapsed         | 26                       |
|    time/fps             | 1239                     |
|    total_timesteps      | 32768                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.35s. FPS: 24184.94
Epoch 1/5. 
Losses: total 0.03964, value 0.10952, policy 0.00059, entropy -0.00068, approx_kl 0.03027 clip_fraction 0.00189. 
Epoch 2/5. 
Losses: total 0.04594, value 0.08777, policy 0.00068, entropy -0.00060, approx_kl 0.09257 clip_fraction 0.00307. 
Epoch 3/5. 
Losses: total 0.02555, value 0.07604, policy 0.00054, entropy -0.00055, approx_kl 0.10321 clip_fraction 0.00331. 
Epoch 4/5. 
Losses: total 0.01767, value 0.06877, policy 0.00046, entropy -0.00054, approx_kl 0.10443 clip_fraction 0.00325. 
Epoch 5/5. 
Losses: total 0.02272, value 0.06321, policy 0.00048, entropy -0.00054, approx_kl 0.11643 clip_fraction 0.00335. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.734, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.679                    |
|    ep_rew_mean          | 0.734                    |
|    explained_variance   | 0.776                    |
|    len                  | 5.679 +/- 7.37 (11236)   |
|    len_d_1_pos          | 5.401 +/- 7.60 (4228)    |
|    len_d_2_pos          | 4.779 +/- 7.07 (426)     |
|    len_d_3_pos          | 5.415 +/- 7.60 (436)     |
|    len_d_4_pos          | 4.837 +/- 7.12 (289)     |
|    len_d_unknown_neg    | 6.006 +/- 7.20 (5857)    |
|    len_neg              | 6.006 +/- 7.20 (5857)    |
|    len_pos              | 5.323 +/- 7.54 (5379)    |
|    proven_d_1_pos       | 0.723 +/- 0.45 (4228)    |
|    proven_d_2_pos       | 0.758 +/- 0.43 (426)     |
|    proven_d_3_pos       | 0.729 +/- 0.44 (436)     |
|    proven_d_4_pos       | 0.751 +/- 0.43 (289)     |
|    proven_d_unknown_neg | 0.006 +/- 0.07 (5857)    |
|    proven_neg           | 0.006 +/- 0.07 (5857)    |
|    proven_pos           | 0.728 +/- 0.44 (5379)    |
|    reward               | 0.734 +/- 0.68 (11236)   |
|    reward_d_1_pos       | 0.447 +/- 0.89 (4228)    |
|    reward_d_2_pos       | 0.516 +/- 0.86 (426)     |
|    reward_d_3_pos       | 0.459 +/- 0.89 (436)     |
|    reward_d_4_pos       | 0.502 +/- 0.87 (289)     |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (5857)    |
|    reward_neg           | 0.989 +/- 0.15 (5857)    |
|    reward_pos           | 0.456 +/- 0.89 (5379)    |
|    success_rate         | 0.351                    |
|    time/elapsed         | 41                       |
|    time/fps             | 2208                     |
|    total_timesteps      | 65536                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.36s. FPS: 24104.70
Epoch 1/5. 
Losses: total 0.03822, value 0.12031, policy 0.00143, entropy -0.00060, approx_kl 0.02731 clip_fraction 0.00195. 
Epoch 2/5. 
Losses: total 0.03788, value 0.09516, policy 0.00108, entropy -0.00055, approx_kl 0.07517 clip_fraction 0.00250. 
Epoch 3/5. 
Losses: total 0.02146, value 0.08282, policy 0.00091, entropy -0.00055, approx_kl 0.08737 clip_fraction 0.00278. 
Epoch 4/5. 
Losses: total 0.02271, value 0.07467, policy 0.00081, entropy -0.00056, approx_kl 0.11849 clip_fraction 0.00331. 
Epoch 5/5. 
Losses: total 0.02664, value 0.06866, policy 0.00065, entropy -0.00054, approx_kl 0.12218 clip_fraction 0.00338. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.730, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.729                    |
|    ep_rew_mean          | 0.730                    |
|    explained_variance   | 0.759                    |
|    len                  | 5.729 +/- 7.41 (16801)   |
|    len_d_1_pos          | 5.468 +/- 7.66 (6329)    |
|    len_d_2_pos          | 5.236 +/- 7.47 (618)     |
|    len_d_3_pos          | 5.542 +/- 7.71 (642)     |
|    len_d_4_pos          | 5.306 +/- 7.54 (409)     |
|    len_d_unknown_neg    | 5.984 +/- 7.18 (8803)    |
|    len_neg              | 5.984 +/- 7.18 (8803)    |
|    len_pos              | 5.448 +/- 7.64 (7998)    |
|    proven_d_1_pos       | 0.720 +/- 0.45 (6329)    |
|    proven_d_2_pos       | 0.736 +/- 0.44 (618)     |
|    proven_d_3_pos       | 0.723 +/- 0.45 (642)     |
|    proven_d_4_pos       | 0.738 +/- 0.44 (409)     |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (8803)    |
|    proven_neg           | 0.006 +/- 0.08 (8803)    |
|    proven_pos           | 0.723 +/- 0.45 (7998)    |
|    reward               | 0.730 +/- 0.68 (16801)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (6329)    |
|    reward_d_2_pos       | 0.472 +/- 0.88 (618)     |
|    reward_d_3_pos       | 0.445 +/- 0.90 (642)     |
|    reward_d_4_pos       | 0.477 +/- 0.88 (409)     |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (8803)    |
|    reward_neg           | 0.988 +/- 0.15 (8803)    |
|    reward_pos           | 0.445 +/- 0.90 (7998)    |
|    success_rate         | 0.347                    |
|    time/elapsed         | 56                       |
|    time/fps             | 2201                     |
|    total_timesteps      | 98304                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.36s. FPS: 24076.93
Epoch 1/5. 
Losses: total 0.05247, value 0.12324, policy 0.00038, entropy -0.00064, approx_kl 0.01811 clip_fraction 0.00168. 
Epoch 2/5. 
Losses: total 0.02666, value 0.09761, policy 0.00032, entropy -0.00059, approx_kl 0.03544 clip_fraction 0.00195. 
Epoch 3/5. 
Losses: total 0.03035, value 0.08458, policy 0.00021, entropy -0.00054, approx_kl 0.04154 clip_fraction 0.00203. 
Epoch 4/5. 
Losses: total 0.02339, value 0.07588, policy 0.00016, entropy -0.00052, approx_kl 0.04845 clip_fraction 0.00212. 
Epoch 5/5. 
Losses: total 0.02453, value 0.06980, policy 0.00016, entropy -0.00055, approx_kl 0.05882 clip_fraction 0.00237. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.729, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.744                    |
|    ep_rew_mean          | 0.729                    |
|    explained_variance   | 0.748                    |
|    len                  | 5.744 +/- 7.41 (22378)   |
|    len_d_1_pos          | 5.467 +/- 7.66 (8441)    |
|    len_d_2_pos          | 5.480 +/- 7.65 (800)     |
|    len_d_3_pos          | 5.566 +/- 7.75 (852)     |
|    len_d_4_pos          | 5.400 +/- 7.62 (537)     |
|    len_d_unknown_neg    | 5.990 +/- 7.18 (11748)   |
|    len_neg              | 5.990 +/- 7.18 (11748)   |
|    len_pos              | 5.472 +/- 7.66 (10630)   |
|    proven_d_1_pos       | 0.720 +/- 0.45 (8441)    |
|    proven_d_2_pos       | 0.724 +/- 0.45 (800)     |
|    proven_d_3_pos       | 0.723 +/- 0.45 (852)     |
|    proven_d_4_pos       | 0.728 +/- 0.44 (537)     |
|    proven_d_unknown_neg | 0.005 +/- 0.07 (11748)   |
|    proven_neg           | 0.005 +/- 0.07 (11748)   |
|    proven_pos           | 0.721 +/- 0.45 (10630)   |
|    reward               | 0.729 +/- 0.68 (22378)   |
|    reward_d_1_pos       | 0.440 +/- 0.90 (8441)    |
|    reward_d_2_pos       | 0.448 +/- 0.89 (800)     |
|    reward_d_3_pos       | 0.446 +/- 0.90 (852)     |
|    reward_d_4_pos       | 0.456 +/- 0.89 (537)     |
|    reward_d_unknown_neg | 0.990 +/- 0.14 (11748)   |
|    reward_neg           | 0.990 +/- 0.14 (11748)   |
|    reward_pos           | 0.442 +/- 0.90 (10630)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 71                       |
|    time/fps             | 2200                     |
|    total_timesteps      | 131072                   |
----------------------------------------------------

[Eval] Took 1.32 seconds

[Ranking] MRR: current=0.947, best=0.947 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.915                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.985                    |
|    MRR                  | 0.947                    |
|    len_d_-1_pos         | 13.854                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.508                    |
|    len_pos              | 9.020                    |
|    mrr_mean             | 0.947                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.007                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.007                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] New best eval model saved to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_10_17_27.pt (mrr_mean=0.9470)
[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.36s. FPS: 24143.96
Epoch 1/5. 
Losses: total 0.10557, value 0.26126, policy 0.00085, entropy -0.00104, approx_kl 0.03864 clip_fraction 0.00296. 
Epoch 2/5. 
Losses: total 0.06840, value 0.20151, policy 0.00061, entropy -0.00109, approx_kl 0.06961 clip_fraction 0.00375. 
Epoch 3/5. 
Losses: total 0.04933, value 0.16795, policy 0.00046, entropy -0.00105, approx_kl 0.09240 clip_fraction 0.00406. 
Epoch 4/5. 
Losses: total 0.04292, value 0.14643, policy 0.00045, entropy -0.00097, approx_kl 0.13408 clip_fraction 0.00466. 
Epoch 5/5. 
Losses: total 0.04004, value 0.13128, policy 0.00040, entropy -0.00093, approx_kl 0.16459 clip_fraction 0.00508. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.728, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.807                    |
|    ep_rew_mean          | 0.728                    |
|    explained_variance   | 0.427                    |
|    len                  | 5.807 +/- 7.46 (27725)   |
|    len_d_1_pos          | 5.491 +/- 7.67 (10436)   |
|    len_d_2_pos          | 5.437 +/- 7.64 (1000)    |
|    len_d_3_pos          | 5.585 +/- 7.74 (1056)    |
|    len_d_4_pos          | 5.273 +/- 7.53 (660)     |
|    len_d_unknown_neg    | 6.099 +/- 7.25 (14573)   |
|    len_neg              | 6.099 +/- 7.25 (14573)   |
|    len_pos              | 5.484 +/- 7.67 (13152)   |
|    proven_d_1_pos       | 0.718 +/- 0.45 (10436)   |
|    proven_d_2_pos       | 0.725 +/- 0.45 (1000)    |
|    proven_d_3_pos       | 0.717 +/- 0.45 (1056)    |
|    proven_d_4_pos       | 0.732 +/- 0.44 (660)     |
|    proven_d_unknown_neg | 0.006 +/- 0.07 (14573)   |
|    proven_neg           | 0.006 +/- 0.07 (14573)   |
|    proven_pos           | 0.719 +/- 0.45 (13152)   |
|    reward               | 0.728 +/- 0.69 (27725)   |
|    reward_d_1_pos       | 0.436 +/- 0.90 (10436)   |
|    reward_d_2_pos       | 0.450 +/- 0.89 (1000)    |
|    reward_d_3_pos       | 0.434 +/- 0.90 (1056)    |
|    reward_d_4_pos       | 0.464 +/- 0.89 (660)     |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (14573)   |
|    reward_neg           | 0.989 +/- 0.15 (14573)   |
|    reward_pos           | 0.438 +/- 0.90 (13152)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 87                       |
|    time/fps             | 2017                     |
|    total_timesteps      | 163840                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.37s. FPS: 23949.68
Epoch 1/5. 
Losses: total 0.10002, value 0.25815, policy 0.00128, entropy -0.00115, approx_kl 0.01851 clip_fraction 0.00287. 
Epoch 2/5. 
Losses: total 0.06435, value 0.20482, policy 0.00156, entropy -0.00101, approx_kl 0.07458 clip_fraction 0.00366. 
Epoch 3/5. 
Losses: total 0.05271, value 0.17334, policy 0.00145, entropy -0.00098, approx_kl 0.08593 clip_fraction 0.00379. 
Epoch 4/5. 
Losses: total 0.04435, value 0.15266, policy 0.00118, entropy -0.00098, approx_kl 0.09148 clip_fraction 0.00386. 
Epoch 5/5. 
Losses: total 0.03302, value 0.13764, policy 0.00098, entropy -0.00099, approx_kl 0.10253 clip_fraction 0.00406. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.732, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.768                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.431                    |
|    len                  | 5.768 +/- 7.43 (33494)   |
|    len_d_1_pos          | 5.414 +/- 7.62 (12620)   |
|    len_d_2_pos          | 5.405 +/- 7.60 (1191)    |
|    len_d_3_pos          | 5.413 +/- 7.65 (1265)    |
|    len_d_4_pos          | 5.117 +/- 7.42 (800)     |
|    len_d_unknown_neg    | 6.102 +/- 7.25 (17618)   |
|    len_neg              | 6.102 +/- 7.25 (17618)   |
|    len_pos              | 5.398 +/- 7.61 (15876)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (12620)   |
|    proven_d_2_pos       | 0.720 +/- 0.45 (1191)    |
|    proven_d_3_pos       | 0.726 +/- 0.45 (1265)    |
|    proven_d_4_pos       | 0.743 +/- 0.44 (800)     |
|    proven_d_unknown_neg | 0.006 +/- 0.07 (17618)   |
|    proven_neg           | 0.006 +/- 0.07 (17618)   |
|    proven_pos           | 0.723 +/- 0.45 (15876)   |
|    reward               | 0.732 +/- 0.68 (33494)   |
|    reward_d_1_pos       | 0.444 +/- 0.90 (12620)   |
|    reward_d_2_pos       | 0.441 +/- 0.90 (1191)    |
|    reward_d_3_pos       | 0.451 +/- 0.89 (1265)    |
|    reward_d_4_pos       | 0.485 +/- 0.87 (800)     |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (17618)   |
|    reward_neg           | 0.989 +/- 0.15 (17618)   |
|    reward_pos           | 0.446 +/- 0.89 (15876)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 102                      |
|    time/fps             | 2197                     |
|    total_timesteps      | 196608                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.36s. FPS: 24052.74
Epoch 1/5. 
Losses: total 0.09041, value 0.26169, policy 0.00049, entropy -0.00069, approx_kl 0.00903 clip_fraction 0.00192. 
Epoch 2/5. 
Losses: total 0.06551, value 0.20592, policy 0.00059, entropy -0.00057, approx_kl 0.03290 clip_fraction 0.00255. 
Epoch 3/5. 
Losses: total 0.05060, value 0.17269, policy 0.00059, entropy -0.00055, approx_kl 0.04680 clip_fraction 0.00285. 
Epoch 4/5. 
Losses: total 0.05085, value 0.15101, policy 0.00058, entropy -0.00052, approx_kl 0.05347 clip_fraction 0.00295. 
Epoch 5/5. 
Losses: total 0.03205, value 0.13558, policy 0.00056, entropy -0.00052, approx_kl 0.05702 clip_fraction 0.00306. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.733, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.777                    |
|    ep_rew_mean          | 0.733                    |
|    explained_variance   | 0.429                    |
|    len                  | 5.777 +/- 7.45 (39045)   |
|    len_d_1_pos          | 5.419 +/- 7.64 (14694)   |
|    len_d_2_pos          | 5.495 +/- 7.68 (1376)    |
|    len_d_3_pos          | 5.361 +/- 7.62 (1494)    |
|    len_d_4_pos          | 5.103 +/- 7.43 (933)     |
|    len_d_unknown_neg    | 6.114 +/- 7.26 (20548)   |
|    len_neg              | 6.114 +/- 7.26 (20548)   |
|    len_pos              | 5.404 +/- 7.63 (18497)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (14694)   |
|    proven_d_2_pos       | 0.716 +/- 0.45 (1376)    |
|    proven_d_3_pos       | 0.727 +/- 0.45 (1494)    |
|    proven_d_4_pos       | 0.744 +/- 0.44 (933)     |
|    proven_d_unknown_neg | 0.006 +/- 0.07 (20548)   |
|    proven_neg           | 0.006 +/- 0.07 (20548)   |
|    proven_pos           | 0.724 +/- 0.45 (18497)   |
|    reward               | 0.733 +/- 0.68 (39045)   |
|    reward_d_1_pos       | 0.447 +/- 0.89 (14694)   |
|    reward_d_2_pos       | 0.432 +/- 0.90 (1376)    |
|    reward_d_3_pos       | 0.454 +/- 0.89 (1494)    |
|    reward_d_4_pos       | 0.488 +/- 0.87 (933)     |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (20548)   |
|    reward_neg           | 0.989 +/- 0.15 (20548)   |
|    reward_pos           | 0.448 +/- 0.89 (18497)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 117                      |
|    time/fps             | 2196                     |
|    total_timesteps      | 229376                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.37s. FPS: 23995.18
Epoch 1/5. 
Losses: total 0.09712, value 0.25928, policy 0.00038, entropy -0.00105, approx_kl 0.00686 clip_fraction 0.00195. 
Epoch 2/5. 
Losses: total 0.06409, value 0.20945, policy 0.00031, entropy -0.00092, approx_kl 0.01297 clip_fraction 0.00209. 
Epoch 3/5. 
Losses: total 0.04320, value 0.17855, policy 0.00033, entropy -0.00086, approx_kl 0.01952 clip_fraction 0.00233. 
Epoch 4/5. 
Losses: total 0.04951, value 0.15781, policy 0.00028, entropy -0.00084, approx_kl 0.02519 clip_fraction 0.00256. 
Epoch 5/5. 
Losses: total 0.03744, value 0.14263, policy 0.00022, entropy -0.00080, approx_kl 0.03045 clip_fraction 0.00266. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.733, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.796                    |
|    ep_rew_mean          | 0.733                    |
|    explained_variance   | 0.448                    |
|    len                  | 5.796 +/- 7.46 (44521)   |
|    len_d_1_pos          | 5.402 +/- 7.64 (16725)   |
|    len_d_2_pos          | 5.527 +/- 7.70 (1585)    |
|    len_d_3_pos          | 5.344 +/- 7.61 (1699)    |
|    len_d_4_pos          | 5.264 +/- 7.54 (1058)    |
|    len_d_unknown_neg    | 6.151 +/- 7.29 (23454)   |
|    len_neg              | 6.151 +/- 7.29 (23454)   |
|    len_pos              | 5.400 +/- 7.63 (21067)   |
|    proven_d_1_pos       | 0.725 +/- 0.45 (16725)   |
|    proven_d_2_pos       | 0.714 +/- 0.45 (1585)    |
|    proven_d_3_pos       | 0.727 +/- 0.45 (1699)    |
|    proven_d_4_pos       | 0.734 +/- 0.44 (1058)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (23454)   |
|    proven_neg           | 0.006 +/- 0.08 (23454)   |
|    proven_pos           | 0.725 +/- 0.45 (21067)   |
|    reward               | 0.733 +/- 0.68 (44521)   |
|    reward_d_1_pos       | 0.450 +/- 0.89 (16725)   |
|    reward_d_2_pos       | 0.427 +/- 0.90 (1585)    |
|    reward_d_3_pos       | 0.455 +/- 0.89 (1699)    |
|    reward_d_4_pos       | 0.469 +/- 0.88 (1058)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (23454)   |
|    reward_neg           | 0.988 +/- 0.15 (23454)   |
|    reward_pos           | 0.450 +/- 0.89 (21067)   |
|    success_rate         | 0.346                    |
|    time/elapsed         | 132                      |
|    time/fps             | 2195                     |
|    total_timesteps      | 262144                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.933, best=0.947 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.895                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.965                    |
|    MRR                  | 0.933                    |
|    len_d_-1_pos         | 14.208                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.752                    |
|    len_pos              | 9.190                    |
|    mrr_mean             | 0.933                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.009                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.009                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.36s. FPS: 24076.02
Epoch 1/5. 
Losses: total 0.12552, value 0.29105, policy 0.00017, entropy -0.00087, approx_kl 0.00497 clip_fraction 0.00165. 
Epoch 2/5. 
Losses: total 0.07459, value 0.23612, policy 0.00008, entropy -0.00080, approx_kl 0.01732 clip_fraction 0.00223. 
Epoch 3/5. 
Losses: total 0.04921, value 0.20069, policy 0.00002, entropy -0.00074, approx_kl 0.02521 clip_fraction 0.00255. 
Epoch 4/5. 
Losses: total 0.05766, value 0.17665, policy 0.00003, entropy -0.00068, approx_kl 0.03221 clip_fraction 0.00273. 
Epoch 5/5. 
Losses: total 0.04331, value 0.15938, policy -0.00001, entropy -0.00063, approx_kl 0.03710 clip_fraction 0.00285. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.732, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.811                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.399                    |
|    len                  | 5.811 +/- 7.47 (49960)   |
|    len_d_1_pos          | 5.444 +/- 7.66 (18728)   |
|    len_d_2_pos          | 5.444 +/- 7.66 (1794)    |
|    len_d_3_pos          | 5.316 +/- 7.59 (1913)    |
|    len_d_4_pos          | 5.217 +/- 7.50 (1183)    |
|    len_d_unknown_neg    | 6.160 +/- 7.29 (26342)   |
|    len_neg              | 6.160 +/- 7.29 (26342)   |
|    len_pos              | 5.422 +/- 7.65 (23618)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (18728)   |
|    proven_d_2_pos       | 0.719 +/- 0.45 (1794)    |
|    proven_d_3_pos       | 0.730 +/- 0.44 (1913)    |
|    proven_d_4_pos       | 0.734 +/- 0.44 (1183)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (26342)   |
|    proven_neg           | 0.006 +/- 0.08 (26342)   |
|    proven_pos           | 0.723 +/- 0.45 (23618)   |
|    reward               | 0.732 +/- 0.68 (49960)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (18728)   |
|    reward_d_2_pos       | 0.437 +/- 0.90 (1794)    |
|    reward_d_3_pos       | 0.459 +/- 0.89 (1913)    |
|    reward_d_4_pos       | 0.467 +/- 0.88 (1183)    |
|    reward_d_unknown_neg | 0.989 +/- 0.15 (26342)   |
|    reward_neg           | 0.989 +/- 0.15 (26342)   |
|    reward_pos           | 0.447 +/- 0.89 (23618)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 148                      |
|    time/fps             | 2018                     |
|    total_timesteps      | 294912                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.38s. FPS: 23772.94
Epoch 1/5. 
Losses: total 0.12128, value 0.28097, policy 0.00038, entropy -0.00099, approx_kl 0.00351 clip_fraction 0.00128. 
Epoch 2/5. 
Losses: total 0.08509, value 0.23027, policy 0.00025, entropy -0.00093, approx_kl 0.00876 clip_fraction 0.00153. 
Epoch 3/5. 
Losses: total 0.07008, value 0.19705, policy 0.00013, entropy -0.00082, approx_kl 0.01157 clip_fraction 0.00157. 
Epoch 4/5. 
Losses: total 0.05563, value 0.17379, policy 0.00006, entropy -0.00079, approx_kl 0.01414 clip_fraction 0.00165. 
Epoch 5/5. 
Losses: total 0.04328, value 0.15683, policy -0.00001, entropy -0.00077, approx_kl 0.01690 clip_fraction 0.00173. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.825                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.431                    |
|    len                  | 5.825 +/- 7.48 (55396)   |
|    len_d_1_pos          | 5.478 +/- 7.68 (20715)   |
|    len_d_2_pos          | 5.510 +/- 7.70 (1997)    |
|    len_d_3_pos          | 5.338 +/- 7.61 (2132)    |
|    len_d_4_pos          | 5.127 +/- 7.45 (1327)    |
|    len_d_unknown_neg    | 6.160 +/- 7.29 (29225)   |
|    len_neg              | 6.160 +/- 7.29 (29225)   |
|    len_pos              | 5.451 +/- 7.67 (26171)   |
|    proven_d_1_pos       | 0.721 +/- 0.45 (20715)   |
|    proven_d_2_pos       | 0.716 +/- 0.45 (1997)    |
|    proven_d_3_pos       | 0.728 +/- 0.44 (2132)    |
|    proven_d_4_pos       | 0.738 +/- 0.44 (1327)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (29225)   |
|    proven_neg           | 0.006 +/- 0.08 (29225)   |
|    proven_pos           | 0.722 +/- 0.45 (26171)   |
|    reward               | 0.731 +/- 0.68 (55396)   |
|    reward_d_1_pos       | 0.441 +/- 0.90 (20715)   |
|    reward_d_2_pos       | 0.432 +/- 0.90 (1997)    |
|    reward_d_3_pos       | 0.457 +/- 0.89 (2132)    |
|    reward_d_4_pos       | 0.476 +/- 0.88 (1327)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (29225)   |
|    reward_neg           | 0.988 +/- 0.15 (29225)   |
|    reward_pos           | 0.443 +/- 0.90 (26171)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 163                      |
|    time/fps             | 2191                     |
|    total_timesteps      | 327680                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.36s. FPS: 24077.97
Epoch 1/5. 
Losses: total 0.11849, value 0.29107, policy 0.00017, entropy -0.00080, approx_kl 0.00900 clip_fraction 0.00134. 
Epoch 2/5. 
Losses: total 0.08081, value 0.24077, policy 0.00011, entropy -0.00069, approx_kl 0.01539 clip_fraction 0.00159. 
Epoch 3/5. 
Losses: total 0.06357, value 0.20705, policy 0.00010, entropy -0.00068, approx_kl 0.01776 clip_fraction 0.00177. 
Epoch 4/5. 
Losses: total 0.05381, value 0.18329, policy 0.00000, entropy -0.00064, approx_kl 0.02206 clip_fraction 0.00195. 
Epoch 5/5. 
Losses: total 0.04350, value 0.16550, policy -0.00005, entropy -0.00061, approx_kl 0.02465 clip_fraction 0.00203. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.732, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.831                    |
|    ep_rew_mean          | 0.732                    |
|    explained_variance   | 0.402                    |
|    len                  | 5.831 +/- 7.48 (60895)   |
|    len_d_1_pos          | 5.455 +/- 7.68 (22797)   |
|    len_d_2_pos          | 5.565 +/- 7.74 (2185)    |
|    len_d_3_pos          | 5.415 +/- 7.65 (2344)    |
|    len_d_4_pos          | 5.269 +/- 7.56 (1438)    |
|    len_d_unknown_neg    | 6.171 +/- 7.29 (32131)   |
|    len_neg              | 6.171 +/- 7.29 (32131)   |
|    len_pos              | 5.451 +/- 7.67 (28764)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (22797)   |
|    proven_d_2_pos       | 0.713 +/- 0.45 (2185)    |
|    proven_d_3_pos       | 0.725 +/- 0.45 (2344)    |
|    proven_d_4_pos       | 0.732 +/- 0.44 (1438)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (32131)   |
|    proven_neg           | 0.006 +/- 0.08 (32131)   |
|    proven_pos           | 0.722 +/- 0.45 (28764)   |
|    reward               | 0.732 +/- 0.68 (60895)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (22797)   |
|    reward_d_2_pos       | 0.425 +/- 0.91 (2185)    |
|    reward_d_3_pos       | 0.450 +/- 0.89 (2344)    |
|    reward_d_4_pos       | 0.463 +/- 0.89 (1438)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (32131)   |
|    reward_neg           | 0.988 +/- 0.15 (32131)   |
|    reward_pos           | 0.445 +/- 0.90 (28764)   |
|    success_rate         | 0.344                    |
|    time/elapsed         | 178                      |
|    time/fps             | 2192                     |
|    total_timesteps      | 360448                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.36s. FPS: 24051.85
Epoch 1/5. 
Losses: total 0.12033, value 0.31503, policy 0.00170, entropy -0.00074, approx_kl 0.00796 clip_fraction 0.00146. 
Epoch 2/5. 
Losses: total 0.11107, value 0.27050, policy 0.00085, entropy -0.00074, approx_kl 0.01485 clip_fraction 0.00188. 
Epoch 3/5. 
Losses: total 0.07594, value 0.23885, policy 0.00053, entropy -0.00070, approx_kl 0.02067 clip_fraction 0.00208. 
Epoch 4/5. 
Losses: total 0.07154, value 0.21523, policy 0.00066, entropy -0.00068, approx_kl 0.02402 clip_fraction 0.00214. 
Epoch 5/5. 
Losses: total 0.06204, value 0.19685, policy 0.00045, entropy -0.00068, approx_kl 0.02737 clip_fraction 0.00223. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.829                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.377                    |
|    len                  | 5.829 +/- 7.48 (66445)   |
|    len_d_1_pos          | 5.463 +/- 7.68 (24886)   |
|    len_d_2_pos          | 5.613 +/- 7.77 (2380)    |
|    len_d_3_pos          | 5.368 +/- 7.61 (2574)    |
|    len_d_4_pos          | 5.238 +/- 7.53 (1574)    |
|    len_d_unknown_neg    | 6.165 +/- 7.29 (35031)   |
|    len_neg              | 6.165 +/- 7.29 (35031)   |
|    len_pos              | 5.456 +/- 7.67 (31414)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (24886)   |
|    proven_d_2_pos       | 0.710 +/- 0.45 (2380)    |
|    proven_d_3_pos       | 0.728 +/- 0.44 (2574)    |
|    proven_d_4_pos       | 0.733 +/- 0.44 (1574)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (35031)   |
|    proven_neg           | 0.006 +/- 0.08 (35031)   |
|    proven_pos           | 0.723 +/- 0.45 (31414)   |
|    reward               | 0.731 +/- 0.68 (66445)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (24886)   |
|    reward_d_2_pos       | 0.420 +/- 0.91 (2380)    |
|    reward_d_3_pos       | 0.457 +/- 0.89 (2574)    |
|    reward_d_4_pos       | 0.466 +/- 0.88 (1574)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (35031)   |
|    reward_neg           | 0.988 +/- 0.15 (35031)   |
|    reward_pos           | 0.445 +/- 0.90 (31414)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 193                      |
|    time/fps             | 2191                     |
|    total_timesteps      | 393216                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.941, best=0.947 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.905                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.970                    |
|    MRR                  | 0.941                    |
|    len_d_-1_pos         | 14.917                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.785                    |
|    len_pos              | 9.530                    |
|    mrr_mean             | 0.941                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.011                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.011                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.36s. FPS: 24067.29
Epoch 1/5. 
Losses: total 0.15336, value 0.30350, policy 0.00011, entropy -0.00106, approx_kl 0.00311 clip_fraction 0.00131. 
Epoch 2/5. 
Losses: total 0.10518, value 0.26507, policy 0.00005, entropy -0.00095, approx_kl 0.00614 clip_fraction 0.00145. 
Epoch 3/5. 
Losses: total 0.07792, value 0.23659, policy -0.00000, entropy -0.00089, approx_kl 0.00956 clip_fraction 0.00165. 
Epoch 4/5. 
Losses: total 0.07520, value 0.21442, policy -0.00006, entropy -0.00086, approx_kl 0.01184 clip_fraction 0.00178. 
Epoch 5/5. 
Losses: total 0.06948, value 0.19676, policy -0.00009, entropy -0.00082, approx_kl 0.01419 clip_fraction 0.00189. 
[PPO] Training completed in 13.41s
[Metrics] Reward (train): current=0.731, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.834                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.421                    |
|    len                  | 5.834 +/- 7.49 (71961)   |
|    len_d_1_pos          | 5.468 +/- 7.68 (26977)   |
|    len_d_2_pos          | 5.634 +/- 7.77 (2580)    |
|    len_d_3_pos          | 5.351 +/- 7.61 (2810)    |
|    len_d_4_pos          | 5.281 +/- 7.56 (1684)    |
|    len_d_unknown_neg    | 6.169 +/- 7.29 (37910)   |
|    len_neg              | 6.169 +/- 7.29 (37910)   |
|    len_pos              | 5.462 +/- 7.68 (34051)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (26977)   |
|    proven_d_2_pos       | 0.708 +/- 0.45 (2580)    |
|    proven_d_3_pos       | 0.731 +/- 0.44 (2810)    |
|    proven_d_4_pos       | 0.731 +/- 0.44 (1684)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (37910)   |
|    proven_neg           | 0.006 +/- 0.08 (37910)   |
|    proven_pos           | 0.722 +/- 0.45 (34051)   |
|    reward               | 0.731 +/- 0.68 (71961)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (26977)   |
|    reward_d_2_pos       | 0.416 +/- 0.91 (2580)    |
|    reward_d_3_pos       | 0.462 +/- 0.89 (2810)    |
|    reward_d_4_pos       | 0.462 +/- 0.89 (1684)    |
|    reward_d_unknown_neg | 0.988 +/- 0.15 (37910)   |
|    reward_neg           | 0.988 +/- 0.15 (37910)   |
|    reward_pos           | 0.445 +/- 0.90 (34051)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 209                      |
|    time/fps             | 2013                     |
|    total_timesteps      | 425984                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.36s. FPS: 24065.28
Epoch 1/5. 
Losses: total 0.13546, value 0.31793, policy 0.00065, entropy -0.00099, approx_kl 0.00386 clip_fraction 0.00140. 
Epoch 2/5. 
Losses: total 0.12208, value 0.28705, policy 0.00029, entropy -0.00095, approx_kl 0.00678 clip_fraction 0.00156. 
Epoch 3/5. 
Losses: total 0.10397, value 0.26269, policy 0.00010, entropy -0.00092, approx_kl 0.00831 clip_fraction 0.00165. 
Epoch 4/5. 
Losses: total 0.09810, value 0.24241, policy -0.00002, entropy -0.00087, approx_kl 0.01068 clip_fraction 0.00177. 
Epoch 5/5. 
Losses: total 0.06657, value 0.22533, policy -0.00007, entropy -0.00084, approx_kl 0.01217 clip_fraction 0.00186. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.837                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.399                    |
|    len                  | 5.837 +/- 7.49 (77464)   |
|    len_d_1_pos          | 5.459 +/- 7.68 (29052)   |
|    len_d_2_pos          | 5.646 +/- 7.78 (2772)    |
|    len_d_3_pos          | 5.373 +/- 7.63 (3001)    |
|    len_d_4_pos          | 5.293 +/- 7.57 (1807)    |
|    len_d_unknown_neg    | 6.177 +/- 7.30 (40832)   |
|    len_neg              | 6.177 +/- 7.30 (40832)   |
|    len_pos              | 5.458 +/- 7.68 (36632)   |
|    proven_d_1_pos       | 0.722 +/- 0.45 (29052)   |
|    proven_d_2_pos       | 0.709 +/- 0.45 (2772)    |
|    proven_d_3_pos       | 0.730 +/- 0.44 (3001)    |
|    proven_d_4_pos       | 0.733 +/- 0.44 (1807)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (40832)   |
|    proven_neg           | 0.006 +/- 0.08 (40832)   |
|    proven_pos           | 0.723 +/- 0.45 (36632)   |
|    reward               | 0.731 +/- 0.68 (77464)   |
|    reward_d_1_pos       | 0.445 +/- 0.90 (29052)   |
|    reward_d_2_pos       | 0.418 +/- 0.91 (2772)    |
|    reward_d_3_pos       | 0.460 +/- 0.89 (3001)    |
|    reward_d_4_pos       | 0.465 +/- 0.89 (1807)    |
|    reward_d_unknown_neg | 0.988 +/- 0.16 (40832)   |
|    reward_neg           | 0.988 +/- 0.16 (40832)   |
|    reward_pos           | 0.445 +/- 0.90 (36632)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 224                      |
|    time/fps             | 2188                     |
|    total_timesteps      | 458752                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.37s. FPS: 24005.10
Epoch 1/5. 
Losses: total 0.13955, value 0.30925, policy 0.00047, entropy -0.00106, approx_kl 0.00108 clip_fraction 0.00095. 
Epoch 2/5. 
Losses: total 0.12925, value 0.28923, policy 0.00025, entropy -0.00093, approx_kl 0.00269 clip_fraction 0.00119. 
Epoch 3/5. 
Losses: total 0.12474, value 0.27249, policy 0.00013, entropy -0.00086, approx_kl 0.00359 clip_fraction 0.00127. 
Epoch 4/5. 
Losses: total 0.08878, value 0.25796, policy 0.00004, entropy -0.00084, approx_kl 0.00503 clip_fraction 0.00139. 
Epoch 5/5. 
Losses: total 0.09447, value 0.24509, policy -0.00003, entropy -0.00084, approx_kl 0.00612 clip_fraction 0.00150. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.836                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.434                    |
|    len                  | 5.836 +/- 7.49 (83019)   |
|    len_d_1_pos          | 5.452 +/- 7.68 (31147)   |
|    len_d_2_pos          | 5.635 +/- 7.78 (2965)    |
|    len_d_3_pos          | 5.343 +/- 7.61 (3219)    |
|    len_d_4_pos          | 5.353 +/- 7.62 (1929)    |
|    len_d_unknown_neg    | 6.181 +/- 7.30 (43759)   |
|    len_neg              | 6.181 +/- 7.30 (43759)   |
|    len_pos              | 5.452 +/- 7.68 (39260)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (31147)   |
|    proven_d_2_pos       | 0.711 +/- 0.45 (2965)    |
|    proven_d_3_pos       | 0.730 +/- 0.44 (3219)    |
|    proven_d_4_pos       | 0.728 +/- 0.44 (1929)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (43759)   |
|    proven_neg           | 0.006 +/- 0.08 (43759)   |
|    proven_pos           | 0.723 +/- 0.45 (39260)   |
|    reward               | 0.731 +/- 0.68 (83019)   |
|    reward_d_1_pos       | 0.446 +/- 0.90 (31147)   |
|    reward_d_2_pos       | 0.422 +/- 0.91 (2965)    |
|    reward_d_3_pos       | 0.461 +/- 0.89 (3219)    |
|    reward_d_4_pos       | 0.457 +/- 0.89 (1929)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (43759)   |
|    reward_neg           | 0.987 +/- 0.16 (43759)   |
|    reward_pos           | 0.446 +/- 0.90 (39260)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 239                      |
|    time/fps             | 2186                     |
|    total_timesteps      | 491520                   |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt
[PPO] Rollout collected in 1.36s. FPS: 24055.23
Epoch 1/5. 
Losses: total 0.15123, value 0.30181, policy -0.00003, entropy -0.00095, approx_kl 0.00009 clip_fraction 0.00061. 
Epoch 2/5. 
Losses: total 0.15581, value 0.29423, policy -0.00008, entropy -0.00090, approx_kl 0.00037 clip_fraction 0.00075. 
Epoch 3/5. 
Losses: total 0.11947, value 0.28766, policy -0.00014, entropy -0.00092, approx_kl 0.00058 clip_fraction 0.00089. 
Epoch 4/5. 
Losses: total 0.13466, value 0.28164, policy -0.00017, entropy -0.00093, approx_kl 0.00081 clip_fraction 0.00098. 
Epoch 5/5. 
Losses: total 0.12251, value 0.27602, policy -0.00020, entropy -0.00094, approx_kl 0.00099 clip_fraction 0.00106. 
[PPO] Training completed in 13.42s
[Metrics] Reward (train): current=0.731, best=0.739 (iter 1)
----------------------------------------------------
| rollout/                |                          |
|    ep_len_mean          | 5.830                    |
|    ep_rew_mean          | 0.731                    |
|    explained_variance   | 0.474                    |
|    len                  | 5.830 +/- 7.49 (88665)   |
|    len_d_1_pos          | 5.458 +/- 7.68 (33254)   |
|    len_d_2_pos          | 5.623 +/- 7.78 (3174)    |
|    len_d_3_pos          | 5.308 +/- 7.59 (3441)    |
|    len_d_4_pos          | 5.276 +/- 7.57 (2064)    |
|    len_d_unknown_neg    | 6.171 +/- 7.30 (46732)   |
|    len_neg              | 6.171 +/- 7.30 (46732)   |
|    len_pos              | 5.449 +/- 7.67 (41933)   |
|    proven_d_1_pos       | 0.723 +/- 0.45 (33254)   |
|    proven_d_2_pos       | 0.711 +/- 0.45 (3174)    |
|    proven_d_3_pos       | 0.733 +/- 0.44 (3441)    |
|    proven_d_4_pos       | 0.732 +/- 0.44 (2064)    |
|    proven_d_unknown_neg | 0.006 +/- 0.08 (46732)   |
|    proven_neg           | 0.006 +/- 0.08 (46732)   |
|    proven_pos           | 0.723 +/- 0.45 (41933)   |
|    reward               | 0.731 +/- 0.68 (88665)   |
|    reward_d_1_pos       | 0.446 +/- 0.90 (33254)   |
|    reward_d_2_pos       | 0.422 +/- 0.91 (3174)    |
|    reward_d_3_pos       | 0.466 +/- 0.88 (3441)    |
|    reward_d_4_pos       | 0.463 +/- 0.89 (2064)    |
|    reward_d_unknown_neg | 0.987 +/- 0.16 (46732)   |
|    reward_neg           | 0.987 +/- 0.16 (46732)   |
|    reward_pos           | 0.447 +/- 0.89 (41933)   |
|    success_rate         | 0.345                    |
|    time/elapsed         | 254                      |
|    time/fps             | 2185                     |
|    total_timesteps      | 524288                   |
----------------------------------------------------

[Eval] Took 1.31 seconds

[Ranking] MRR: current=0.943, best=0.947 (iter 4)
----------------------------------------------------
| eval/                   |                          |
|    Hits@1               | 0.910                    |
|    Hits@10              | 0.995                    |
|    Hits@3               | 0.970                    |
|    MRR                  | 0.943                    |
|    len_d_-1_pos         | 14.562                   |
|    len_d_1_pos          | 1.977                    |
|    len_d_2_pos          | 17.500                   |
|    len_d_3_pos          | 20.000                   |
|    len_d_4_pos          | 20.000                   |
|    len_neg              | 8.730                    |
|    len_pos              | 9.360                    |
|    mrr_mean             | 0.943                    |
|    proven_d_-1_pos      | 0.021                    |
|    proven_d_1_pos       | 0.932                    |
|    proven_d_2_pos       | 0.000                    |
|    proven_d_3_pos       | 0.000                    |
|    proven_d_4_pos       | 0.000                    |
|    proven_neg           | 0.008                    |
|    proven_pos           | 0.420                    |
|    reward_d_-1_pos      | 0.021                    |
|    reward_d_1_pos       | 0.932                    |
|    reward_d_2_pos       | 0.000                    |
|    reward_d_3_pos       | 0.000                    |
|    reward_d_4_pos       | 0.000                    |
|    reward_label_neg     | 0.008                    |
|    reward_label_pos     | 0.420                    |
----------------------------------------------------

[Checkpoint] Saved last train model to /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/last_model_train_2026_01_08_10_17_27.pt

[Checkpoint] Restoring best model at end of training...
Restoring best EVAL model (MRR) from /home/castellanoontiv/Batched_Env/kge_experiments/models/wn18rr-250-128-torchrl/best_model_eval_2026_01_08_10_17_27.pt
Loaded best model info: {'metric': 'mrr_mean', 'best_value': 0.947002112865448, 'timesteps': 4, 'explained_variance': 0.7480767965316772}

[2.5/3] Training neural bridge on validation data...
[NeuralBridge] Training neural bridge on 100 queries...
[NeuralBridge] Training on 200 queries, 11 candidates each
  Epoch 10/100: loss=-0.8021, alpha=0.4316
  Epoch 20/100: loss=-0.8065, alpha=0.4133
  Epoch 30/100: loss=-0.8104, alpha=0.3954
  Epoch 40/100: loss=-0.8138, alpha=0.3778
  Epoch 50/100: loss=-0.8168, alpha=0.3606
  Epoch 60/100: loss=-0.8196, alpha=0.3439
  Epoch 70/100: loss=-0.8220, alpha=0.3278
  Epoch 80/100: loss=-0.8241, alpha=0.3122
  Epoch 90/100: loss=-0.8261, alpha=0.2974
  Epoch 100/100: loss=-0.8278, alpha=0.2833
[NeuralBridge] Trained alpha: 0.2833

[3/3] Running evaluation...

Results: MRR=0.8362, Hits@1=0.7860, Hits@3=0.8680, Hits@10=0.9280
Proven: pos=0.3760, neg=0.0130
Writing results to /home/castellanoontiv/Batched_Env/kge_experiments/runs/averaged_runs/experiments.csv

============================================================
All experiments completed!
============================================================


==============================================
All experiments completed!
Finished at: Thu Jan  8 10:22:41 AM CET 2026
==============================================

Results are in the runs/ folder
Look for files matching: *wn18rr*
